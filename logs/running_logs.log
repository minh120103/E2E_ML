[2025-07-03 13:27:30,049: INFO: main: Starting the fraud detection application...]
[2025-07-03 15:58:41,303: INFO: main: Starting the fraud detection application...]
[2025-07-03 15:58:41,303: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2025-07-03 15:58:41,303: INFO: data_ingestion: >>> Stage Data Ingestion stage started <<<]
[2025-07-03 15:58:41,305: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-03 15:58:41,306: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-03 15:58:41,307: ERROR: main: yaml file is empty]
Traceback (most recent call last):
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\src\fraud_detection\utils\common.py", line 33, in read_yaml
    return ConfigBox(content)
           ^^^^^^^^^^^^^^^^^^
  File "box\\box.py", line 283, in box.box.Box.__init__
box.exceptions.BoxValueError: Cannot extrapolate Box from string

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\main.py", line 10, in <module>
    data_ingestion.main()
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\src\fraud_detection\pipelines\data_ingestion.py", line 11, in main
    config = ConfigurationManager()
             ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\src\fraud_detection\config\configuration.py", line 12, in __init__
    self.params = read_yaml(params_filepath)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Miniconda\Lib\site-packages\ensure\main.py", line 872, in __call__
    return_val = self.f(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\src\fraud_detection\utils\common.py", line 35, in read_yaml
    raise ValueError("yaml file is empty")
ValueError: yaml file is empty
[2025-07-03 16:05:13,358: INFO: main: Starting the fraud detection application...]
[2025-07-03 16:05:13,359: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2025-07-03 16:05:13,359: INFO: data_ingestion: >>> Stage Data Ingestion stage started <<<]
[2025-07-03 16:05:13,360: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-03 16:05:13,362: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-03 16:05:13,362: INFO: common: created directory at: artifacts]
[2025-07-03 16:05:13,362: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-03 16:05:13,363: INFO: common: created directory at: artifacts/data_version]
[2025-07-03 16:05:13,363: INFO: data_ingestion: Initiating data ingestion]
[2025-07-03 16:05:13,363: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-03 16:05:13,388: INFO: data_ingestion: Loaded dataset with 1000 rows]
[2025-07-03 16:05:13,388: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-03 16:05:13,389: ERROR: main: cannot unpack non-iterable NoneType object]
Traceback (most recent call last):
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\main.py", line 10, in <module>
    data_ingestion.main()
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\src\fraud_detection\pipelines\data_ingestion.py", line 15, in main
    X_train, X_test, y_train, y_test,_,_ = data_ingestion.data_ingestion_pipeline()
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: cannot unpack non-iterable NoneType object
[2025-07-04 11:06:50,459: INFO: main: Starting the fraud detection application...]
[2025-07-04 11:06:50,460: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2025-07-04 11:06:50,460: INFO: preprocess_data: >>> Stage Data Ingestion stage started <<<]
[2025-07-04 11:06:50,472: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-04 11:06:50,482: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-04 11:06:50,483: INFO: common: created directory at: artifacts]
[2025-07-04 11:06:50,483: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-04 11:06:50,484: INFO: common: created directory at: artifacts/data_version]
[2025-07-04 11:06:50,484: INFO: data_ingestion: Initiating data ingestion]
[2025-07-04 11:06:50,484: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-04 11:06:50,509: INFO: data_ingestion: Loaded dataset with 1000 rows]
[2025-07-04 11:06:50,509: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-04 11:06:50,510: INFO: data_ingestion: Starting preprocessing of 1000 rows...]
[2025-07-04 11:06:50,510: INFO: data_ingestion: Initial columns: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-04 11:06:50,518: INFO: data_ingestion: After feature engineering columns: ['step', 'type', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver']]
[2025-07-04 11:06:50,518: INFO: data_ingestion: Data shape after feature engineering: (1000, 8)]
[2025-07-04 11:06:50,531: INFO: data_ingestion: First few rows of feature engineered data: 
   step      type      amount  oldbalanceOrg  oldbalanceDest  isFraud  MoneySpentSender  MoneyReceiver
0   278   CASH_IN   330218.42       20866.00       452419.57        0        -330218.42      330218.42
1    15   PAYMENT    11647.08       30370.00            0.00        0          11647.08           0.00
2    10   CASH_IN   152264.21      106589.00       201303.01        0        -152264.21      152264.21
3   403  TRANSFER  1551760.63           0.00      3198359.45        0              0.00    -1551760.63
4   206   CASH_IN    78172.30     2921331.58       415821.90        0         -78172.30       78172.30]
[2025-07-04 11:06:50,531: INFO: data_ingestion: After encoding columns: ['step', 'type', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver']]
[2025-07-04 11:06:50,532: INFO: data_ingestion: Data shape after encoding: (1000, 8)]
[2025-07-04 11:06:50,533: INFO: data_ingestion: Data shape after removing NaN: (1000, 8)]
[2025-07-04 11:06:50,533: ERROR: data_ingestion: Churn column not found! Available columns: ['step', 'type', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver']]
[2025-07-04 11:06:50,533: ERROR: main: 'Churn column is missing after preprocessing']
Traceback (most recent call last):
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\main.py", line 10, in <module>
    data_ingestion.main()
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\src\fraud_detection\pipelines\preprocess_data.py", line 15, in main
    X_train, X_test, y_train, y_test,_,_ = data_ingestion.data_ingestion_pipeline()
                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\src\fraud_detection\components\data_ingestion.py", line 52, in data_ingestion_pipeline
    X, y, df_processed = self.preprocess_data(df)
                         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\src\fraud_detection\components\data_ingestion.py", line 86, in preprocess_data
    raise KeyError("Churn column is missing after preprocessing")
KeyError: 'Churn column is missing after preprocessing'
[2025-07-04 11:07:59,298: INFO: main: Starting the fraud detection application...]
[2025-07-04 11:07:59,299: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2025-07-04 11:07:59,299: INFO: preprocess_data: >>> Stage Data Ingestion stage started <<<]
[2025-07-04 11:07:59,303: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-04 11:07:59,304: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-04 11:07:59,305: INFO: common: created directory at: artifacts]
[2025-07-04 11:07:59,306: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-04 11:07:59,306: INFO: common: created directory at: artifacts/data_version]
[2025-07-04 11:07:59,307: INFO: data_ingestion: Initiating data ingestion]
[2025-07-04 11:07:59,307: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-04 11:07:59,325: INFO: data_ingestion: Loaded dataset with 1000 rows]
[2025-07-04 11:07:59,326: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-04 11:07:59,326: INFO: data_ingestion: Starting preprocessing of 1000 rows...]
[2025-07-04 11:07:59,327: INFO: data_ingestion: Initial columns: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-04 11:07:59,332: INFO: data_ingestion: After feature engineering columns: ['step', 'type', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver']]
[2025-07-04 11:07:59,333: INFO: data_ingestion: Data shape after feature engineering: (1000, 8)]
[2025-07-04 11:07:59,346: INFO: data_ingestion: First few rows of feature engineered data: 
   step      type      amount  oldbalanceOrg  oldbalanceDest  isFraud  MoneySpentSender  MoneyReceiver
0   278   CASH_IN   330218.42       20866.00       452419.57        0        -330218.42      330218.42
1    15   PAYMENT    11647.08       30370.00            0.00        0          11647.08           0.00
2    10   CASH_IN   152264.21      106589.00       201303.01        0        -152264.21      152264.21
3   403  TRANSFER  1551760.63           0.00      3198359.45        0              0.00    -1551760.63
4   206   CASH_IN    78172.30     2921331.58       415821.90        0         -78172.30       78172.30]
[2025-07-04 11:07:59,346: INFO: data_ingestion: After encoding columns: ['step', 'type', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver']]
[2025-07-04 11:07:59,347: INFO: data_ingestion: Data shape after encoding: (1000, 8)]
[2025-07-04 11:07:59,349: INFO: data_ingestion: Data shape after removing NaN: (1000, 8)]
[2025-07-04 11:07:59,352: INFO: data_ingestion: X shape (features): (1000, 7)]
[2025-07-04 11:07:59,352: INFO: data_ingestion: y shape (target): (1000,)]
[2025-07-04 11:07:59,353: INFO: data_ingestion: Target variable shape: (1000,)]
[2025-07-04 11:07:59,353: INFO: data_ingestion: NaN count in target: 0]
[2025-07-04 11:07:59,356: INFO: data_ingestion: Target variable distribution: 
isFraud
0    0.996
1    0.004
Name: proportion, dtype: float64]
[2025-07-04 11:07:59,357: INFO: data_ingestion: Final feature matrix shape: (1000, 7)]
[2025-07-04 11:07:59,358: INFO: data_ingestion: Final target vector shape: (1000,)]
[2025-07-04 11:07:59,359: INFO: data_ingestion: Target variable distribution (normalized): 
isFraud
0    0.996
1    0.004
Name: proportion, dtype: float64]
[2025-07-04 11:07:59,359: INFO: data_ingestion: Target variable is imbalanced. Applying SMOTE...]
[2025-07-04 11:07:59,365: ERROR: main: could not convert string to float: 'CASH_IN']
Traceback (most recent call last):
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\main.py", line 10, in <module>
    data_ingestion.main()
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\src\fraud_detection\pipelines\preprocess_data.py", line 15, in main
    X_train, X_test, y_train, y_test,_,_ = data_ingestion.data_ingestion_pipeline()
                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\src\fraud_detection\components\data_ingestion.py", line 52, in data_ingestion_pipeline
    X, y, df_processed = self.preprocess_data(df)
                         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\src\fraud_detection\components\data_ingestion.py", line 118, in preprocess_data
    X_res, y_res = smote.fit_resample(X, y)
                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Miniconda\Lib\site-packages\imblearn\base.py", line 202, in fit_resample
    return super().fit_resample(X, y, **params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Miniconda\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Miniconda\Lib\site-packages\imblearn\base.py", line 99, in fit_resample
    X, y, binarize_y = self._check_X_y(X, y)
                       ^^^^^^^^^^^^^^^^^^^^^
  File "D:\Miniconda\Lib\site-packages\imblearn\base.py", line 157, in _check_X_y
    X, y = validate_data(self, X=X, y=y, reset=True, accept_sparse=accept_sparse)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Miniconda\Lib\site-packages\sklearn\utils\validation.py", line 2961, in validate_data
    X, y = check_X_y(X, y, **check_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Miniconda\Lib\site-packages\sklearn\utils\validation.py", line 1370, in check_X_y
    X = check_array(
        ^^^^^^^^^^^^
  File "D:\Miniconda\Lib\site-packages\sklearn\utils\validation.py", line 1055, in check_array
    array = _asarray_with_order(array, order=order, dtype=dtype, xp=xp)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Miniconda\Lib\site-packages\sklearn\utils\_array_api.py", line 832, in _asarray_with_order
    array = numpy.asarray(array, order=order, dtype=dtype)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Miniconda\Lib\site-packages\pandas\core\generic.py", line 2153, in __array__
    arr = np.asarray(values, dtype=dtype)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: could not convert string to float: 'CASH_IN'
[2025-07-04 11:14:46,378: INFO: main: Starting the fraud detection application...]
[2025-07-04 11:14:46,379: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2025-07-04 11:14:46,379: INFO: preprocess_data: >>> Stage Data Ingestion stage started <<<]
[2025-07-04 11:14:46,382: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-04 11:14:46,382: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-04 11:14:46,383: INFO: common: created directory at: artifacts]
[2025-07-04 11:14:46,383: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-04 11:14:46,384: INFO: common: created directory at: artifacts/data_version]
[2025-07-04 11:14:46,384: INFO: data_ingestion: Initiating data ingestion]
[2025-07-04 11:14:46,384: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-04 11:14:46,394: INFO: data_ingestion: Loaded dataset with 1000 rows]
[2025-07-04 11:14:46,394: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-04 11:14:46,394: INFO: data_ingestion: Starting preprocessing of 1000 rows...]
[2025-07-04 11:14:46,395: INFO: data_ingestion: Initial columns: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-04 11:14:46,403: INFO: data_ingestion: After feature engineering columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-04 11:14:46,403: INFO: data_ingestion: Data shape after feature engineering: (1000, 12)]
[2025-07-04 11:14:46,416: INFO: data_ingestion: First few rows of feature engineered data: 
   step      amount  oldbalanceOrg  oldbalanceDest  isFraud  MoneySpentSender  MoneyReceiver  type_CASH_IN  type_CASH_OUT  type_DEBIT  type_PAYMENT  type_TRANSFER
0   278   330218.42       20866.00       452419.57        0        -330218.42      330218.42             1              0           0             0              0
1    15    11647.08       30370.00            0.00        0          11647.08           0.00             0              0           0             1              0
2    10   152264.21      106589.00       201303.01        0        -152264.21      152264.21             1              0           0             0              0
3   403  1551760.63           0.00      3198359.45        0              0.00    -1551760.63             0              0           0             0              1
4   206    78172.30     2921331.58       415821.90        0         -78172.30       78172.30             1              0           0             0              0]
[2025-07-04 11:14:46,417: INFO: data_ingestion: After encoding columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-04 11:14:46,417: INFO: data_ingestion: Data shape after encoding: (1000, 12)]
[2025-07-04 11:14:46,418: INFO: data_ingestion: Data shape after removing NaN: (1000, 12)]
[2025-07-04 11:14:46,419: INFO: data_ingestion: X shape (features): (1000, 11)]
[2025-07-04 11:14:46,419: INFO: data_ingestion: y shape (target): (1000,)]
[2025-07-04 11:14:46,420: INFO: data_ingestion: Target variable shape: (1000,)]
[2025-07-04 11:14:46,420: INFO: data_ingestion: NaN count in target: 0]
[2025-07-04 11:14:46,421: INFO: data_ingestion: Target variable distribution: 
isFraud
0    0.996
1    0.004
Name: proportion, dtype: float64]
[2025-07-04 11:14:46,423: INFO: data_ingestion: Final feature matrix shape: (1000, 11)]
[2025-07-04 11:14:46,423: INFO: data_ingestion: Final target vector shape: (1000,)]
[2025-07-04 11:14:46,424: INFO: data_ingestion: Target variable distribution (normalized): 
isFraud
0    0.996
1    0.004
Name: proportion, dtype: float64]
[2025-07-04 11:14:46,425: INFO: data_ingestion: Target variable is imbalanced. Applying SMOTE...]
[2025-07-04 11:14:46,430: ERROR: main: Expected n_neighbors <= n_samples_fit, but n_neighbors = 6, n_samples_fit = 4, n_samples = 4]
Traceback (most recent call last):
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\main.py", line 10, in <module>
    data_ingestion.main()
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\src\fraud_detection\pipelines\preprocess_data.py", line 15, in main
    X_train, X_test, y_train, y_test,_,_ = data_ingestion.data_ingestion_pipeline()
                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\src\fraud_detection\components\data_ingestion.py", line 52, in data_ingestion_pipeline
    X, y, df_processed = self.preprocess_data(df)
                         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\src\fraud_detection\components\data_ingestion.py", line 118, in preprocess_data
    X_res, y_res = smote.fit_resample(X, y)
                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Miniconda\Lib\site-packages\imblearn\base.py", line 202, in fit_resample
    return super().fit_resample(X, y, **params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Miniconda\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Miniconda\Lib\site-packages\imblearn\base.py", line 105, in fit_resample
    output = self._fit_resample(X, y, **params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Miniconda\Lib\site-packages\imblearn\over_sampling\_smote\base.py", line 359, in _fit_resample
    nns = self.nn_k_.kneighbors(X_class, return_distance=False)[:, 1:]
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Miniconda\Lib\site-packages\sklearn\neighbors\_base.py", line 853, in kneighbors
    raise ValueError(
ValueError: Expected n_neighbors <= n_samples_fit, but n_neighbors = 6, n_samples_fit = 4, n_samples = 4
[2025-07-04 11:25:07,431: INFO: main: Starting the fraud detection application...]
[2025-07-04 11:25:07,431: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2025-07-04 11:25:07,432: INFO: preprocess_data: >>> Stage Data Ingestion stage started <<<]
[2025-07-04 11:25:07,434: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-04 11:25:07,436: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-04 11:25:07,437: INFO: common: created directory at: artifacts]
[2025-07-04 11:25:07,438: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-04 11:25:07,438: INFO: common: created directory at: artifacts/data_version]
[2025-07-04 11:25:07,438: INFO: data_ingestion: Initiating data ingestion]
[2025-07-04 11:25:07,438: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-04 11:25:07,647: INFO: data_ingestion: Loaded dataset with 100000 rows]
[2025-07-04 11:25:07,648: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-04 11:25:07,648: INFO: data_ingestion: Starting preprocessing of 100000 rows...]
[2025-07-04 11:25:07,648: INFO: data_ingestion: Initial columns: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-04 11:25:07,697: INFO: data_ingestion: After feature engineering columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-04 11:25:07,698: INFO: data_ingestion: Data shape after feature engineering: (100000, 12)]
[2025-07-04 11:25:07,716: INFO: data_ingestion: First few rows of feature engineered data: 
   step      amount  oldbalanceOrg  oldbalanceDest  isFraud  ...  type_CASH_IN  type_CASH_OUT  type_DEBIT  type_PAYMENT  type_TRANSFER
0   278   330218.42       20866.00       452419.57        0  ...             1              0           0             0              0
1    15    11647.08       30370.00            0.00        0  ...             0              0           0             1              0
2    10   152264.21      106589.00       201303.01        0  ...             1              0           0             0              0
3   403  1551760.63           0.00      3198359.45        0  ...             0              0           0             0              1
4   206    78172.30     2921331.58       415821.90        0  ...             1              0           0             0              0

[5 rows x 12 columns]]
[2025-07-04 11:25:07,717: INFO: data_ingestion: After encoding columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-04 11:25:07,717: INFO: data_ingestion: Data shape after encoding: (100000, 12)]
[2025-07-04 11:25:07,726: INFO: data_ingestion: Data shape after removing NaN: (100000, 12)]
[2025-07-04 11:25:07,729: INFO: data_ingestion: X shape (features): (100000, 11)]
[2025-07-04 11:25:07,729: INFO: data_ingestion: y shape (target): (100000,)]
[2025-07-04 11:25:07,729: INFO: data_ingestion: Target variable shape: (100000,)]
[2025-07-04 11:25:07,730: INFO: data_ingestion: NaN count in target: 0]
[2025-07-04 11:25:07,734: INFO: data_ingestion: Target variable distribution: 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-04 11:25:07,736: INFO: data_ingestion: Final feature matrix shape: (100000, 11)]
[2025-07-04 11:25:07,737: INFO: data_ingestion: Final target vector shape: (100000,)]
[2025-07-04 11:25:07,739: INFO: data_ingestion: Target variable distribution (normalized): 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-04 11:25:07,740: INFO: data_ingestion: Target variable is imbalanced. Applying SMOTE...]
[2025-07-04 11:25:07,810: INFO: data_ingestion: Resampled feature matrix shape: (199718, 11)]
[2025-07-04 11:25:07,812: INFO: data_ingestion: Resampled target distribution: 
isFraud
0    99859
1    99859
Name: count, dtype: int64]
[2025-07-04 11:25:09,063: INFO: data_ingestion: Created versioned input data file: artifacts\data_version\input_raw_data_version_20250704T112507.csv]
[2025-07-04 11:25:09,063: INFO: data_ingestion: Created versioned processed data file: artifacts\data_version\processed_data_version_20250704T112507.csv]
[2025-07-04 11:25:09,063: INFO: data_ingestion: Splitting data into train and test sets]
[2025-07-04 11:25:09,101: INFO: data_ingestion: Train data: (159774, 11), Test data: (39944, 11)]
[2025-07-04 11:25:09,101: INFO: data_ingestion: Data ingestion completed successfully]
[2025-07-04 11:25:09,101: INFO: data_ingestion: Data shape - Train: (159774, 11), Test: (39944, 11)]
[2025-07-04 11:25:09,104: INFO: preprocess_data: >>> Stage Data Ingestion stage completed <<<]
[2025-07-04 11:25:09,110: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2025-07-04 13:29:51,513: INFO: main: Starting the fraud detection application...]
[2025-07-04 13:29:51,513: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2025-07-04 13:29:51,513: ERROR: main: ModelPreparationPipeline.__init__() missing 1 required positional argument: 'mlflow_config']
Traceback (most recent call last):
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\main.py", line 10, in <module>
    data_ingestion = ModelPreparationPipeline()
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: ModelPreparationPipeline.__init__() missing 1 required positional argument: 'mlflow_config'
[2025-07-04 13:30:09,292: INFO: main: Starting the fraud detection application...]
[2025-07-04 13:30:09,292: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2025-07-04 13:30:09,293: ERROR: main: ModelPreparationPipeline.main() missing 2 required positional arguments: 'X_train' and 'X_test']
Traceback (most recent call last):
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\main.py", line 11, in <module>
    data_ingestion.main()
TypeError: ModelPreparationPipeline.main() missing 2 required positional arguments: 'X_train' and 'X_test'
[2025-07-04 13:31:23,682: INFO: main: Starting the fraud detection application...]
[2025-07-04 13:31:23,682: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2025-07-04 13:31:23,683: INFO: preprocess_data: >>> Stage Data Ingestion stage started <<<]
[2025-07-04 13:31:23,697: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-04 13:31:23,710: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-04 13:31:23,710: INFO: common: created directory at: artifacts]
[2025-07-04 13:31:23,711: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-04 13:31:23,711: INFO: common: created directory at: artifacts/data_version]
[2025-07-04 13:31:23,712: INFO: data_ingestion: Initiating data ingestion]
[2025-07-04 13:31:23,712: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-04 13:31:23,973: INFO: data_ingestion: Loaded dataset with 100000 rows]
[2025-07-04 13:31:23,974: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-04 13:31:23,974: INFO: data_ingestion: Starting preprocessing of 100000 rows...]
[2025-07-04 13:31:23,974: INFO: data_ingestion: Initial columns: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-04 13:31:24,026: INFO: data_ingestion: After feature engineering columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-04 13:31:24,026: INFO: data_ingestion: Data shape after feature engineering: (100000, 12)]
[2025-07-04 13:31:24,040: INFO: data_ingestion: First few rows of feature engineered data: 
   step      amount  oldbalanceOrg  oldbalanceDest  isFraud  MoneySpentSender  MoneyReceiver  type_CASH_IN  type_CASH_OUT  type_DEBIT  type_PAYMENT  type_TRANSFER
0   278   330218.42       20866.00       452419.57        0        -330218.42      330218.42             1              0           0             0              0
1    15    11647.08       30370.00            0.00        0          11647.08           0.00             0              0           0             1              0
2    10   152264.21      106589.00       201303.01        0        -152264.21      152264.21             1              0           0             0              0
3   403  1551760.63           0.00      3198359.45        0              0.00    -1551760.63             0              0           0             0              1
4   206    78172.30     2921331.58       415821.90        0         -78172.30       78172.30             1              0           0             0              0]
[2025-07-04 13:31:24,040: INFO: data_ingestion: After encoding columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-04 13:31:24,041: INFO: data_ingestion: Data shape after encoding: (100000, 12)]
[2025-07-04 13:31:24,050: INFO: data_ingestion: Data shape after removing NaN: (100000, 12)]
[2025-07-04 13:31:24,053: INFO: data_ingestion: X shape (features): (100000, 11)]
[2025-07-04 13:31:24,054: INFO: data_ingestion: y shape (target): (100000,)]
[2025-07-04 13:31:24,054: INFO: data_ingestion: Target variable shape: (100000,)]
[2025-07-04 13:31:24,055: INFO: data_ingestion: NaN count in target: 0]
[2025-07-04 13:31:24,058: INFO: data_ingestion: Target variable distribution: 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-04 13:31:24,060: INFO: data_ingestion: Final feature matrix shape: (100000, 11)]
[2025-07-04 13:31:24,060: INFO: data_ingestion: Final target vector shape: (100000,)]
[2025-07-04 13:31:24,062: INFO: data_ingestion: Target variable distribution (normalized): 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-04 13:31:24,062: INFO: data_ingestion: Target variable is imbalanced. Applying SMOTE...]
[2025-07-04 13:31:24,138: INFO: data_ingestion: Resampled feature matrix shape: (199718, 11)]
[2025-07-04 13:31:24,140: INFO: data_ingestion: Resampled target distribution: 
isFraud
0    99859
1    99859
Name: count, dtype: int64]
[2025-07-04 13:31:25,555: INFO: data_ingestion: Created versioned input data file: artifacts\data_version\input_raw_data_version_20250704T133123.csv]
[2025-07-04 13:31:25,555: INFO: data_ingestion: Created versioned processed data file: artifacts\data_version\processed_data_version_20250704T133123.csv]
[2025-07-04 13:31:25,555: INFO: data_ingestion: Splitting data into train and test sets]
[2025-07-04 13:31:25,608: INFO: data_ingestion: Train data: (159774, 11), Test data: (39944, 11)]
[2025-07-04 13:31:25,608: INFO: data_ingestion: Data ingestion completed successfully]
[2025-07-04 13:31:25,609: INFO: data_ingestion: Data shape - Train: (159774, 11), Test: (39944, 11)]
[2025-07-04 13:31:25,611: INFO: preprocess_data: >>> Stage Data Ingestion stage completed <<<]
[2025-07-04 13:31:25,617: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2025-07-04 13:31:25,618: INFO: main: Starting the fraud detection application...]
[2025-07-04 13:31:25,618: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2025-07-04 13:31:25,619: ERROR: main: ModelPreparationPipeline.main() missing 2 required positional arguments: 'X_train' and 'X_test']
Traceback (most recent call last):
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\main.py", line 24, in <module>
    model_prepare.main()
TypeError: ModelPreparationPipeline.main() missing 2 required positional arguments: 'X_train' and 'X_test'
[2025-07-05 13:41:28,473: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2025-07-05 13:41:28,474: INFO: preprocess_data: >>> Stage Data Ingestion stage started <<<]
[2025-07-05 13:41:28,478: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-05 13:41:28,480: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-05 13:41:28,480: INFO: common: created directory at: artifacts]
[2025-07-05 13:41:28,481: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-05 13:41:28,481: INFO: common: created directory at: artifacts/data_version]
[2025-07-05 13:41:28,482: INFO: data_ingestion: Initiating data ingestion]
[2025-07-05 13:41:28,482: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-05 13:41:28,700: INFO: data_ingestion: Loaded dataset with 100000 rows]
[2025-07-05 13:41:28,701: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-05 13:41:28,701: INFO: data_ingestion: Starting preprocessing of 100000 rows...]
[2025-07-05 13:41:28,701: INFO: data_ingestion: Initial columns: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-05 13:41:28,752: INFO: data_ingestion: After feature engineering columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-05 13:41:28,752: INFO: data_ingestion: Data shape after feature engineering: (100000, 12)]
[2025-07-05 13:41:28,769: INFO: data_ingestion: First few rows of feature engineered data: 
   step      amount  oldbalanceOrg  oldbalanceDest  isFraud  ...  type_CASH_IN  type_CASH_OUT  type_DEBIT  type_PAYMENT  type_TRANSFER
0   278   330218.42       20866.00       452419.57        0  ...             1              0           0             0              0
1    15    11647.08       30370.00            0.00        0  ...             0              0           0             1              0
2    10   152264.21      106589.00       201303.01        0  ...             1              0           0             0              0
3   403  1551760.63           0.00      3198359.45        0  ...             0              0           0             0              1
4   206    78172.30     2921331.58       415821.90        0  ...             1              0           0             0              0

[5 rows x 12 columns]]
[2025-07-05 13:41:28,770: INFO: data_ingestion: After encoding columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-05 13:41:28,770: INFO: data_ingestion: Data shape after encoding: (100000, 12)]
[2025-07-05 13:41:28,781: INFO: data_ingestion: Data shape after removing NaN: (100000, 12)]
[2025-07-05 13:41:28,784: INFO: data_ingestion: X shape (features): (100000, 11)]
[2025-07-05 13:41:28,785: INFO: data_ingestion: y shape (target): (100000,)]
[2025-07-05 13:41:28,785: INFO: data_ingestion: Target variable shape: (100000,)]
[2025-07-05 13:41:28,786: INFO: data_ingestion: NaN count in target: 0]
[2025-07-05 13:41:28,789: INFO: data_ingestion: Target variable distribution: 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-05 13:41:28,791: INFO: data_ingestion: Final feature matrix shape: (100000, 11)]
[2025-07-05 13:41:28,791: INFO: data_ingestion: Final target vector shape: (100000,)]
[2025-07-05 13:41:28,793: INFO: data_ingestion: Target variable distribution (normalized): 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-05 13:41:28,794: INFO: data_ingestion: Target variable is imbalanced. Applying SMOTE...]
[2025-07-05 13:41:28,860: INFO: data_ingestion: Resampled feature matrix shape: (199718, 11)]
[2025-07-05 13:41:28,863: INFO: data_ingestion: Resampled target distribution: 
isFraud
0    99859
1    99859
Name: count, dtype: int64]
[2025-07-05 13:41:30,079: INFO: data_ingestion: Created versioned input data file: artifacts\data_version\input_raw_data_version_20250705T134128.csv]
[2025-07-05 13:41:30,079: INFO: data_ingestion: Created versioned processed data file: artifacts\data_version\processed_data_version_20250705T134128.csv]
[2025-07-05 13:41:30,079: INFO: data_ingestion: Splitting data into train and test sets]
[2025-07-05 13:41:30,106: INFO: data_ingestion: Train data: (159774, 11), Test data: (39944, 11)]
[2025-07-05 13:41:30,106: INFO: data_ingestion: Data ingestion completed successfully]
[2025-07-05 13:41:30,120: INFO: data_ingestion: Data shape - Train: (159774, 11), Test: (39944, 11)]
[2025-07-05 13:41:30,120: INFO: preprocess_data: >>> Stage Data Ingestion stage completed <<<]
[2025-07-05 13:41:30,128: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x====================x]
[2025-07-05 13:41:30,128: INFO: main: >>>>>> stage Model Preparation stage started <<<<<<]
[2025-07-05 13:41:30,128: ERROR: main: ModelPreparationPipeline.main() missing 2 required positional arguments: 'X_train' and 'X_test']
Traceback (most recent call last):
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\main.py", line 20, in <module>
    model_prepare.main()
TypeError: ModelPreparationPipeline.main() missing 2 required positional arguments: 'X_train' and 'X_test'
[2025-07-05 13:45:04,326: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2025-07-05 13:45:04,326: INFO: preprocess_data: >>> Stage Data Ingestion stage started <<<]
[2025-07-05 13:45:04,326: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-05 13:45:04,326: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-05 13:45:04,326: INFO: common: created directory at: artifacts]
[2025-07-05 13:45:04,326: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-05 13:45:04,326: INFO: common: created directory at: artifacts/data_version]
[2025-07-05 13:45:04,326: INFO: data_ingestion: Initiating data ingestion]
[2025-07-05 13:45:04,326: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-05 13:45:04,500: INFO: data_ingestion: Loaded dataset with 100000 rows]
[2025-07-05 13:45:04,500: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-05 13:45:04,500: INFO: data_ingestion: Starting preprocessing of 100000 rows...]
[2025-07-05 13:45:04,500: INFO: data_ingestion: Initial columns: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-05 13:45:04,533: INFO: data_ingestion: After feature engineering columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-05 13:45:04,533: INFO: data_ingestion: Data shape after feature engineering: (100000, 12)]
[2025-07-05 13:45:04,551: INFO: data_ingestion: First few rows of feature engineered data: 
   step      amount  oldbalanceOrg  oldbalanceDest  isFraud  ...  type_CASH_IN  type_CASH_OUT  type_DEBIT  type_PAYMENT  type_TRANSFER
0   278   330218.42       20866.00       452419.57        0  ...             1              0           0             0              0
1    15    11647.08       30370.00            0.00        0  ...             0              0           0             1              0
2    10   152264.21      106589.00       201303.01        0  ...             1              0           0             0              0
3   403  1551760.63           0.00      3198359.45        0  ...             0              0           0             0              1
4   206    78172.30     2921331.58       415821.90        0  ...             1              0           0             0              0

[5 rows x 12 columns]]
[2025-07-05 13:45:04,552: INFO: data_ingestion: After encoding columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-05 13:45:04,553: INFO: data_ingestion: Data shape after encoding: (100000, 12)]
[2025-07-05 13:45:04,558: INFO: data_ingestion: Data shape after removing NaN: (100000, 12)]
[2025-07-05 13:45:04,561: INFO: data_ingestion: X shape (features): (100000, 11)]
[2025-07-05 13:45:04,563: INFO: data_ingestion: y shape (target): (100000,)]
[2025-07-05 13:45:04,563: INFO: data_ingestion: Target variable shape: (100000,)]
[2025-07-05 13:45:04,564: INFO: data_ingestion: NaN count in target: 0]
[2025-07-05 13:45:04,565: INFO: data_ingestion: Target variable distribution: 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-05 13:45:04,567: INFO: data_ingestion: Final feature matrix shape: (100000, 11)]
[2025-07-05 13:45:04,568: INFO: data_ingestion: Final target vector shape: (100000,)]
[2025-07-05 13:45:04,569: INFO: data_ingestion: Target variable distribution (normalized): 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-05 13:45:04,570: INFO: data_ingestion: Target variable is imbalanced. Applying SMOTE...]
[2025-07-05 13:45:04,629: INFO: data_ingestion: Resampled feature matrix shape: (199718, 11)]
[2025-07-05 13:45:04,630: INFO: data_ingestion: Resampled target distribution: 
isFraud
0    99859
1    99859
Name: count, dtype: int64]
[2025-07-05 13:45:05,774: INFO: data_ingestion: Created versioned input data file: artifacts\data_version\input_raw_data_version_20250705T134504.csv]
[2025-07-05 13:45:05,774: INFO: data_ingestion: Created versioned processed data file: artifacts\data_version\processed_data_version_20250705T134504.csv]
[2025-07-05 13:45:05,774: INFO: data_ingestion: Splitting data into train and test sets]
[2025-07-05 13:45:05,809: INFO: data_ingestion: Train data: (159774, 11), Test data: (39944, 11)]
[2025-07-05 13:45:05,810: INFO: data_ingestion: Data ingestion completed successfully]
[2025-07-05 13:45:05,810: INFO: data_ingestion: Data shape - Train: (159774, 11), Test: (39944, 11)]
[2025-07-05 13:45:05,813: INFO: preprocess_data: >>> Stage Data Ingestion stage completed <<<]
[2025-07-05 13:45:05,817: ERROR: main: too many values to unpack (expected 4)]
Traceback (most recent call last):
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\main.py", line 11, in <module>
    X_train, X_test, y_train, y_test = data_ingestion_pipeline.main()
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: too many values to unpack (expected 4)
[2025-07-05 13:49:37,715: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2025-07-05 13:49:37,715: INFO: preprocess_data: >>> Stage Data Ingestion stage started <<<]
[2025-07-05 13:49:37,715: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-05 13:49:37,715: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-05 13:49:37,715: INFO: common: created directory at: artifacts]
[2025-07-05 13:49:37,715: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-05 13:49:37,715: INFO: common: created directory at: artifacts/data_version]
[2025-07-05 13:49:37,715: INFO: data_ingestion: Initiating data ingestion]
[2025-07-05 13:49:37,715: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-05 13:49:37,892: INFO: data_ingestion: Loaded dataset with 100000 rows]
[2025-07-05 13:49:37,892: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-05 13:49:37,892: INFO: data_ingestion: Starting preprocessing of 100000 rows...]
[2025-07-05 13:49:37,892: INFO: data_ingestion: Initial columns: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-05 13:49:37,933: INFO: data_ingestion: After feature engineering columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-05 13:49:37,933: INFO: data_ingestion: Data shape after feature engineering: (100000, 12)]
[2025-07-05 13:49:37,947: INFO: data_ingestion: First few rows of feature engineered data: 
   step      amount  oldbalanceOrg  oldbalanceDest  isFraud  ...  type_CASH_IN  type_CASH_OUT  type_DEBIT  type_PAYMENT  type_TRANSFER
0   278   330218.42       20866.00       452419.57        0  ...             1              0           0             0              0
1    15    11647.08       30370.00            0.00        0  ...             0              0           0             1              0
2    10   152264.21      106589.00       201303.01        0  ...             1              0           0             0              0
3   403  1551760.63           0.00      3198359.45        0  ...             0              0           0             0              1
4   206    78172.30     2921331.58       415821.90        0  ...             1              0           0             0              0

[5 rows x 12 columns]]
[2025-07-05 13:49:37,947: INFO: data_ingestion: After encoding columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-05 13:49:37,949: INFO: data_ingestion: Data shape after encoding: (100000, 12)]
[2025-07-05 13:49:37,956: INFO: data_ingestion: Data shape after removing NaN: (100000, 12)]
[2025-07-05 13:49:37,959: INFO: data_ingestion: X shape (features): (100000, 11)]
[2025-07-05 13:49:37,959: INFO: data_ingestion: y shape (target): (100000,)]
[2025-07-05 13:49:37,960: INFO: data_ingestion: Target variable shape: (100000,)]
[2025-07-05 13:49:37,960: INFO: data_ingestion: NaN count in target: 0]
[2025-07-05 13:49:37,962: INFO: data_ingestion: Target variable distribution: 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-05 13:49:37,962: INFO: data_ingestion: Final feature matrix shape: (100000, 11)]
[2025-07-05 13:49:37,962: INFO: data_ingestion: Final target vector shape: (100000,)]
[2025-07-05 13:49:37,962: INFO: data_ingestion: Target variable distribution (normalized): 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-05 13:49:37,962: INFO: data_ingestion: Target variable is imbalanced. Applying SMOTE...]
[2025-07-05 13:49:38,024: INFO: data_ingestion: Resampled feature matrix shape: (199718, 11)]
[2025-07-05 13:49:38,024: INFO: data_ingestion: Resampled target distribution: 
isFraud
0    99859
1    99859
Name: count, dtype: int64]
[2025-07-05 13:49:39,190: INFO: data_ingestion: Created versioned input data file: artifacts\data_version\input_raw_data_version_20250705T134937.csv]
[2025-07-05 13:49:39,190: INFO: data_ingestion: Created versioned processed data file: artifacts\data_version\processed_data_version_20250705T134937.csv]
[2025-07-05 13:49:39,190: INFO: data_ingestion: Splitting data into train and test sets]
[2025-07-05 13:49:39,225: INFO: data_ingestion: Train data: (159774, 11), Test data: (39944, 11)]
[2025-07-05 13:49:39,225: INFO: data_ingestion: Data ingestion completed successfully]
[2025-07-05 13:49:39,225: INFO: data_ingestion: Data shape - Train: (159774, 11), Test: (39944, 11)]
[2025-07-05 13:49:39,225: INFO: preprocess_data: >>> Stage Data Ingestion stage completed <<<]
[2025-07-05 13:49:39,242: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x====================x]
[2025-07-05 13:49:39,242: INFO: main: >>>>>> stage Model Preparation stage started <<<<<<]
[2025-07-05 13:49:39,243: INFO: prepare_model: >>> Stage Prepare base model started <<<]
[2025-07-05 13:49:39,246: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-05 13:49:39,247: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-05 13:49:39,247: INFO: common: created directory at: artifacts]
[2025-07-05 13:49:39,248: INFO: common: created directory at: artifacts/model_version]
[2025-07-05 13:49:39,248: INFO: common: created directory at: artifacts/data_version]
[2025-07-05 13:49:39,249: INFO: configuration: Prepare base model config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'objective': 'binary:logistic', 'max_depth': 6, 'n_estimators': 300, 'random_state': 42, 'learning_rate': 0.1, 'scale_pos_weight': 10, 'n_jobs': -1}]
[2025-07-05 13:49:39,249: INFO: base_model: Creating base model and scaler]
[2025-07-05 13:49:39,249: INFO: base_model: Creating base XGBoost model]
[2025-07-05 13:49:39,249: ERROR: main: 'PrepareBaseModelConfig' object has no attribute 'criterion']
Traceback (most recent call last):
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\main.py", line 22, in <module>
    base_model, X_train_scaled, X_test_scaled = model_preparation_pipeline.main(X_train, X_test)
                                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\src\fraud_detection\pipelines\prepare_model.py", line 26, in main
    model, base_model_path, scaler_path, X_train_scaled, X_test_scaled = prepare_base_model.full_model(
                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\src\fraud_detection\components\base_model.py", line 57, in full_model
    model = self.get_base_model()
            ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\src\fraud_detection\components\base_model.py", line 26, in get_base_model
    objective=self.config.criterion,
              ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'PrepareBaseModelConfig' object has no attribute 'criterion'
[2025-07-05 13:51:47,096: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2025-07-05 13:51:47,096: INFO: preprocess_data: >>> Stage Data Ingestion stage started <<<]
[2025-07-05 13:51:47,099: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-05 13:51:47,100: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-05 13:51:47,100: INFO: common: created directory at: artifacts]
[2025-07-05 13:51:47,101: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-05 13:51:47,101: INFO: common: created directory at: artifacts/data_version]
[2025-07-05 13:51:47,101: INFO: data_ingestion: Initiating data ingestion]
[2025-07-05 13:51:47,101: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-05 13:51:47,271: INFO: data_ingestion: Loaded dataset with 100000 rows]
[2025-07-05 13:51:47,272: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-05 13:51:47,273: INFO: data_ingestion: Starting preprocessing of 100000 rows...]
[2025-07-05 13:51:47,273: INFO: data_ingestion: Initial columns: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-05 13:51:47,312: INFO: data_ingestion: After feature engineering columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-05 13:51:47,312: INFO: data_ingestion: Data shape after feature engineering: (100000, 12)]
[2025-07-05 13:51:47,326: INFO: data_ingestion: First few rows of feature engineered data: 
   step      amount  oldbalanceOrg  oldbalanceDest  isFraud  ...  type_CASH_IN  type_CASH_OUT  type_DEBIT  type_PAYMENT  type_TRANSFER
0   278   330218.42       20866.00       452419.57        0  ...             1              0           0             0              0
1    15    11647.08       30370.00            0.00        0  ...             0              0           0             1              0
2    10   152264.21      106589.00       201303.01        0  ...             1              0           0             0              0
3   403  1551760.63           0.00      3198359.45        0  ...             0              0           0             0              1
4   206    78172.30     2921331.58       415821.90        0  ...             1              0           0             0              0

[5 rows x 12 columns]]
[2025-07-05 13:51:47,327: INFO: data_ingestion: After encoding columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-05 13:51:47,328: INFO: data_ingestion: Data shape after encoding: (100000, 12)]
[2025-07-05 13:51:47,336: INFO: data_ingestion: Data shape after removing NaN: (100000, 12)]
[2025-07-05 13:51:47,339: INFO: data_ingestion: X shape (features): (100000, 11)]
[2025-07-05 13:51:47,339: INFO: data_ingestion: y shape (target): (100000,)]
[2025-07-05 13:51:47,340: INFO: data_ingestion: Target variable shape: (100000,)]
[2025-07-05 13:51:47,340: INFO: data_ingestion: NaN count in target: 0]
[2025-07-05 13:51:47,342: INFO: data_ingestion: Target variable distribution: 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-05 13:51:47,344: INFO: data_ingestion: Final feature matrix shape: (100000, 11)]
[2025-07-05 13:51:47,344: INFO: data_ingestion: Final target vector shape: (100000,)]
[2025-07-05 13:51:47,346: INFO: data_ingestion: Target variable distribution (normalized): 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-05 13:51:47,346: INFO: data_ingestion: Target variable is imbalanced. Applying SMOTE...]
[2025-07-05 13:51:47,414: INFO: data_ingestion: Resampled feature matrix shape: (199718, 11)]
[2025-07-05 13:51:47,416: INFO: data_ingestion: Resampled target distribution: 
isFraud
0    99859
1    99859
Name: count, dtype: int64]
[2025-07-05 13:51:48,563: INFO: data_ingestion: Created versioned input data file: artifacts\data_version\input_raw_data_version_20250705T135147.csv]
[2025-07-05 13:51:48,564: INFO: data_ingestion: Created versioned processed data file: artifacts\data_version\processed_data_version_20250705T135147.csv]
[2025-07-05 13:51:48,564: INFO: data_ingestion: Splitting data into train and test sets]
[2025-07-05 13:51:48,601: INFO: data_ingestion: Train data: (159774, 11), Test data: (39944, 11)]
[2025-07-05 13:51:48,601: INFO: data_ingestion: Data ingestion completed successfully]
[2025-07-05 13:51:48,601: INFO: data_ingestion: Data shape - Train: (159774, 11), Test: (39944, 11)]
[2025-07-05 13:51:48,608: INFO: preprocess_data: >>> Stage Data Ingestion stage completed <<<]
[2025-07-05 13:51:48,608: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x====================x]
[2025-07-05 13:51:48,608: INFO: main: >>>>>> stage Model Preparation stage started <<<<<<]
[2025-07-05 13:51:48,608: INFO: prepare_model: >>> Stage Prepare base model started <<<]
[2025-07-05 13:51:48,615: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-05 13:51:48,616: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-05 13:51:48,617: INFO: common: created directory at: artifacts]
[2025-07-05 13:51:48,617: INFO: common: created directory at: artifacts/model_version]
[2025-07-05 13:51:48,618: INFO: common: created directory at: artifacts/data_version]
[2025-07-05 13:51:48,618: INFO: configuration: Prepare base model config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'objective': 'binary:logistic', 'max_depth': 6, 'n_estimators': 300, 'random_state': 42, 'learning_rate': 0.1, 'scale_pos_weight': 10, 'n_jobs': -1}]
[2025-07-05 13:51:48,618: INFO: base_model: Creating base model and scaler]
[2025-07-05 13:51:48,619: INFO: base_model: Creating base XGBoost model]
[2025-07-05 13:51:48,619: INFO: base_model: Model params:300, 42, 0.1, 6, 10, -1]
[2025-07-05 13:51:48,619: INFO: base_model: Creating scaler from training data]
[2025-07-05 13:51:48,699: INFO: base_model: Base model saved: artifacts\model_version\base_model_churn_20250705T135148.pkl]
[2025-07-05 13:51:48,699: INFO: prepare_model: >>> Stage Prepare base model completed <<<]
[2025-07-05 13:51:48,701: ERROR: main: too many values to unpack (expected 3)]
Traceback (most recent call last):
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\main.py", line 22, in <module>
    base_model, X_train_scaled, X_test_scaled = model_preparation_pipeline.main(X_train, X_test)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: too many values to unpack (expected 3)
[2025-07-05 13:53:20,929: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2025-07-05 13:53:20,929: INFO: preprocess_data: >>> Stage Data Ingestion stage started <<<]
[2025-07-05 13:53:20,932: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-05 13:53:20,933: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-05 13:53:20,934: INFO: common: created directory at: artifacts]
[2025-07-05 13:53:20,934: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-05 13:53:20,935: INFO: common: created directory at: artifacts/data_version]
[2025-07-05 13:53:20,935: INFO: data_ingestion: Initiating data ingestion]
[2025-07-05 13:53:20,936: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-05 13:53:21,101: INFO: data_ingestion: Loaded dataset with 100000 rows]
[2025-07-05 13:53:21,102: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-05 13:53:21,102: INFO: data_ingestion: Starting preprocessing of 100000 rows...]
[2025-07-05 13:53:21,102: INFO: data_ingestion: Initial columns: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-05 13:53:21,140: INFO: data_ingestion: After feature engineering columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-05 13:53:21,141: INFO: data_ingestion: Data shape after feature engineering: (100000, 12)]
[2025-07-05 13:53:21,154: INFO: data_ingestion: First few rows of feature engineered data: 
   step      amount  oldbalanceOrg  oldbalanceDest  isFraud  ...  type_CASH_IN  type_CASH_OUT  type_DEBIT  type_PAYMENT  type_TRANSFER
0   278   330218.42       20866.00       452419.57        0  ...             1              0           0             0              0
1    15    11647.08       30370.00            0.00        0  ...             0              0           0             1              0
2    10   152264.21      106589.00       201303.01        0  ...             1              0           0             0              0
3   403  1551760.63           0.00      3198359.45        0  ...             0              0           0             0              1
4   206    78172.30     2921331.58       415821.90        0  ...             1              0           0             0              0

[5 rows x 12 columns]]
[2025-07-05 13:53:21,154: INFO: data_ingestion: After encoding columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-05 13:53:21,155: INFO: data_ingestion: Data shape after encoding: (100000, 12)]
[2025-07-05 13:53:21,162: INFO: data_ingestion: Data shape after removing NaN: (100000, 12)]
[2025-07-05 13:53:21,165: INFO: data_ingestion: X shape (features): (100000, 11)]
[2025-07-05 13:53:21,166: INFO: data_ingestion: y shape (target): (100000,)]
[2025-07-05 13:53:21,166: INFO: data_ingestion: Target variable shape: (100000,)]
[2025-07-05 13:53:21,166: INFO: data_ingestion: NaN count in target: 0]
[2025-07-05 13:53:21,168: INFO: data_ingestion: Target variable distribution: 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-05 13:53:21,170: INFO: data_ingestion: Final feature matrix shape: (100000, 11)]
[2025-07-05 13:53:21,170: INFO: data_ingestion: Final target vector shape: (100000,)]
[2025-07-05 13:53:21,172: INFO: data_ingestion: Target variable distribution (normalized): 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-05 13:53:21,173: INFO: data_ingestion: Target variable is imbalanced. Applying SMOTE...]
[2025-07-05 13:53:21,235: INFO: data_ingestion: Resampled feature matrix shape: (199718, 11)]
[2025-07-05 13:53:21,237: INFO: data_ingestion: Resampled target distribution: 
isFraud
0    99859
1    99859
Name: count, dtype: int64]
[2025-07-05 13:53:22,396: INFO: data_ingestion: Created versioned input data file: artifacts\data_version\input_raw_data_version_20250705T135320.csv]
[2025-07-05 13:53:22,397: INFO: data_ingestion: Created versioned processed data file: artifacts\data_version\processed_data_version_20250705T135320.csv]
[2025-07-05 13:53:22,397: INFO: data_ingestion: Splitting data into train and test sets]
[2025-07-05 13:53:22,434: INFO: data_ingestion: Train data: (159774, 11), Test data: (39944, 11)]
[2025-07-05 13:53:22,434: INFO: data_ingestion: Data ingestion completed successfully]
[2025-07-05 13:53:22,435: INFO: data_ingestion: Data shape - Train: (159774, 11), Test: (39944, 11)]
[2025-07-05 13:53:22,437: INFO: preprocess_data: >>> Stage Data Ingestion stage completed <<<]
[2025-07-05 13:53:22,441: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x====================x]
[2025-07-05 13:53:22,441: INFO: main: >>>>>> stage Model Preparation stage started <<<<<<]
[2025-07-05 13:53:22,442: INFO: prepare_model: >>> Stage Prepare base model started <<<]
[2025-07-05 13:53:22,444: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-05 13:53:22,445: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-05 13:53:22,446: INFO: common: created directory at: artifacts]
[2025-07-05 13:53:22,446: INFO: common: created directory at: artifacts/model_version]
[2025-07-05 13:53:22,447: INFO: common: created directory at: artifacts/data_version]
[2025-07-05 13:53:22,447: INFO: configuration: Prepare base model config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'objective': 'binary:logistic', 'max_depth': 6, 'n_estimators': 300, 'random_state': 42, 'learning_rate': 0.1, 'scale_pos_weight': 10, 'n_jobs': -1}]
[2025-07-05 13:53:22,447: INFO: base_model: Creating base model and scaler]
[2025-07-05 13:53:22,448: INFO: base_model: Creating base XGBoost model]
[2025-07-05 13:53:22,448: INFO: base_model: Model params:300, 42, 0.1, 6, 10, -1]
[2025-07-05 13:53:22,448: INFO: base_model: Creating scaler from training data]
[2025-07-05 13:53:22,530: INFO: base_model: Base model saved: artifacts\model_version\base_model_churn_20250705T135322.pkl]
[2025-07-05 13:53:22,530: INFO: prepare_model: >>> Stage Prepare base model completed <<<]
[2025-07-05 13:53:22,531: INFO: main: >>>>>> stage Model Preparation stage completed <<<<<<

x====================x]
[2025-07-05 13:53:22,531: INFO: main: >>>>>> stage Model Training and Evaluation stage started <<<<<<]
[2025-07-05 13:53:22,531: INFO: train_evaluation: >>> Stage TRAIN_AND_EVALUATE_MODEL started <<<]
[2025-07-05 13:53:22,534: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-05 13:53:22,535: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-05 13:53:22,535: INFO: common: created directory at: artifacts]
[2025-07-05 13:53:22,535: INFO: common: created directory at: artifacts/model_version]
[2025-07-05 13:53:22,536: INFO: common: created directory at: artifacts/data_version]
[2025-07-05 13:53:22,536: INFO: configuration: Training config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version'}]
[2025-07-05 13:53:22,539: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-05 13:53:22,539: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-05 13:53:22,540: INFO: common: created directory at: artifacts]
[2025-07-05 13:53:22,540: ERROR: main: "'ConfigBox' object has no attribute 'evaluation'"]
Traceback (most recent call last):
  File "box\\box.py", line 594, in box.box.Box.__getitem__
KeyError: 'evaluation'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box\\box.py", line 633, in box.box.Box.__getattr__
  File "box\\box.py", line 621, in box.box.Box.__getitem__
box.exceptions.BoxKeyError: "'evaluation'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box\\box.py", line 635, in box.box.Box.__getattr__
AttributeError: 'ConfigBox' object has no attribute 'evaluation'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box\\config_box.py", line 29, in box.config_box.ConfigBox.__getattr__
  File "box\\box.py", line 649, in box.box.Box.__getattr__
box.exceptions.BoxKeyError: "'ConfigBox' object has no attribute 'evaluation'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box\\box.py", line 594, in box.box.Box.__getitem__
KeyError: 'evaluation'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box\\box.py", line 633, in box.box.Box.__getattr__
  File "box\\box.py", line 621, in box.box.Box.__getitem__
box.exceptions.BoxKeyError: "'evaluation'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box\\box.py", line 635, in box.box.Box.__getattr__
AttributeError: 'ConfigBox' object has no attribute 'evaluation'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\main.py", line 33, in <module>
    train_evaluation_pipeline.main(model, X_train_scaled, X_test_scaled, y_train, y_test)
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\src\fraud_detection\pipelines\train_evaluation.py", line 17, in main
    evaluation_config = ConfigurationManager().get_evaluation_config()
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\src\fraud_detection\config\configuration.py", line 68, in get_evaluation_config
    config = self.config.evaluation
             ^^^^^^^^^^^^^^^^^^^^^^
  File "box\\config_box.py", line 31, in box.config_box.ConfigBox.__getattr__
  File "box\\box.py", line 649, in box.box.Box.__getattr__
box.exceptions.BoxKeyError: "'ConfigBox' object has no attribute 'evaluation'"
[2025-07-05 13:56:18,688: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2025-07-05 13:56:18,688: INFO: preprocess_data: >>> Stage Data Ingestion stage started <<<]
[2025-07-05 13:56:18,691: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-05 13:56:18,692: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-05 13:56:18,693: INFO: common: created directory at: artifacts]
[2025-07-05 13:56:18,693: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-05 13:56:18,694: INFO: common: created directory at: artifacts/data_version]
[2025-07-05 13:56:18,694: INFO: data_ingestion: Initiating data ingestion]
[2025-07-05 13:56:18,695: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-05 13:56:18,869: INFO: data_ingestion: Loaded dataset with 100000 rows]
[2025-07-05 13:56:18,870: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-05 13:56:18,870: INFO: data_ingestion: Starting preprocessing of 100000 rows...]
[2025-07-05 13:56:18,870: INFO: data_ingestion: Initial columns: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-05 13:56:18,913: INFO: data_ingestion: After feature engineering columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-05 13:56:18,913: INFO: data_ingestion: Data shape after feature engineering: (100000, 12)]
[2025-07-05 13:56:18,926: INFO: data_ingestion: First few rows of feature engineered data: 
   step      amount  oldbalanceOrg  oldbalanceDest  isFraud  ...  type_CASH_IN  type_CASH_OUT  type_DEBIT  type_PAYMENT  type_TRANSFER
0   278   330218.42       20866.00       452419.57        0  ...             1              0           0             0              0
1    15    11647.08       30370.00            0.00        0  ...             0              0           0             1              0
2    10   152264.21      106589.00       201303.01        0  ...             1              0           0             0              0
3   403  1551760.63           0.00      3198359.45        0  ...             0              0           0             0              1
4   206    78172.30     2921331.58       415821.90        0  ...             1              0           0             0              0

[5 rows x 12 columns]]
[2025-07-05 13:56:18,927: INFO: data_ingestion: After encoding columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-05 13:56:18,927: INFO: data_ingestion: Data shape after encoding: (100000, 12)]
[2025-07-05 13:56:18,937: INFO: data_ingestion: Data shape after removing NaN: (100000, 12)]
[2025-07-05 13:56:18,940: INFO: data_ingestion: X shape (features): (100000, 11)]
[2025-07-05 13:56:18,940: INFO: data_ingestion: y shape (target): (100000,)]
[2025-07-05 13:56:18,941: INFO: data_ingestion: Target variable shape: (100000,)]
[2025-07-05 13:56:18,941: INFO: data_ingestion: NaN count in target: 0]
[2025-07-05 13:56:18,943: INFO: data_ingestion: Target variable distribution: 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-05 13:56:18,945: INFO: data_ingestion: Final feature matrix shape: (100000, 11)]
[2025-07-05 13:56:18,945: INFO: data_ingestion: Final target vector shape: (100000,)]
[2025-07-05 13:56:18,947: INFO: data_ingestion: Target variable distribution (normalized): 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-05 13:56:18,948: INFO: data_ingestion: Target variable is imbalanced. Applying SMOTE...]
[2025-07-05 13:56:19,012: INFO: data_ingestion: Resampled feature matrix shape: (199718, 11)]
[2025-07-05 13:56:19,014: INFO: data_ingestion: Resampled target distribution: 
isFraud
0    99859
1    99859
Name: count, dtype: int64]
[2025-07-05 13:56:20,195: INFO: data_ingestion: Created versioned input data file: artifacts\data_version\input_raw_data_version_20250705T135618.csv]
[2025-07-05 13:56:20,195: INFO: data_ingestion: Created versioned processed data file: artifacts\data_version\processed_data_version_20250705T135618.csv]
[2025-07-05 13:56:20,195: INFO: data_ingestion: Splitting data into train and test sets]
[2025-07-05 13:56:20,235: INFO: data_ingestion: Train data: (159774, 11), Test data: (39944, 11)]
[2025-07-05 13:56:20,235: INFO: data_ingestion: Data ingestion completed successfully]
[2025-07-05 13:56:20,236: INFO: data_ingestion: Data shape - Train: (159774, 11), Test: (39944, 11)]
[2025-07-05 13:56:20,238: INFO: preprocess_data: >>> Stage Data Ingestion stage completed <<<]
[2025-07-05 13:56:20,242: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x====================x]
[2025-07-05 13:56:20,242: INFO: main: >>>>>> stage Model Preparation stage started <<<<<<]
[2025-07-05 13:56:20,243: INFO: prepare_model: >>> Stage Prepare base model started <<<]
[2025-07-05 13:56:20,246: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-05 13:56:20,247: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-05 13:56:20,247: INFO: common: created directory at: artifacts]
[2025-07-05 13:56:20,248: INFO: common: created directory at: artifacts/model_version]
[2025-07-05 13:56:20,248: INFO: common: created directory at: artifacts/data_version]
[2025-07-05 13:56:20,248: INFO: configuration: Prepare base model config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'objective': 'binary:logistic', 'max_depth': 6, 'n_estimators': 300, 'random_state': 42, 'learning_rate': 0.1, 'scale_pos_weight': 10, 'n_jobs': -1}]
[2025-07-05 13:56:20,249: INFO: base_model: Creating base model and scaler]
[2025-07-05 13:56:20,249: INFO: base_model: Creating base XGBoost model]
[2025-07-05 13:56:20,249: INFO: base_model: Model params:300, 42, 0.1, 6, 10, -1]
[2025-07-05 13:56:20,249: INFO: base_model: Creating scaler from training data]
[2025-07-05 13:56:20,329: INFO: base_model: Base model saved: artifacts\model_version\base_model_churn_20250705T135620.pkl]
[2025-07-05 13:56:20,330: INFO: prepare_model: >>> Stage Prepare base model completed <<<]
[2025-07-05 13:56:20,330: INFO: main: >>>>>> stage Model Preparation stage completed <<<<<<

x====================x]
[2025-07-05 13:56:20,330: INFO: main: >>>>>> stage Model Training and Evaluation stage started <<<<<<]
[2025-07-05 13:56:20,331: INFO: train_evaluation: >>> Stage TRAIN_AND_EVALUATE_MODEL started <<<]
[2025-07-05 13:56:20,334: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-05 13:56:20,334: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-05 13:56:20,335: INFO: common: created directory at: artifacts]
[2025-07-05 13:56:20,335: INFO: common: created directory at: artifacts/model_version]
[2025-07-05 13:56:20,336: INFO: common: created directory at: artifacts/data_version]
[2025-07-05 13:56:20,336: INFO: configuration: Training config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version'}]
[2025-07-05 13:56:20,339: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-05 13:56:20,340: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-05 13:56:20,340: INFO: common: created directory at: artifacts]
[2025-07-05 13:56:20,341: INFO: common: created directory at: artifacts/evaluation]
[2025-07-05 13:56:20,341: INFO: common: created directory at: artifacts/model_version]
[2025-07-05 13:56:20,342: INFO: common: created directory at: artifacts/data_version]
[2025-07-05 13:56:20,342: INFO: configuration: Evaluation config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'evaluation_dir': 'artifacts/evaluation'}]
[2025-07-05 13:56:20,342: INFO: model_training: Initiating model training and evaluation with temporary directory management]
[2025-07-05 13:56:20,343: INFO: model_training: Loaded y_train shape: (159774,)]
[2025-07-05 13:56:20,343: INFO: model_training: Loaded y_test shape: (39944,)]
[2025-07-05 13:56:20,344: INFO: model_training: NaN count in y_train: 0]
[2025-07-05 13:56:20,344: INFO: model_training: NaN count in y_test: 0]
[2025-07-05 13:56:20,345: INFO: model_training: Final X_train_scaled shape: (159774, 11)]
[2025-07-05 13:56:20,345: INFO: model_training: Final y_train shape: (159774,)]
[2025-07-05 13:56:20,345: INFO: model_training: Final X_test_scaled shape: (39944, 11)]
[2025-07-05 13:56:20,346: INFO: model_training: Final y_test shape: (39944,)]
[2025-07-05 13:56:20,350: INFO: model_training: Loading model: XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              feature_weights=None, gamma=None, grow_policy=None,
              importance_type=None, interaction_constraints=None,
              learning_rate=0.1, max_bin=None, max_cat_threshold=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=6,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, multi_strategy=None, n_estimators=300,
              n_jobs=-1, num_parallel_tree=None, ...)]
[2025-07-05 13:56:20,351: INFO: model_training: Starting model training for model_churn_20250705T135620]
[2025-07-05 13:56:21,379: INFO: model_training: Model training for model_churn_20250705T135620 completed]
[2025-07-05 13:56:21,391: INFO: model_training:   trained model file (for future use): artifacts\model_version\model_churn_version_20250705T135620.pkl]
[2025-07-05 13:56:21,448: INFO: model_training: Model accuracy on test data: 0.9981974764670539]
[2025-07-05 13:56:21,449: INFO: model_training: Model accuracy is 85% or above, not needed finetuned, log trained model to mlflow]
[2025-07-05 13:56:21,449: INFO: model_training: Performing detailed evaluation on test data]
[2025-07-05 13:56:21,605: ERROR: model_training: Error in model training and evaluation: 'TrainAndEvaluateModel' object has no attribute 'eval_config']
[2025-07-05 13:56:21,606: ERROR: main: 'TrainAndEvaluateModel' object has no attribute 'eval_config']
Traceback (most recent call last):
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\main.py", line 33, in <module>
    train_evaluation_pipeline.main(model, X_train_scaled, X_test_scaled, y_train, y_test)
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\src\fraud_detection\pipelines\train_evaluation.py", line 25, in main
    model, metrics, final_model_path = model_processor.train_and_evaluate(
                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\src\fraud_detection\components\model_training.py", line 279, in train_and_evaluate
    raise e
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\src\fraud_detection\components\model_training.py", line 271, in train_and_evaluate
    metrics, y_pred, y_pred_prob = self.perform_detailed_evaluation(model, X_test_scaled, y_test)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\src\fraud_detection\components\model_training.py", line 121, in perform_detailed_evaluation
    os.makedirs(self.eval_config.evaluation_dir, exist_ok=True)
                ^^^^^^^^^^^^^^^^
AttributeError: 'TrainAndEvaluateModel' object has no attribute 'eval_config'. Did you mean: 'train_config'?
[2025-07-05 13:58:48,186: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2025-07-05 13:58:48,187: INFO: preprocess_data: >>> Stage Data Ingestion stage started <<<]
[2025-07-05 13:58:48,190: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-05 13:58:48,191: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-05 13:58:48,192: INFO: common: created directory at: artifacts]
[2025-07-05 13:58:48,192: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-05 13:58:48,192: INFO: common: created directory at: artifacts/data_version]
[2025-07-05 13:58:48,193: INFO: data_ingestion: Initiating data ingestion]
[2025-07-05 13:58:48,193: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-05 13:58:48,367: INFO: data_ingestion: Loaded dataset with 100000 rows]
[2025-07-05 13:58:48,368: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-05 13:58:48,368: INFO: data_ingestion: Starting preprocessing of 100000 rows...]
[2025-07-05 13:58:48,369: INFO: data_ingestion: Initial columns: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-05 13:58:48,408: INFO: data_ingestion: After feature engineering columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-05 13:58:48,408: INFO: data_ingestion: Data shape after feature engineering: (100000, 12)]
[2025-07-05 13:58:48,421: INFO: data_ingestion: First few rows of feature engineered data: 
   step      amount  oldbalanceOrg  oldbalanceDest  isFraud  ...  type_CASH_IN  type_CASH_OUT  type_DEBIT  type_PAYMENT  type_TRANSFER
0   278   330218.42       20866.00       452419.57        0  ...             1              0           0             0              0
1    15    11647.08       30370.00            0.00        0  ...             0              0           0             1              0
2    10   152264.21      106589.00       201303.01        0  ...             1              0           0             0              0
3   403  1551760.63           0.00      3198359.45        0  ...             0              0           0             0              1
4   206    78172.30     2921331.58       415821.90        0  ...             1              0           0             0              0

[5 rows x 12 columns]]
[2025-07-05 13:58:48,422: INFO: data_ingestion: After encoding columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-05 13:58:48,423: INFO: data_ingestion: Data shape after encoding: (100000, 12)]
[2025-07-05 13:58:48,430: INFO: data_ingestion: Data shape after removing NaN: (100000, 12)]
[2025-07-05 13:58:48,434: INFO: data_ingestion: X shape (features): (100000, 11)]
[2025-07-05 13:58:48,434: INFO: data_ingestion: y shape (target): (100000,)]
[2025-07-05 13:58:48,434: INFO: data_ingestion: Target variable shape: (100000,)]
[2025-07-05 13:58:48,435: INFO: data_ingestion: NaN count in target: 0]
[2025-07-05 13:58:48,437: INFO: data_ingestion: Target variable distribution: 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-05 13:58:48,438: INFO: data_ingestion: Final feature matrix shape: (100000, 11)]
[2025-07-05 13:58:48,438: INFO: data_ingestion: Final target vector shape: (100000,)]
[2025-07-05 13:58:48,440: INFO: data_ingestion: Target variable distribution (normalized): 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-05 13:58:48,441: INFO: data_ingestion: Target variable is imbalanced. Applying SMOTE...]
[2025-07-05 13:58:48,507: INFO: data_ingestion: Resampled feature matrix shape: (199718, 11)]
[2025-07-05 13:58:48,509: INFO: data_ingestion: Resampled target distribution: 
isFraud
0    99859
1    99859
Name: count, dtype: int64]
[2025-07-05 13:58:49,697: INFO: data_ingestion: Created versioned input data file: artifacts\data_version\input_raw_data_version_20250705T135848.csv]
[2025-07-05 13:58:49,698: INFO: data_ingestion: Created versioned processed data file: artifacts\data_version\processed_data_version_20250705T135848.csv]
[2025-07-05 13:58:49,698: INFO: data_ingestion: Splitting data into train and test sets]
[2025-07-05 13:58:49,741: INFO: data_ingestion: Train data: (159774, 11), Test data: (39944, 11)]
[2025-07-05 13:58:49,741: INFO: data_ingestion: Data ingestion completed successfully]
[2025-07-05 13:58:49,741: INFO: data_ingestion: Data shape - Train: (159774, 11), Test: (39944, 11)]
[2025-07-05 13:58:49,741: INFO: preprocess_data: >>> Stage Data Ingestion stage completed <<<]
[2025-07-05 13:58:49,747: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x====================x]
[2025-07-05 13:58:49,747: INFO: main: >>>>>> stage Model Preparation stage started <<<<<<]
[2025-07-05 13:58:49,747: INFO: prepare_model: >>> Stage Prepare base model started <<<]
[2025-07-05 13:58:49,753: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-05 13:58:49,754: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-05 13:58:49,754: INFO: common: created directory at: artifacts]
[2025-07-05 13:58:49,754: INFO: common: created directory at: artifacts/model_version]
[2025-07-05 13:58:49,755: INFO: common: created directory at: artifacts/data_version]
[2025-07-05 13:58:49,755: INFO: configuration: Prepare base model config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'objective': 'binary:logistic', 'max_depth': 6, 'n_estimators': 300, 'random_state': 42, 'learning_rate': 0.1, 'scale_pos_weight': 10, 'n_jobs': -1}]
[2025-07-05 13:58:49,755: INFO: base_model: Creating base model and scaler]
[2025-07-05 13:58:49,755: INFO: base_model: Creating base XGBoost model]
[2025-07-05 13:58:49,755: INFO: base_model: Model params:300, 42, 0.1, 6, 10, -1]
[2025-07-05 13:58:49,755: INFO: base_model: Creating scaler from training data]
[2025-07-05 13:58:49,837: INFO: base_model: Base model saved: artifacts\model_version\base_model_churn_20250705T135849.pkl]
[2025-07-05 13:58:49,837: INFO: prepare_model: >>> Stage Prepare base model completed <<<]
[2025-07-05 13:58:49,837: INFO: main: >>>>>> stage Model Preparation stage completed <<<<<<

x====================x]
[2025-07-05 13:58:49,837: INFO: main: >>>>>> stage Model Training and Evaluation stage started <<<<<<]
[2025-07-05 13:58:49,838: INFO: train_evaluation: >>> Stage TRAIN_AND_EVALUATE_MODEL started <<<]
[2025-07-05 13:58:49,841: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-05 13:58:49,842: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-05 13:58:49,842: INFO: common: created directory at: artifacts]
[2025-07-05 13:58:49,842: INFO: common: created directory at: artifacts/model_version]
[2025-07-05 13:58:49,843: INFO: common: created directory at: artifacts/data_version]
[2025-07-05 13:58:49,843: INFO: configuration: Training config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version'}]
[2025-07-05 13:58:49,846: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-05 13:58:49,847: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-05 13:58:49,847: INFO: common: created directory at: artifacts]
[2025-07-05 13:58:49,847: INFO: common: created directory at: artifacts/evaluation]
[2025-07-05 13:58:49,847: INFO: common: created directory at: artifacts/model_version]
[2025-07-05 13:58:49,849: INFO: common: created directory at: artifacts/data_version]
[2025-07-05 13:58:49,849: INFO: configuration: Evaluation config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'evaluation_dir': 'artifacts/evaluation'}]
[2025-07-05 13:58:49,849: INFO: model_training: Initiating model training and evaluation with temporary directory management]
[2025-07-05 13:58:49,850: INFO: model_training: Loaded y_train shape: (159774,)]
[2025-07-05 13:58:49,850: INFO: model_training: Loaded y_test shape: (39944,)]
[2025-07-05 13:58:49,850: INFO: model_training: NaN count in y_train: 0]
[2025-07-05 13:58:49,851: INFO: model_training: NaN count in y_test: 0]
[2025-07-05 13:58:49,852: INFO: model_training: Final X_train_scaled shape: (159774, 11)]
[2025-07-05 13:58:49,852: INFO: model_training: Final y_train shape: (159774,)]
[2025-07-05 13:58:49,852: INFO: model_training: Final X_test_scaled shape: (39944, 11)]
[2025-07-05 13:58:49,852: INFO: model_training: Final y_test shape: (39944,)]
[2025-07-05 13:58:49,855: INFO: model_training: Loading model: XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              feature_weights=None, gamma=None, grow_policy=None,
              importance_type=None, interaction_constraints=None,
              learning_rate=0.1, max_bin=None, max_cat_threshold=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=6,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, multi_strategy=None, n_estimators=300,
              n_jobs=-1, num_parallel_tree=None, ...)]
[2025-07-05 13:58:49,855: INFO: model_training: Starting model training for model_churn_20250705T135849]
[2025-07-05 13:58:51,011: INFO: model_training: Model training for model_churn_20250705T135849 completed]
[2025-07-05 13:58:51,021: INFO: model_training:   trained model file (for future use): artifacts\model_version\model_churn_version_20250705T135849.pkl]
[2025-07-05 13:58:51,079: INFO: model_training: Model accuracy on test data: 0.9981974764670539]
[2025-07-05 13:58:51,079: INFO: model_training: Model accuracy is 85% or above, not needed finetuned, log trained model to mlflow]
[2025-07-05 13:58:51,079: INFO: model_training: Performing detailed evaluation on test data]
[2025-07-05 13:58:51,254: INFO: common: json file saved at: artifacts\evaluation\metrics_20250705T135849.json]
[2025-07-05 13:58:51,254: INFO: model_training: Detailed metrics saved to: artifacts\evaluation\metrics_20250705T135849.json]
[2025-07-05 13:58:51,254: INFO: model_training: Creating confusion matrix plot]
[2025-07-05 13:58:51,563: INFO: model_training: Confusion matrix saved to: artifacts\evaluation\confusion_matrix_20250705T135849.png]
[2025-07-05 13:58:51,563: INFO: model_training: Creating Precision-Recall curve plot]
[2025-07-05 13:58:51,692: INFO: model_training: Precision-Recall curve saved to: artifacts\evaluation\precision_recall_curve_20250705T135849.png]
[2025-07-05 13:58:51,692: INFO: model_training: Creating ROC curve plot]
[2025-07-05 13:58:51,822: INFO: model_training: ROC curve saved to: artifacts\evaluation\roc_curve_20250705T135849.png]
[2025-07-05 13:58:51,822: INFO: train_evaluation: >>> Stage TRAIN_AND_EVALUATE_MODEL completed <<<]
[2025-07-05 13:58:51,823: INFO: main: >>>>>> stage Model Training and Evaluation stage completed <<<<<<

x====================x]
[2025-07-07 10:57:08,756: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2025-07-07 10:57:08,757: INFO: preprocess_data: >>> Stage Data Ingestion stage started <<<]
[2025-07-07 10:57:08,761: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-07 10:57:08,763: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-07 10:57:08,763: INFO: common: created directory at: artifacts]
[2025-07-07 10:57:08,764: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-07 10:57:08,764: INFO: common: created directory at: artifacts/data_version]
[2025-07-07 10:57:08,765: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-07 10:57:08,765: INFO: data_ingestion: Initiating data ingestion]
[2025-07-07 10:57:08,765: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-07 10:57:08,961: INFO: data_ingestion: Loaded dataset with 100000 rows]
[2025-07-07 10:57:08,961: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-07 10:57:08,962: INFO: data_ingestion: Starting preprocessing of 100000 rows...]
[2025-07-07 10:57:08,962: INFO: data_ingestion: Initial columns: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-07 10:57:09,011: INFO: data_ingestion: After feature engineering columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-07 10:57:09,011: INFO: data_ingestion: Data shape after feature engineering: (100000, 12)]
[2025-07-07 10:57:09,025: INFO: data_ingestion: First few rows of feature engineered data: 
   step      amount  oldbalanceOrg  oldbalanceDest  isFraud  ...  type_CASH_IN  type_CASH_OUT  type_DEBIT  type_PAYMENT  type_TRANSFER
0   278   330218.42       20866.00       452419.57        0  ...             1              0           0             0              0
1    15    11647.08       30370.00            0.00        0  ...             0              0           0             1              0
2    10   152264.21      106589.00       201303.01        0  ...             1              0           0             0              0
3   403  1551760.63           0.00      3198359.45        0  ...             0              0           0             0              1
4   206    78172.30     2921331.58       415821.90        0  ...             1              0           0             0              0

[5 rows x 12 columns]]
[2025-07-07 10:57:09,026: INFO: data_ingestion: After encoding columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-07 10:57:09,027: INFO: data_ingestion: Data shape after encoding: (100000, 12)]
[2025-07-07 10:57:09,036: INFO: data_ingestion: Data shape after removing NaN: (100000, 12)]
[2025-07-07 10:57:09,039: INFO: data_ingestion: X shape (features): (100000, 11)]
[2025-07-07 10:57:09,039: INFO: data_ingestion: y shape (target): (100000,)]
[2025-07-07 10:57:09,040: INFO: data_ingestion: Target variable shape: (100000,)]
[2025-07-07 10:57:09,040: INFO: data_ingestion: NaN count in target: 0]
[2025-07-07 10:57:09,044: INFO: data_ingestion: Target variable distribution: 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-07 10:57:09,045: INFO: data_ingestion: Final feature matrix shape: (100000, 11)]
[2025-07-07 10:57:09,045: INFO: data_ingestion: Final target vector shape: (100000,)]
[2025-07-07 10:57:09,047: INFO: data_ingestion: Target variable distribution (normalized): 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-07 10:57:09,048: INFO: data_ingestion: Target variable is imbalanced. Applying SMOTE...]
[2025-07-07 10:57:09,120: INFO: data_ingestion: Resampled feature matrix shape: (199718, 11)]
[2025-07-07 10:57:09,122: INFO: data_ingestion: Resampled target distribution: 
isFraud
0    99859
1    99859
Name: count, dtype: int64]
[2025-07-07 10:57:10,337: INFO: data_ingestion: Created versioned input data file: artifacts\data_version\input_raw_data_version_20250707T105708.csv]
[2025-07-07 10:57:10,337: INFO: data_ingestion: Created versioned processed data file: artifacts\data_version\processed_data_version_20250707T105708.csv]
[2025-07-07 10:57:10,337: INFO: data_ingestion: Splitting data into train and test sets]
[2025-07-07 10:57:10,376: INFO: data_ingestion: Train data: (159774, 11), Test data: (39944, 11)]
[2025-07-07 10:57:10,376: INFO: data_ingestion: Data ingestion completed successfully]
[2025-07-07 10:57:10,377: INFO: data_ingestion: Data shape - Train: (159774, 11), Test: (39944, 11)]
[2025-07-07 10:57:10,379: INFO: preprocess_data: >>> Stage Data Ingestion stage completed <<<]
[2025-07-07 10:57:10,383: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x====================x]
[2025-07-07 10:57:10,383: INFO: main: >>>>>> stage Model Preparation stage started <<<<<<]
[2025-07-07 10:57:10,384: ERROR: main: ModelPreparationPipeline.__init__() missing 1 required positional argument: 'mlflow_config']
Traceback (most recent call last):
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\main.py", line 21, in <module>
    model_preparation_pipeline = ModelPreparationPipeline()
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: ModelPreparationPipeline.__init__() missing 1 required positional argument: 'mlflow_config'
[2025-07-07 10:57:56,292: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2025-07-07 10:57:56,293: INFO: preprocess_data: >>> Stage Data Ingestion stage started <<<]
[2025-07-07 10:57:56,297: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-07 10:57:56,298: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-07 10:57:56,298: INFO: common: created directory at: artifacts]
[2025-07-07 10:57:56,299: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-07 10:57:56,299: INFO: common: created directory at: artifacts/data_version]
[2025-07-07 10:57:56,300: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-07 10:57:56,300: INFO: data_ingestion: Initiating data ingestion]
[2025-07-07 10:57:56,300: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-07 10:57:56,476: INFO: data_ingestion: Loaded dataset with 100000 rows]
[2025-07-07 10:57:56,476: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-07 10:57:56,477: INFO: data_ingestion: Starting preprocessing of 100000 rows...]
[2025-07-07 10:57:56,477: INFO: data_ingestion: Initial columns: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-07 10:57:56,524: INFO: data_ingestion: After feature engineering columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-07 10:57:56,525: INFO: data_ingestion: Data shape after feature engineering: (100000, 12)]
[2025-07-07 10:57:56,541: INFO: data_ingestion: First few rows of feature engineered data: 
   step      amount  oldbalanceOrg  oldbalanceDest  isFraud  ...  type_CASH_IN  type_CASH_OUT  type_DEBIT  type_PAYMENT  type_TRANSFER
0   278   330218.42       20866.00       452419.57        0  ...             1              0           0             0              0
1    15    11647.08       30370.00            0.00        0  ...             0              0           0             1              0
2    10   152264.21      106589.00       201303.01        0  ...             1              0           0             0              0
3   403  1551760.63           0.00      3198359.45        0  ...             0              0           0             0              1
4   206    78172.30     2921331.58       415821.90        0  ...             1              0           0             0              0

[5 rows x 12 columns]]
[2025-07-07 10:57:56,542: INFO: data_ingestion: After encoding columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-07 10:57:56,542: INFO: data_ingestion: Data shape after encoding: (100000, 12)]
[2025-07-07 10:57:56,555: INFO: data_ingestion: Data shape after removing NaN: (100000, 12)]
[2025-07-07 10:57:56,559: INFO: data_ingestion: X shape (features): (100000, 11)]
[2025-07-07 10:57:56,559: INFO: data_ingestion: y shape (target): (100000,)]
[2025-07-07 10:57:56,560: INFO: data_ingestion: Target variable shape: (100000,)]
[2025-07-07 10:57:56,560: INFO: data_ingestion: NaN count in target: 0]
[2025-07-07 10:57:56,562: INFO: data_ingestion: Target variable distribution: 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-07 10:57:56,564: INFO: data_ingestion: Final feature matrix shape: (100000, 11)]
[2025-07-07 10:57:56,564: INFO: data_ingestion: Final target vector shape: (100000,)]
[2025-07-07 10:57:56,567: INFO: data_ingestion: Target variable distribution (normalized): 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-07 10:57:56,567: INFO: data_ingestion: Target variable is imbalanced. Applying SMOTE...]
[2025-07-07 10:57:56,642: INFO: data_ingestion: Resampled feature matrix shape: (199718, 11)]
[2025-07-07 10:57:56,644: INFO: data_ingestion: Resampled target distribution: 
isFraud
0    99859
1    99859
Name: count, dtype: int64]
[2025-07-07 10:57:57,883: INFO: data_ingestion: Created versioned input data file: artifacts\data_version\input_raw_data_version_20250707T105756.csv]
[2025-07-07 10:57:57,883: INFO: data_ingestion: Created versioned processed data file: artifacts\data_version\processed_data_version_20250707T105756.csv]
[2025-07-07 10:57:57,883: INFO: data_ingestion: Splitting data into train and test sets]
[2025-07-07 10:57:57,928: INFO: data_ingestion: Train data: (159774, 11), Test data: (39944, 11)]
[2025-07-07 10:57:57,928: INFO: data_ingestion: Data ingestion completed successfully]
[2025-07-07 10:57:57,928: INFO: data_ingestion: Data shape - Train: (159774, 11), Test: (39944, 11)]
[2025-07-07 10:57:57,931: INFO: preprocess_data: >>> Stage Data Ingestion stage completed <<<]
[2025-07-07 10:57:57,935: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x====================x]
[2025-07-07 10:57:57,935: INFO: main: >>>>>> stage Model Preparation stage started <<<<<<]
[2025-07-07 10:57:57,936: ERROR: main: ModelPreparationPipeline.__init__() missing 1 required positional argument: 'mlflow_config']
Traceback (most recent call last):
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\main.py", line 21, in <module>
    model_preparation_pipeline = ModelPreparationPipeline()
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: ModelPreparationPipeline.__init__() missing 1 required positional argument: 'mlflow_config'
[2025-07-07 11:15:20,058: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2025-07-07 11:15:20,059: INFO: preprocess_data: >>> Stage Data Ingestion stage started <<<]
[2025-07-07 11:15:20,063: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-07 11:15:20,064: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-07 11:15:20,064: INFO: common: created directory at: artifacts]
[2025-07-07 11:15:20,065: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-07 11:15:20,066: INFO: common: created directory at: artifacts/data_version]
[2025-07-07 11:15:20,066: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-07 11:15:20,066: INFO: data_ingestion: Initiating data ingestion]
[2025-07-07 11:15:20,067: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-07 11:15:20,237: INFO: data_ingestion: Loaded dataset with 100000 rows]
[2025-07-07 11:15:20,237: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-07 11:15:20,238: INFO: data_ingestion: Starting preprocessing of 100000 rows...]
[2025-07-07 11:15:20,238: INFO: data_ingestion: Initial columns: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-07 11:15:20,281: INFO: data_ingestion: After feature engineering columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-07 11:15:20,281: INFO: data_ingestion: Data shape after feature engineering: (100000, 12)]
[2025-07-07 11:15:20,297: INFO: data_ingestion: First few rows of feature engineered data: 
   step      amount  oldbalanceOrg  ...  type_DEBIT  type_PAYMENT  type_TRANSFER
0   278   330218.42       20866.00  ...           0             0              0
1    15    11647.08       30370.00  ...           0             1              0
2    10   152264.21      106589.00  ...           0             0              0
3   403  1551760.63           0.00  ...           0             0              1
4   206    78172.30     2921331.58  ...           0             0              0

[5 rows x 12 columns]]
[2025-07-07 11:15:20,298: INFO: data_ingestion: After encoding columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-07 11:15:20,298: INFO: data_ingestion: Data shape after encoding: (100000, 12)]
[2025-07-07 11:15:20,308: INFO: data_ingestion: Data shape after removing NaN: (100000, 12)]
[2025-07-07 11:15:20,312: INFO: data_ingestion: X shape (features): (100000, 11)]
[2025-07-07 11:15:20,312: INFO: data_ingestion: y shape (target): (100000,)]
[2025-07-07 11:15:20,312: INFO: data_ingestion: Target variable shape: (100000,)]
[2025-07-07 11:15:20,313: INFO: data_ingestion: NaN count in target: 0]
[2025-07-07 11:15:20,315: INFO: data_ingestion: Target variable distribution: 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-07 11:15:20,316: INFO: data_ingestion: Final feature matrix shape: (100000, 11)]
[2025-07-07 11:15:20,317: INFO: data_ingestion: Final target vector shape: (100000,)]
[2025-07-07 11:15:20,318: INFO: data_ingestion: Target variable distribution (normalized): 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-07 11:15:20,319: INFO: data_ingestion: Target variable is imbalanced. Applying SMOTE...]
[2025-07-07 11:15:20,383: INFO: data_ingestion: Resampled feature matrix shape: (199718, 11)]
[2025-07-07 11:15:20,385: INFO: data_ingestion: Resampled target distribution: 
isFraud
0    99859
1    99859
Name: count, dtype: int64]
[2025-07-07 11:15:21,607: INFO: data_ingestion: Created versioned input data file: artifacts\data_version\input_raw_data_version_20250707T111520.csv]
[2025-07-07 11:15:21,607: INFO: data_ingestion: Created versioned processed data file: artifacts\data_version\processed_data_version_20250707T111520.csv]
[2025-07-07 11:15:21,607: INFO: data_ingestion: Splitting data into train and test sets]
[2025-07-07 11:15:21,642: INFO: data_ingestion: Train data: (159774, 11), Test data: (39944, 11)]
[2025-07-07 11:15:21,643: INFO: data_ingestion: Data ingestion completed successfully]
[2025-07-07 11:15:21,643: INFO: data_ingestion: Data shape - Train: (159774, 11), Test: (39944, 11)]
[2025-07-07 11:15:21,645: INFO: preprocess_data: >>> Stage Data Ingestion stage completed <<<]
[2025-07-07 11:15:21,649: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x====================x]
[2025-07-07 11:15:21,650: INFO: main: >>>>>> stage Model Training Pipeline started <<<<<<]
[2025-07-07 11:15:21,654: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-07 11:15:21,655: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-07 11:15:21,655: INFO: common: created directory at: artifacts]
[2025-07-07 11:15:21,655: INFO: configuration: MLFlow configuration: MLFlowConfig(dagshub_username='minh120103', dagshub_repo_name='E2E_ML', tracking_uri='https://dagshub.com/minh120103/E2E_ML.mlflow', experiment_name='Fraud_Detection_Experiment')]
[2025-07-07 11:15:32,444: INFO: _client: HTTP Request: POST https://dagshub.com/login/oauth/middleman "HTTP/1.1 200 OK"]
[2025-07-07 11:15:32,811: INFO: _client: HTTP Request: POST https://dagshub.com/login/oauth/access_token "HTTP/1.1 200 OK"]
[2025-07-07 11:15:33,162: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/user "HTTP/1.1 200 OK"]
[2025-07-07 11:15:33,166: INFO: helpers: Accessing as minh120103]
[2025-07-07 11:15:33,530: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/repos/minh120103/E2E_ML "HTTP/1.1 200 OK"]
[2025-07-07 11:15:33,858: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/user "HTTP/1.1 200 OK"]
[2025-07-07 11:15:33,860: INFO: helpers: Initialized MLflow to track repo "minh120103/E2E_ML"]
[2025-07-07 11:15:33,861: INFO: helpers: Repository minh120103/E2E_ML initialized!]
[2025-07-07 11:15:35,500: INFO: main: ==================================================]
[2025-07-07 11:15:35,500: INFO: main: Running Model Preparation]
[2025-07-07 11:15:35,501: INFO: prepare_model: >>> Stage Prepare base model started <<<]
[2025-07-07 11:15:35,506: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-07 11:15:35,507: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-07 11:15:35,508: INFO: common: created directory at: artifacts]
[2025-07-07 11:15:35,508: INFO: common: created directory at: artifacts/model_version]
[2025-07-07 11:15:35,509: INFO: common: created directory at: artifacts/data_version]
[2025-07-07 11:15:35,509: INFO: configuration: Prepare base model config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'objective': 'binary:logistic', 'max_depth': 6, 'n_estimators': 300, 'random_state': 42, 'learning_rate': 0.1, 'scale_pos_weight': 10, 'n_jobs': -1}]
[2025-07-07 11:15:35,831: INFO: base_model: Creating base model and scaler]
[2025-07-07 11:15:35,832: INFO: base_model: Creating base XGBoost model]
[2025-07-07 11:15:35,832: INFO: base_model: Model params:300, 42, 0.1, 6, 10, -1]
[2025-07-07 11:15:35,832: INFO: base_model: Creating scaler from training data]
[2025-07-07 11:15:35,911: INFO: base_model: Base model saved: artifacts\model_version\base_model_churn_20250707T111535.pkl]
[2025-07-07 11:15:37,249: INFO: prepare_model: >>> Stage Prepare base model completed <<<]
[2025-07-07 11:15:37,249: INFO: main: Base model created at: artifacts\model_version\base_model_churn_20250707T111535.pkl]
[2025-07-07 11:15:37,250: INFO: main: Scaler created at: artifacts\model_version\scaler_churn_version_20250707T111535.pkl]
[2025-07-07 11:15:37,250: INFO: main: ==================================================]
[2025-07-07 11:15:37,250: INFO: main: ==================================================]
[2025-07-07 11:15:37,251: INFO: main: Running Model Training and Evaluation]
[2025-07-07 11:15:37,251: INFO: train_evaluation: >>> Stage TRAIN_AND_EVALUATE_MODEL started <<<]
[2025-07-07 11:15:37,255: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-07 11:15:37,256: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-07 11:15:37,256: INFO: common: created directory at: artifacts]
[2025-07-07 11:15:37,257: INFO: common: created directory at: artifacts/model_version]
[2025-07-07 11:15:37,257: INFO: common: created directory at: artifacts/data_version]
[2025-07-07 11:15:37,257: INFO: configuration: Training config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version'}]
[2025-07-07 11:15:37,263: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-07 11:15:37,264: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-07 11:15:37,264: INFO: common: created directory at: artifacts]
[2025-07-07 11:15:37,265: INFO: common: created directory at: artifacts/evaluation]
[2025-07-07 11:15:37,265: INFO: common: created directory at: artifacts/model_version]
[2025-07-07 11:15:37,266: INFO: common: created directory at: artifacts/data_version]
[2025-07-07 11:15:37,266: INFO: configuration: Evaluation config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'evaluation_dir': 'artifacts/evaluation'}]
[2025-07-07 11:15:37,267: INFO: model_training: Initiating model training and evaluation with temporary directory management]
[2025-07-07 11:15:37,267: INFO: model_training: Loaded y_train shape: (159774,)]
[2025-07-07 11:15:37,267: INFO: model_training: Loaded y_test shape: (39944,)]
[2025-07-07 11:15:37,268: INFO: model_training: NaN count in y_train: 0]
[2025-07-07 11:15:37,268: INFO: model_training: NaN count in y_test: 0]
[2025-07-07 11:15:37,269: INFO: model_training: Final X_train_scaled shape: (159774, 11)]
[2025-07-07 11:15:37,269: INFO: model_training: Final y_train shape: (159774,)]
[2025-07-07 11:15:37,269: INFO: model_training: Final X_test_scaled shape: (39944, 11)]
[2025-07-07 11:15:37,269: INFO: model_training: Final y_test shape: (39944,)]
[2025-07-07 11:15:37,273: INFO: model_training: Loading model: XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              feature_weights=None, gamma=None, grow_policy=None,
              importance_type=None, interaction_constraints=None,
              learning_rate=0.1, max_bin=None, max_cat_threshold=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=6,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, multi_strategy=None, n_estimators=300,
              n_jobs=-1, num_parallel_tree=None, ...)]
[2025-07-07 11:15:37,273: INFO: model_training: Starting model training for model_churn_20250707T111537]
[2025-07-07 11:15:38,380: INFO: model_training: Model training for model_churn_20250707T111537 completed]
[2025-07-07 11:15:38,390: INFO: model_training:   trained model file (for future use): artifacts\model_version\model_churn_version_20250707T111537.pkl]
[2025-07-07 11:15:39,474: INFO: model_training: Model accuracy on test data: 0.9981974764670539]
[2025-07-07 11:15:39,474: INFO: model_training: Model accuracy is 85% or above, not needed finetuned, log trained model to mlflow]
[2025-07-07 11:15:39,475: INFO: model_training: Logging model to MLflow as model_churn_20250707T111537]
[2025-07-07 11:15:41,108: WARNING: model_training: Failed to log or register model to MLflow: INTERNAL_ERROR: Response: {'error': 'unsupported endpoint, please contact support@dagshub.com'}]
[2025-07-07 11:15:41,108: WARNING: model_training: Continuing without MLflow model registration]
[2025-07-07 11:15:41,108: INFO: model_training: Performing detailed evaluation on test data]
[2025-07-07 11:15:41,253: INFO: common: json file saved at: artifacts\evaluation\metrics_20250707T111537.json]
[2025-07-07 11:15:41,253: INFO: model_training: Detailed metrics saved to: artifacts\evaluation\metrics_20250707T111537.json]
[2025-07-07 11:16:31,499: INFO: model_training: Creating confusion matrix plot]
[2025-07-07 11:16:31,792: INFO: model_training: Confusion matrix saved to: artifacts\evaluation\confusion_matrix_20250707T111537.png]
[2025-07-07 11:16:32,440: INFO: model_training: Creating Precision-Recall curve plot]
[2025-07-07 11:16:32,573: INFO: model_training: Precision-Recall curve saved to: artifacts\evaluation\precision_recall_curve_20250707T111537.png]
[2025-07-07 11:16:33,432: INFO: model_training: Creating ROC curve plot]
[2025-07-07 11:16:33,553: INFO: model_training: ROC curve saved to: artifacts\evaluation\roc_curve_20250707T111537.png]
[2025-07-07 11:16:34,426: INFO: train_evaluation: >>> Stage TRAIN_AND_EVALUATE_MODEL completed <<<]
[2025-07-07 11:16:34,427: INFO: main: Training and evaluation completed. Final model at: artifacts\model_version\model_churn_version_20250707T111537.pkl]
[2025-07-07 11:16:34,427: INFO: main: Logged Metrics: {'precision': 0.9964678374210238, 'recall': 0.9999500773800609, 'f1_score': 0.9982059204624738, 'roc_auc': 0.9999928674808555, 'mcc': 0.9964010044780308, 'avg_precision': 0.9999927418432609, 'classification_report': {'0': {'precision': 0.9999496043944968, 'recall': 0.9964344900316376, 'f1-score': 0.9981889526109267, 'support': 19913.0}, '1': {'precision': 0.9964678374210238, 'recall': 0.9999500773800609, 'f1-score': 0.9982059204624738, 'support': 20031.0}, 'accuracy': 0.9981974764670539, 'macro avg': {'precision': 0.9982087209077604, 'recall': 0.9981922837058492, 'f1-score': 0.9981974365367002, 'support': 39944.0}, 'weighted avg': {'precision': 0.9982035781015458, 'recall': 0.9981974764670539, 'f1-score': 0.998197461599369, 'support': 39944.0}}}]
[2025-07-07 11:16:34,428: INFO: main: ==================================================]
[2025-07-07 11:16:36,301: INFO: main: >>>>>> stage Model Training Pipeline completed <<<<<<

x====================x]
[2025-07-08 10:03:55,876: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2025-07-08 10:03:55,878: INFO: preprocess_data: >>> Stage Data Ingestion stage started <<<]
[2025-07-08 10:03:55,882: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 10:03:55,884: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 10:03:55,885: INFO: common: created directory at: artifacts]
[2025-07-08 10:03:55,885: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-08 10:03:55,886: INFO: common: created directory at: artifacts/data_version]
[2025-07-08 10:03:55,886: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-08 10:03:55,887: INFO: data_ingestion: Initiating data ingestion]
[2025-07-08 10:03:55,887: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-08 10:03:56,095: INFO: data_ingestion: Loaded dataset with 100000 rows]
[2025-07-08 10:03:56,095: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-08 10:03:56,095: INFO: data_ingestion: Starting preprocessing of 100000 rows...]
[2025-07-08 10:03:56,096: INFO: data_ingestion: Initial columns: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-08 10:03:56,150: INFO: data_ingestion: After feature engineering columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-08 10:03:56,150: INFO: data_ingestion: Data shape after feature engineering: (100000, 12)]
[2025-07-08 10:03:56,169: INFO: data_ingestion: First few rows of feature engineered data: 
   step      amount  oldbalanceOrg  ...  type_DEBIT  type_PAYMENT  type_TRANSFER
0   278   330218.42       20866.00  ...           0             0              0
1    15    11647.08       30370.00  ...           0             1              0
2    10   152264.21      106589.00  ...           0             0              0
3   403  1551760.63           0.00  ...           0             0              1
4   206    78172.30     2921331.58  ...           0             0              0

[5 rows x 12 columns]]
[2025-07-08 10:03:56,170: INFO: data_ingestion: After encoding columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-08 10:03:56,171: INFO: data_ingestion: Data shape after encoding: (100000, 12)]
[2025-07-08 10:03:56,181: INFO: data_ingestion: Data shape after removing NaN: (100000, 12)]
[2025-07-08 10:03:56,185: INFO: data_ingestion: X shape (features): (100000, 11)]
[2025-07-08 10:03:56,185: INFO: data_ingestion: y shape (target): (100000,)]
[2025-07-08 10:03:56,186: INFO: data_ingestion: Target variable shape: (100000,)]
[2025-07-08 10:03:56,186: INFO: data_ingestion: NaN count in target: 0]
[2025-07-08 10:03:56,190: INFO: data_ingestion: Target variable distribution: 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-08 10:03:56,191: INFO: data_ingestion: Final feature matrix shape: (100000, 11)]
[2025-07-08 10:03:56,192: INFO: data_ingestion: Final target vector shape: (100000,)]
[2025-07-08 10:03:56,193: INFO: data_ingestion: Target variable distribution (normalized): 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-08 10:03:56,194: INFO: data_ingestion: Target variable is imbalanced. Applying SMOTE...]
[2025-07-08 10:03:56,277: INFO: data_ingestion: Resampled feature matrix shape: (199718, 11)]
[2025-07-08 10:03:56,280: INFO: data_ingestion: Resampled target distribution: 
isFraud
0    99859
1    99859
Name: count, dtype: int64]
[2025-07-08 10:03:57,544: INFO: data_ingestion: Created versioned input data file: artifacts\data_version\input_raw_data_version_20250708T100355.csv]
[2025-07-08 10:03:57,545: INFO: data_ingestion: Created versioned processed data file: artifacts\data_version\processed_data_version_20250708T100355.csv]
[2025-07-08 10:03:57,545: INFO: data_ingestion: Splitting data into train and test sets]
[2025-07-08 10:03:57,584: INFO: data_ingestion: Train data: (159774, 11), Test data: (39944, 11)]
[2025-07-08 10:03:57,585: INFO: data_ingestion: Data ingestion completed successfully]
[2025-07-08 10:03:57,585: INFO: data_ingestion: Data shape - Train: (159774, 11), Test: (39944, 11)]
[2025-07-08 10:03:57,587: INFO: preprocess_data: >>> Stage Data Ingestion stage completed <<<]
[2025-07-08 10:03:57,591: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x====================x]
[2025-07-08 10:03:57,592: INFO: main: >>>>>> stage Model Training Pipeline started <<<<<<]
[2025-07-08 10:03:57,595: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 10:03:57,596: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 10:03:57,597: INFO: common: created directory at: artifacts]
[2025-07-08 10:03:57,597: INFO: configuration: MLFlow configuration: MLFlowConfig(dagshub_username='minh120103', dagshub_repo_name='E2E_ML', tracking_uri='https://dagshub.com/minh120103/E2E_ML.mlflow', experiment_name='Fraud_Detection_Experiment')]
[2025-07-08 10:03:57,972: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/user "HTTP/1.1 200 OK"]
[2025-07-08 10:03:57,981: INFO: helpers: Accessing as minh120103]
[2025-07-08 10:03:58,453: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/repos/minh120103/E2E_ML "HTTP/1.1 200 OK"]
[2025-07-08 10:03:58,769: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/user "HTTP/1.1 200 OK"]
[2025-07-08 10:03:58,772: INFO: helpers: Initialized MLflow to track repo "minh120103/E2E_ML"]
[2025-07-08 10:03:58,773: INFO: helpers: Repository minh120103/E2E_ML initialized!]
[2025-07-08 10:03:59,844: INFO: main: ==================================================]
[2025-07-08 10:03:59,845: INFO: main: Running Model Preparation]
[2025-07-08 10:03:59,845: INFO: prepare_model: >>> Stage Prepare base model started <<<]
[2025-07-08 10:03:59,849: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 10:03:59,851: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 10:03:59,851: INFO: common: created directory at: artifacts]
[2025-07-08 10:03:59,852: INFO: common: created directory at: artifacts/model_version]
[2025-07-08 10:03:59,852: INFO: common: created directory at: artifacts/data_version]
[2025-07-08 10:03:59,853: INFO: configuration: Prepare base model config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'objective': 'binary:logistic', 'max_depth': 6, 'n_estimators': 300, 'random_state': 42, 'learning_rate': 0.1, 'scale_pos_weight': 10, 'n_jobs': -1}]
[2025-07-08 10:04:00,429: INFO: base_model: Creating base model and scaler]
[2025-07-08 10:04:00,430: INFO: base_model: Creating base XGBoost model]
[2025-07-08 10:04:00,430: INFO: base_model: Model params:300, 42, 0.1, 6, 10, -1]
[2025-07-08 10:04:00,430: INFO: base_model: Creating scaler from training data]
[2025-07-08 10:04:00,520: INFO: base_model: Base model saved: artifacts\model_version\base_model_churn_20250708T100400.pkl]
[2025-07-08 10:04:02,016: INFO: prepare_model: >>> Stage Prepare base model completed <<<]
[2025-07-08 10:04:02,016: INFO: main: Base model created at: artifacts\model_version\base_model_churn_20250708T100400.pkl]
[2025-07-08 10:04:02,017: INFO: main: Scaler created at: artifacts\model_version\scaler_churn_version_20250708T100400.pkl]
[2025-07-08 10:04:02,017: INFO: main: ==================================================]
[2025-07-08 10:04:02,017: INFO: main: ==================================================]
[2025-07-08 10:04:02,018: INFO: main: Running Model Training and Evaluation]
[2025-07-08 10:04:02,018: INFO: train_evaluation: >>> Stage TRAIN_AND_EVALUATE_MODEL started <<<]
[2025-07-08 10:04:02,022: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 10:04:02,023: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 10:04:02,024: INFO: common: created directory at: artifacts]
[2025-07-08 10:04:02,024: INFO: common: created directory at: artifacts/model_version]
[2025-07-08 10:04:02,024: INFO: common: created directory at: artifacts/data_version]
[2025-07-08 10:04:02,025: INFO: configuration: Training config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version'}]
[2025-07-08 10:04:02,029: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 10:04:02,030: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 10:04:02,031: INFO: common: created directory at: artifacts]
[2025-07-08 10:04:02,032: INFO: common: created directory at: artifacts/evaluation]
[2025-07-08 10:04:02,032: INFO: common: created directory at: artifacts/model_version]
[2025-07-08 10:04:02,033: INFO: common: created directory at: artifacts/data_version]
[2025-07-08 10:04:02,033: INFO: configuration: Evaluation config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'evaluation_dir': 'artifacts/evaluation'}]
[2025-07-08 10:04:02,033: INFO: model_training: Initiating model training and evaluation with temporary directory management]
[2025-07-08 10:04:02,034: INFO: model_training: Loaded y_train shape: (159774,)]
[2025-07-08 10:04:02,034: INFO: model_training: Loaded y_test shape: (39944,)]
[2025-07-08 10:04:02,035: INFO: model_training: NaN count in y_train: 0]
[2025-07-08 10:04:02,035: INFO: model_training: NaN count in y_test: 0]
[2025-07-08 10:04:02,036: INFO: model_training: Final X_train_scaled shape: (159774, 11)]
[2025-07-08 10:04:02,036: INFO: model_training: Final y_train shape: (159774,)]
[2025-07-08 10:04:02,037: INFO: model_training: Final X_test_scaled shape: (39944, 11)]
[2025-07-08 10:04:02,037: INFO: model_training: Final y_test shape: (39944,)]
[2025-07-08 10:04:02,041: INFO: model_training: Loading model: XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              feature_weights=None, gamma=None, grow_policy=None,
              importance_type=None, interaction_constraints=None,
              learning_rate=0.1, max_bin=None, max_cat_threshold=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=6,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, multi_strategy=None, n_estimators=300,
              n_jobs=-1, num_parallel_tree=None, ...)]
[2025-07-08 10:04:02,042: INFO: model_training: Starting model training for model_fraud_20250708T100402]
[2025-07-08 10:04:03,464: INFO: model_training: Model training for model_fraud_20250708T100402 completed]
[2025-07-08 10:04:03,478: INFO: model_training:   trained model file (for future use): artifacts\model_version\model_churn_version_20250708T100402.pkl]
[2025-07-08 10:04:04,495: INFO: model_training: Model accuracy on test data: 0.9981974764670539]
[2025-07-08 10:04:04,496: INFO: model_training: Model accuracy is 85% or above, not needed finetuned, log trained model to mlflow]
[2025-07-08 10:04:04,496: INFO: model_training: Logging model to MLflow as model_fraud_20250708T100402]
[2025-07-08 10:04:06,362: WARNING: model_training: Failed to log or register model to MLflow: INTERNAL_ERROR: Response: {'error': 'unsupported endpoint, please contact support@dagshub.com'}]
[2025-07-08 10:04:06,362: WARNING: model_training: Continuing without MLflow model registration]
[2025-07-08 10:04:06,363: INFO: model_training: Performing detailed evaluation on test data]
[2025-07-08 10:04:06,538: INFO: common: json file saved at: artifacts\evaluation\metrics_20250708T100402.json]
[2025-07-08 10:04:06,538: INFO: model_training: Detailed metrics saved to: artifacts\evaluation\metrics_20250708T100402.json]
[2025-07-08 10:04:54,768: INFO: model_training: Creating confusion matrix plot]
[2025-07-08 10:04:55,137: INFO: model_training: Confusion matrix saved to: artifacts\evaluation\confusion_matrix_20250708T100402.png]
[2025-07-08 10:04:55,709: INFO: model_training: Creating Precision-Recall curve plot]
[2025-07-08 10:04:55,852: INFO: model_training: Precision-Recall curve saved to: artifacts\evaluation\precision_recall_curve_20250708T100402.png]
[2025-07-08 10:04:56,410: INFO: model_training: Creating ROC curve plot]
[2025-07-08 10:04:56,551: INFO: model_training: ROC curve saved to: artifacts\evaluation\roc_curve_20250708T100402.png]
[2025-07-08 10:04:57,504: INFO: train_evaluation: >>> Stage TRAIN_AND_EVALUATE_MODEL completed <<<]
[2025-07-08 10:04:57,504: INFO: main: Training and evaluation completed. Final model at: artifacts\model_version\model_churn_version_20250708T100402.pkl]
[2025-07-08 10:04:57,504: INFO: main: Logged Metrics: {'precision': 0.9964678374210238, 'recall': 0.9999500773800609, 'f1_score': 0.9982059204624738, 'roc_auc': 0.9999928674808555, 'mcc': 0.9964010044780308, 'avg_precision': 0.9999927418432609, 'classification_report': {'0': {'precision': 0.9999496043944968, 'recall': 0.9964344900316376, 'f1-score': 0.9981889526109267, 'support': 19913.0}, '1': {'precision': 0.9964678374210238, 'recall': 0.9999500773800609, 'f1-score': 0.9982059204624738, 'support': 20031.0}, 'accuracy': 0.9981974764670539, 'macro avg': {'precision': 0.9982087209077604, 'recall': 0.9981922837058492, 'f1-score': 0.9981974365367002, 'support': 39944.0}, 'weighted avg': {'precision': 0.9982035781015458, 'recall': 0.9981974764670539, 'f1-score': 0.998197461599369, 'support': 39944.0}}}]
[2025-07-08 10:04:57,505: INFO: main: ==================================================]
[2025-07-08 10:04:59,214: INFO: main: >>>>>> stage Model Training Pipeline completed <<<<<<

x====================x]
[2025-07-08 13:18:35,674: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2025-07-08 13:18:35,675: INFO: preprocess_data: >>> Stage Data Ingestion stage started <<<]
[2025-07-08 13:18:35,680: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 13:18:35,682: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 13:18:35,682: INFO: common: created directory at: artifacts]
[2025-07-08 13:18:35,683: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-08 13:18:35,683: INFO: common: created directory at: artifacts/data_version]
[2025-07-08 13:18:35,684: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-08 13:18:35,684: INFO: data_ingestion: Initiating data ingestion]
[2025-07-08 13:18:35,685: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-08 13:18:35,876: INFO: data_ingestion: Loaded dataset with 100000 rows]
[2025-07-08 13:18:35,876: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-08 13:18:35,877: INFO: data_ingestion: Starting preprocessing of 100000 rows...]
[2025-07-08 13:18:35,877: INFO: data_ingestion: Initial columns: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-08 13:18:35,927: INFO: data_ingestion: After feature engineering columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-08 13:18:35,927: INFO: data_ingestion: Data shape after feature engineering: (100000, 12)]
[2025-07-08 13:18:35,941: INFO: data_ingestion: First few rows of feature engineered data: 
   step      amount  oldbalanceOrg  oldbalanceDest  isFraud  ...  type_CASH_IN  type_CASH_OUT  type_DEBIT  type_PAYMENT  type_TRANSFER
0   278   330218.42       20866.00       452419.57        0  ...             1              0           0             0              0
1    15    11647.08       30370.00            0.00        0  ...             0              0           0             1              0
2    10   152264.21      106589.00       201303.01        0  ...             1              0           0             0              0
3   403  1551760.63           0.00      3198359.45        0  ...             0              0           0             0              1
4   206    78172.30     2921331.58       415821.90        0  ...             1              0           0             0              0

[5 rows x 12 columns]]
[2025-07-08 13:18:35,942: INFO: data_ingestion: After encoding columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-08 13:18:35,942: INFO: data_ingestion: Data shape after encoding: (100000, 12)]
[2025-07-08 13:18:35,950: INFO: data_ingestion: Data shape after removing NaN: (100000, 12)]
[2025-07-08 13:18:35,954: INFO: data_ingestion: X shape (features): (100000, 11)]
[2025-07-08 13:18:35,954: INFO: data_ingestion: y shape (target): (100000,)]
[2025-07-08 13:18:35,954: INFO: data_ingestion: Target variable shape: (100000,)]
[2025-07-08 13:18:35,955: INFO: data_ingestion: NaN count in target: 0]
[2025-07-08 13:18:35,958: INFO: data_ingestion: Target variable distribution: 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-08 13:18:35,960: INFO: data_ingestion: Final feature matrix shape: (100000, 11)]
[2025-07-08 13:18:35,960: INFO: data_ingestion: Final target vector shape: (100000,)]
[2025-07-08 13:18:35,962: INFO: data_ingestion: Target variable distribution (normalized): 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-08 13:18:35,962: INFO: data_ingestion: Target variable is imbalanced. Applying SMOTE...]
[2025-07-08 13:18:36,029: INFO: data_ingestion: Resampled feature matrix shape: (199718, 11)]
[2025-07-08 13:18:36,031: INFO: data_ingestion: Resampled target distribution: 
isFraud
0    99859
1    99859
Name: count, dtype: int64]
[2025-07-08 13:18:37,295: INFO: data_ingestion: Created versioned input data file: artifacts\data_version\input_raw_data_version_20250708T131835.csv]
[2025-07-08 13:18:37,296: INFO: data_ingestion: Created versioned processed data file: artifacts\data_version\processed_data_version_20250708T131835.csv]
[2025-07-08 13:18:37,296: INFO: data_ingestion: Splitting data into train and test sets]
[2025-07-08 13:18:37,350: INFO: data_ingestion: Train data: (159774, 11), Test data: (39944, 11)]
[2025-07-08 13:18:37,351: INFO: data_ingestion: Data ingestion completed successfully]
[2025-07-08 13:18:37,351: INFO: data_ingestion: Data shape - Train: (159774, 11), Test: (39944, 11)]
[2025-07-08 13:18:37,354: INFO: preprocess_data: >>> Stage Data Ingestion stage completed <<<]
[2025-07-08 13:18:37,359: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x====================x]
[2025-07-08 13:18:37,359: INFO: main: >>>>>> stage Model Training Pipeline started <<<<<<]
[2025-07-08 13:18:37,365: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 13:18:37,366: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 13:18:37,367: INFO: common: created directory at: artifacts]
[2025-07-08 13:18:37,367: INFO: configuration: MLFlow configuration: MLFlowConfig(dagshub_username='minh120103', dagshub_repo_name='E2E_ML', tracking_uri='https://dagshub.com/minh120103/E2E_ML.mlflow', experiment_name='Fraud_Detection_Experiment')]
[2025-07-08 13:18:37,765: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/user "HTTP/1.1 200 OK"]
[2025-07-08 13:18:37,773: INFO: helpers: Accessing as minh120103]
[2025-07-08 13:18:38,153: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/repos/minh120103/E2E_ML "HTTP/1.1 200 OK"]
[2025-07-08 13:18:38,472: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/user "HTTP/1.1 200 OK"]
[2025-07-08 13:18:38,474: INFO: helpers: Initialized MLflow to track repo "minh120103/E2E_ML"]
[2025-07-08 13:18:38,475: INFO: helpers: Repository minh120103/E2E_ML initialized!]
[2025-07-08 13:18:39,510: INFO: main: ==================================================]
[2025-07-08 13:18:39,510: INFO: main: Running Model Preparation]
[2025-07-08 13:18:39,510: INFO: prepare_model: >>> Stage Prepare base model started <<<]
[2025-07-08 13:18:39,514: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 13:18:39,515: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 13:18:39,516: INFO: common: created directory at: artifacts]
[2025-07-08 13:18:39,517: INFO: common: created directory at: artifacts/model_version]
[2025-07-08 13:18:39,517: INFO: common: created directory at: artifacts/data_version]
[2025-07-08 13:18:39,517: INFO: configuration: Prepare base model config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'objective': 'binary:logistic', 'max_depth': 6, 'n_estimators': 300, 'random_state': 42, 'learning_rate': 0.1, 'scale_pos_weight': 10, 'n_jobs': -1}]
[2025-07-08 13:18:39,862: INFO: base_model: Creating base model and scaler]
[2025-07-08 13:18:39,862: INFO: base_model: Creating base XGBoost model]
[2025-07-08 13:18:39,863: INFO: base_model: Model params:300, 42, 0.1, 6, 10, -1]
[2025-07-08 13:18:39,863: INFO: base_model: Creating scaler from training data]
[2025-07-08 13:18:39,941: INFO: base_model: Base model saved: artifacts\model_version\base_model_churn_20250708T131839.pkl]
[2025-07-08 13:18:41,528: INFO: prepare_model: >>> Stage Prepare base model completed <<<]
[2025-07-08 13:18:41,529: INFO: main: Base model created at: artifacts\model_version\base_model_churn_20250708T131839.pkl]
[2025-07-08 13:18:41,529: INFO: main: Scaler created at: artifacts\model_version\scaler_churn_version_20250708T131839.pkl]
[2025-07-08 13:18:41,529: INFO: main: ==================================================]
[2025-07-08 13:18:41,529: INFO: main: ==================================================]
[2025-07-08 13:18:41,530: INFO: main: Running Model Training and Evaluation]
[2025-07-08 13:18:41,530: INFO: train_evaluation: >>> Stage TRAIN_AND_EVALUATE_MODEL started <<<]
[2025-07-08 13:18:41,533: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 13:18:41,535: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 13:18:41,535: INFO: common: created directory at: artifacts]
[2025-07-08 13:18:41,536: INFO: common: created directory at: artifacts/model_version]
[2025-07-08 13:18:41,536: INFO: common: created directory at: artifacts/data_version]
[2025-07-08 13:18:41,536: INFO: configuration: Training config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version'}]
[2025-07-08 13:18:41,540: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 13:18:41,542: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 13:18:41,543: INFO: common: created directory at: artifacts]
[2025-07-08 13:18:41,543: INFO: common: created directory at: artifacts/evaluation]
[2025-07-08 13:18:41,544: INFO: common: created directory at: artifacts/model_version]
[2025-07-08 13:18:41,544: INFO: common: created directory at: artifacts/data_version]
[2025-07-08 13:18:41,544: INFO: configuration: Evaluation config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'evaluation_dir': 'artifacts/evaluation'}]
[2025-07-08 13:18:41,545: INFO: model_training: Initiating model training and evaluation with temporary directory management]
[2025-07-08 13:18:41,545: INFO: model_training: Loaded y_train shape: (159774,)]
[2025-07-08 13:18:41,545: INFO: model_training: Loaded y_test shape: (39944,)]
[2025-07-08 13:18:41,546: INFO: model_training: NaN count in y_train: 0]
[2025-07-08 13:18:41,546: INFO: model_training: NaN count in y_test: 0]
[2025-07-08 13:18:41,547: INFO: model_training: Final X_train_scaled shape: (159774, 11)]
[2025-07-08 13:18:41,547: INFO: model_training: Final y_train shape: (159774,)]
[2025-07-08 13:18:41,547: INFO: model_training: Final X_test_scaled shape: (39944, 11)]
[2025-07-08 13:18:41,548: INFO: model_training: Final y_test shape: (39944,)]
[2025-07-08 13:18:41,552: INFO: model_training: Loading model: XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              feature_weights=None, gamma=None, grow_policy=None,
              importance_type=None, interaction_constraints=None,
              learning_rate=0.1, max_bin=None, max_cat_threshold=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=6,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, multi_strategy=None, n_estimators=300,
              n_jobs=-1, num_parallel_tree=None, ...)]
[2025-07-08 13:18:41,553: INFO: model_training: Starting model training for model_fraud_20250708T131841]
[2025-07-08 13:18:42,841: INFO: model_training: Model training for model_fraud_20250708T131841 completed]
[2025-07-08 13:18:42,855: INFO: model_training:   trained model file (for future use): artifacts\model_version\model_churn_version_20250708T131841.pkl]
[2025-07-08 13:18:43,904: INFO: model_training: Model accuracy on test data: 0.9981974764670539]
[2025-07-08 13:18:43,905: INFO: model_training: Model accuracy is 85% or above, not needed finetuned, log trained model to mlflow]
[2025-07-08 13:18:43,905: INFO: model_training: Logging model to MLflow as model_fraud_20250708T131841]
[2025-07-08 13:18:44,491: WARNING: model_training: Failed to log or register model to MLflow: INTERNAL_ERROR: Response: {'error': 'unsupported endpoint, please contact support@dagshub.com'}]
[2025-07-08 13:18:44,492: WARNING: model_training: Continuing without MLflow model registration]
[2025-07-08 13:18:44,492: INFO: model_training: Performing detailed evaluation on test data]
[2025-07-08 13:18:44,636: INFO: common: json file saved at: artifacts\evaluation\metrics_20250708T131841.json]
[2025-07-08 13:18:44,636: INFO: model_training: Detailed metrics saved to: artifacts\evaluation\metrics_20250708T131841.json]
[2025-07-08 13:19:31,245: INFO: model_training: Creating confusion matrix plot]
[2025-07-08 13:19:31,557: INFO: model_training: Confusion matrix saved to: artifacts\evaluation\confusion_matrix_20250708T131841.png]
[2025-07-08 13:19:32,165: INFO: model_training: Creating Precision-Recall curve plot]
[2025-07-08 13:19:32,298: INFO: model_training: Precision-Recall curve saved to: artifacts\evaluation\precision_recall_curve_20250708T131841.png]
[2025-07-08 13:19:33,091: INFO: model_training: Creating ROC curve plot]
[2025-07-08 13:19:33,218: INFO: model_training: ROC curve saved to: artifacts\evaluation\roc_curve_20250708T131841.png]
[2025-07-08 13:19:34,170: INFO: train_evaluation: >>> Stage TRAIN_AND_EVALUATE_MODEL completed <<<]
[2025-07-08 13:19:34,170: INFO: main: Training and evaluation completed. Final model at: artifacts\model_version\model_churn_version_20250708T131841.pkl]
[2025-07-08 13:19:34,171: INFO: main: Logged Metrics: {'precision': 0.9964678374210238, 'recall': 0.9999500773800609, 'f1_score': 0.9982059204624738, 'roc_auc': 0.9999928674808555, 'mcc': 0.9964010044780308, 'avg_precision': 0.9999927418432609, 'classification_report': {'0': {'precision': 0.9999496043944968, 'recall': 0.9964344900316376, 'f1-score': 0.9981889526109267, 'support': 19913.0}, '1': {'precision': 0.9964678374210238, 'recall': 0.9999500773800609, 'f1-score': 0.9982059204624738, 'support': 20031.0}, 'accuracy': 0.9981974764670539, 'macro avg': {'precision': 0.9982087209077604, 'recall': 0.9981922837058492, 'f1-score': 0.9981974365367002, 'support': 39944.0}, 'weighted avg': {'precision': 0.9982035781015458, 'recall': 0.9981974764670539, 'f1-score': 0.998197461599369, 'support': 39944.0}}}]
[2025-07-08 13:19:34,171: INFO: main: ==================================================]
[2025-07-08 13:19:35,915: INFO: main: >>>>>> stage Model Training Pipeline completed <<<<<<

x====================x]
[2025-07-08 13:30:49,999: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2025-07-08 13:30:49,999: INFO: preprocess_data: >>> Stage Data Ingestion stage started <<<]
[2025-07-08 13:30:50,003: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 13:30:50,004: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 13:30:50,005: INFO: common: created directory at: artifacts]
[2025-07-08 13:30:50,005: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-08 13:30:50,006: INFO: common: created directory at: artifacts/data_version]
[2025-07-08 13:30:50,006: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-08 13:30:50,006: INFO: data_ingestion: Initiating data ingestion]
[2025-07-08 13:30:50,007: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-08 13:30:50,205: INFO: data_ingestion: Loaded dataset with 100000 rows]
[2025-07-08 13:30:50,205: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-08 13:30:50,205: INFO: data_ingestion: Starting preprocessing of 100000 rows...]
[2025-07-08 13:30:50,206: INFO: data_ingestion: Initial columns: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-08 13:30:50,249: INFO: data_ingestion: After feature engineering columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-08 13:30:50,250: INFO: data_ingestion: Data shape after feature engineering: (100000, 12)]
[2025-07-08 13:30:50,266: INFO: data_ingestion: First few rows of feature engineered data: 
   step      amount  oldbalanceOrg  ...  type_DEBIT  type_PAYMENT  type_TRANSFER
0   278   330218.42       20866.00  ...           0             0              0
1    15    11647.08       30370.00  ...           0             1              0
2    10   152264.21      106589.00  ...           0             0              0
3   403  1551760.63           0.00  ...           0             0              1
4   206    78172.30     2921331.58  ...           0             0              0

[5 rows x 12 columns]]
[2025-07-08 13:30:50,267: INFO: data_ingestion: After encoding columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-08 13:30:50,267: INFO: data_ingestion: Data shape after encoding: (100000, 12)]
[2025-07-08 13:30:50,276: INFO: data_ingestion: Data shape after removing NaN: (100000, 12)]
[2025-07-08 13:30:50,279: INFO: data_ingestion: X shape (features): (100000, 11)]
[2025-07-08 13:30:50,280: INFO: data_ingestion: y shape (target): (100000,)]
[2025-07-08 13:30:50,280: INFO: data_ingestion: Target variable shape: (100000,)]
[2025-07-08 13:30:50,281: INFO: data_ingestion: NaN count in target: 0]
[2025-07-08 13:30:50,283: INFO: data_ingestion: Target variable distribution: 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-08 13:30:50,285: INFO: data_ingestion: Final feature matrix shape: (100000, 11)]
[2025-07-08 13:30:50,285: INFO: data_ingestion: Final target vector shape: (100000,)]
[2025-07-08 13:30:50,287: INFO: data_ingestion: Target variable distribution (normalized): 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-08 13:30:50,287: INFO: data_ingestion: Target variable is imbalanced. Applying SMOTE...]
[2025-07-08 13:30:50,359: INFO: data_ingestion: Resampled feature matrix shape: (199718, 11)]
[2025-07-08 13:30:50,361: INFO: data_ingestion: Resampled target distribution: 
isFraud
0    99859
1    99859
Name: count, dtype: int64]
[2025-07-08 13:30:51,600: INFO: data_ingestion: Created versioned input data file: artifacts\data_version\input_raw_data_version_20250708T133050.csv]
[2025-07-08 13:30:51,601: INFO: data_ingestion: Created versioned processed data file: artifacts\data_version\processed_data_version_20250708T133050.csv]
[2025-07-08 13:30:51,601: INFO: data_ingestion: Splitting data into train and test sets]
[2025-07-08 13:30:51,640: INFO: data_ingestion: Train data: (159774, 11), Test data: (39944, 11)]
[2025-07-08 13:30:51,640: INFO: data_ingestion: Data ingestion completed successfully]
[2025-07-08 13:30:51,641: INFO: data_ingestion: Data shape - Train: (159774, 11), Test: (39944, 11)]
[2025-07-08 13:30:51,643: INFO: preprocess_data: >>> Stage Data Ingestion stage completed <<<]
[2025-07-08 13:30:51,647: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x====================x]
[2025-07-08 13:30:51,647: INFO: main: >>>>>> stage Model Training Pipeline started <<<<<<]
[2025-07-08 13:30:51,651: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 13:30:51,653: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 13:30:51,653: INFO: common: created directory at: artifacts]
[2025-07-08 13:30:51,654: INFO: configuration: MLFlow configuration: MLFlowConfig(dagshub_username='minh120103', dagshub_repo_name='E2E_ML', tracking_uri='https://dagshub.com/minh120103/E2E_ML.mlflow', experiment_name='Fraud_Detection_Experiment')]
[2025-07-08 13:30:52,053: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/user "HTTP/1.1 200 OK"]
[2025-07-08 13:30:52,059: INFO: helpers: Accessing as minh120103]
[2025-07-08 13:30:52,437: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/repos/minh120103/E2E_ML "HTTP/1.1 200 OK"]
[2025-07-08 13:30:52,762: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/user "HTTP/1.1 200 OK"]
[2025-07-08 13:30:52,764: INFO: helpers: Initialized MLflow to track repo "minh120103/E2E_ML"]
[2025-07-08 13:30:52,765: INFO: helpers: Repository minh120103/E2E_ML initialized!]
[2025-07-08 13:30:53,813: INFO: main: ==================================================]
[2025-07-08 13:30:53,813: INFO: main: Running Model Preparation]
[2025-07-08 13:30:53,813: INFO: prepare_model: >>> Stage Prepare base model started <<<]
[2025-07-08 13:30:53,818: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 13:30:53,819: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 13:30:53,820: INFO: common: created directory at: artifacts]
[2025-07-08 13:30:53,821: INFO: common: created directory at: artifacts/model_version]
[2025-07-08 13:30:53,822: INFO: common: created directory at: artifacts/data_version]
[2025-07-08 13:30:53,822: INFO: configuration: Prepare base model config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'objective': 'binary:logistic', 'max_depth': 6, 'n_estimators': 300, 'random_state': 42, 'learning_rate': 0.1, 'scale_pos_weight': 10, 'n_jobs': -1}]
[2025-07-08 13:30:54,152: INFO: base_model: Creating base model and scaler]
[2025-07-08 13:30:54,152: INFO: base_model: Creating base XGBoost model]
[2025-07-08 13:30:54,153: INFO: base_model: Model params:300, 42, 0.1, 6, 10, -1]
[2025-07-08 13:30:54,153: INFO: base_model: Creating scaler from training data]
[2025-07-08 13:30:54,236: INFO: base_model: Base model saved: artifacts\model_version\base_model_churn_20250708T133054.pkl]
[2025-07-08 13:30:55,510: INFO: prepare_model: >>> Stage Prepare base model completed <<<]
[2025-07-08 13:30:55,510: INFO: main: Base model created at: artifacts\model_version\base_model_churn_20250708T133054.pkl]
[2025-07-08 13:30:55,511: INFO: main: Scaler created at: artifacts\model_version\scaler_churn_version_20250708T133054.pkl]
[2025-07-08 13:30:55,511: INFO: main: ==================================================]
[2025-07-08 13:30:55,511: INFO: main: ==================================================]
[2025-07-08 13:30:55,512: INFO: main: Running Model Training and Evaluation]
[2025-07-08 13:30:55,512: INFO: train_evaluation: >>> Stage TRAIN_AND_EVALUATE_MODEL started <<<]
[2025-07-08 13:30:55,515: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 13:30:55,517: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 13:30:55,517: INFO: common: created directory at: artifacts]
[2025-07-08 13:30:55,518: INFO: common: created directory at: artifacts/model_version]
[2025-07-08 13:30:55,518: INFO: common: created directory at: artifacts/data_version]
[2025-07-08 13:30:55,519: INFO: configuration: Training config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version'}]
[2025-07-08 13:30:55,524: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 13:30:55,525: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 13:30:55,526: INFO: common: created directory at: artifacts]
[2025-07-08 13:30:55,527: INFO: common: created directory at: artifacts/evaluation]
[2025-07-08 13:30:55,527: INFO: common: created directory at: artifacts/model_version]
[2025-07-08 13:30:55,527: INFO: common: created directory at: artifacts/data_version]
[2025-07-08 13:30:55,528: INFO: configuration: Evaluation config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'evaluation_dir': 'artifacts/evaluation'}]
[2025-07-08 13:30:55,528: INFO: model_training: Initiating model training and evaluation with temporary directory management]
[2025-07-08 13:30:55,528: INFO: model_training: Loaded y_train shape: (159774,)]
[2025-07-08 13:30:55,529: INFO: model_training: Loaded y_test shape: (39944,)]
[2025-07-08 13:30:55,529: INFO: model_training: NaN count in y_train: 0]
[2025-07-08 13:30:55,530: INFO: model_training: NaN count in y_test: 0]
[2025-07-08 13:30:55,530: INFO: model_training: Final X_train_scaled shape: (159774, 11)]
[2025-07-08 13:30:55,531: INFO: model_training: Final y_train shape: (159774,)]
[2025-07-08 13:30:55,531: INFO: model_training: Final X_test_scaled shape: (39944, 11)]
[2025-07-08 13:30:55,531: INFO: model_training: Final y_test shape: (39944,)]
[2025-07-08 13:30:55,534: INFO: model_training: Loading model: XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              feature_weights=None, gamma=None, grow_policy=None,
              importance_type=None, interaction_constraints=None,
              learning_rate=0.1, max_bin=None, max_cat_threshold=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=6,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, multi_strategy=None, n_estimators=300,
              n_jobs=-1, num_parallel_tree=None, ...)]
[2025-07-08 13:30:55,535: INFO: model_training: Starting model training for model_fraud_20250708T133055]
[2025-07-08 13:30:56,882: INFO: model_training: Model training for model_fraud_20250708T133055 completed]
[2025-07-08 13:30:56,895: INFO: model_training:   trained model file (for future use): artifacts\model_version\model_churn_version_20250708T133055.pkl]
[2025-07-08 13:30:57,859: INFO: model_training: Model accuracy on test data: 0.9981974764670539]
[2025-07-08 13:30:57,860: INFO: model_training: Model accuracy is 85% or above, not needed finetuned, log trained model to mlflow]
[2025-07-08 13:30:57,860: INFO: model_training: Logging model to MLflow as model_fraud_20250708T133055]
[2025-07-08 13:30:58,449: WARNING: model_training: Failed to log or register model to MLflow: INTERNAL_ERROR: Response: {'error': 'unsupported endpoint, please contact support@dagshub.com'}]
[2025-07-08 13:30:58,450: WARNING: model_training: Continuing without MLflow model registration]
[2025-07-08 13:30:58,450: INFO: model_training: Performing detailed evaluation on test data]
[2025-07-08 13:30:58,617: INFO: common: json file saved at: artifacts\evaluation\metrics_20250708T133055.json]
[2025-07-08 13:30:58,618: INFO: model_training: Detailed metrics saved to: artifacts\evaluation\metrics_20250708T133055.json]
[2025-07-08 13:31:45,345: INFO: model_training: Creating confusion matrix plot]
[2025-07-08 13:31:45,448: INFO: model_training: Confusion matrix saved to: artifacts\evaluation\confusion_matrix_20250708T133055.png]
[2025-07-08 13:31:46,370: INFO: model_training: Creating Precision-Recall curve plot]
[2025-07-08 13:31:46,523: INFO: model_training: Precision-Recall curve saved to: artifacts\evaluation\precision_recall_curve_20250708T133055.png]
[2025-07-08 13:31:47,395: INFO: model_training: Creating ROC curve plot]
[2025-07-08 13:31:47,530: INFO: model_training: ROC curve saved to: artifacts\evaluation\roc_curve_20250708T133055.png]
[2025-07-08 13:31:48,337: INFO: train_evaluation: >>> Stage TRAIN_AND_EVALUATE_MODEL completed <<<]
[2025-07-08 13:31:48,338: INFO: main: Training and evaluation completed. Final model at: artifacts\model_version\model_churn_version_20250708T133055.pkl]
[2025-07-08 13:31:48,338: INFO: main: Logged Metrics: {'precision': 0.9964678374210238, 'recall': 0.9999500773800609, 'f1_score': 0.9982059204624738, 'roc_auc': 0.9999928674808555, 'mcc': 0.9964010044780308, 'avg_precision': 0.9999927418432609, 'classification_report': {'0': {'precision': 0.9999496043944968, 'recall': 0.9964344900316376, 'f1-score': 0.9981889526109267, 'support': 19913.0}, '1': {'precision': 0.9964678374210238, 'recall': 0.9999500773800609, 'f1-score': 0.9982059204624738, 'support': 20031.0}, 'accuracy': 0.9981974764670539, 'macro avg': {'precision': 0.9982087209077604, 'recall': 0.9981922837058492, 'f1-score': 0.9981974365367002, 'support': 39944.0}, 'weighted avg': {'precision': 0.9982035781015458, 'recall': 0.9981974764670539, 'f1-score': 0.998197461599369, 'support': 39944.0}}}]
[2025-07-08 13:31:48,339: INFO: main: ==================================================]
[2025-07-08 13:31:50,191: INFO: main: >>>>>> stage Model Training Pipeline completed <<<<<<

x====================x]
[2025-07-08 13:38:56,872: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2025-07-08 13:38:56,873: INFO: preprocess_data: >>> Stage Data Ingestion stage started <<<]
[2025-07-08 13:38:56,877: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 13:38:56,878: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 13:38:56,878: INFO: common: created directory at: artifacts]
[2025-07-08 13:38:56,879: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-08 13:38:56,880: INFO: common: created directory at: artifacts/data_version]
[2025-07-08 13:38:56,880: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-08 13:38:56,880: INFO: data_ingestion: Initiating data ingestion]
[2025-07-08 13:38:56,880: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-08 13:38:57,063: INFO: data_ingestion: Loaded dataset with 100000 rows]
[2025-07-08 13:38:57,064: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-08 13:38:57,064: INFO: data_ingestion: Starting preprocessing of 100000 rows...]
[2025-07-08 13:38:57,064: INFO: data_ingestion: Initial columns: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-08 13:38:57,109: INFO: data_ingestion: After feature engineering columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-08 13:38:57,110: INFO: data_ingestion: Data shape after feature engineering: (100000, 12)]
[2025-07-08 13:38:57,123: INFO: data_ingestion: First few rows of feature engineered data: 
   step      amount  oldbalanceOrg  ...  type_DEBIT  type_PAYMENT  type_TRANSFER
0   278   330218.42       20866.00  ...           0             0              0
1    15    11647.08       30370.00  ...           0             1              0
2    10   152264.21      106589.00  ...           0             0              0
3   403  1551760.63           0.00  ...           0             0              1
4   206    78172.30     2921331.58  ...           0             0              0

[5 rows x 12 columns]]
[2025-07-08 13:38:57,124: INFO: data_ingestion: After encoding columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-08 13:38:57,124: INFO: data_ingestion: Data shape after encoding: (100000, 12)]
[2025-07-08 13:38:57,134: INFO: data_ingestion: Data shape after removing NaN: (100000, 12)]
[2025-07-08 13:38:57,138: INFO: data_ingestion: X shape (features): (100000, 11)]
[2025-07-08 13:38:57,138: INFO: data_ingestion: y shape (target): (100000,)]
[2025-07-08 13:38:57,139: INFO: data_ingestion: Target variable shape: (100000,)]
[2025-07-08 13:38:57,139: INFO: data_ingestion: NaN count in target: 0]
[2025-07-08 13:38:57,141: INFO: data_ingestion: Target variable distribution: 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-08 13:38:57,143: INFO: data_ingestion: Final feature matrix shape: (100000, 11)]
[2025-07-08 13:38:57,144: INFO: data_ingestion: Final target vector shape: (100000,)]
[2025-07-08 13:38:57,146: INFO: data_ingestion: Target variable distribution (normalized): 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-08 13:38:57,146: INFO: data_ingestion: Target variable is imbalanced. Applying SMOTE...]
[2025-07-08 13:38:57,216: INFO: data_ingestion: Resampled feature matrix shape: (199718, 11)]
[2025-07-08 13:38:57,219: INFO: data_ingestion: Resampled target distribution: 
isFraud
0    99859
1    99859
Name: count, dtype: int64]
[2025-07-08 13:38:58,479: INFO: data_ingestion: Created versioned input data file: artifacts\data_version\input_raw_data_version_20250708T133856.csv]
[2025-07-08 13:38:58,480: INFO: data_ingestion: Created versioned processed data file: artifacts\data_version\processed_data_version_20250708T133856.csv]
[2025-07-08 13:38:58,480: INFO: data_ingestion: Splitting data into train and test sets]
[2025-07-08 13:38:58,523: INFO: data_ingestion: Train data: (159774, 11), Test data: (39944, 11)]
[2025-07-08 13:38:58,524: INFO: data_ingestion: Data ingestion completed successfully]
[2025-07-08 13:38:58,524: INFO: data_ingestion: Data shape - Train: (159774, 11), Test: (39944, 11)]
[2025-07-08 13:38:58,527: INFO: preprocess_data: >>> Stage Data Ingestion stage completed <<<]
[2025-07-08 13:38:58,530: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x====================x]
[2025-07-08 13:38:58,531: INFO: main: >>>>>> stage Model Training Pipeline started <<<<<<]
[2025-07-08 13:38:58,535: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 13:38:58,536: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 13:38:58,536: INFO: common: created directory at: artifacts]
[2025-07-08 13:38:58,536: INFO: configuration: MLFlow configuration: MLFlowConfig(dagshub_username='minh120103', dagshub_repo_name='E2E_ML', tracking_uri='https://dagshub.com/minh120103/E2E_ML.mlflow', experiment_name='Fraud_Detection_Experiment')]
[2025-07-08 13:38:58,890: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/user "HTTP/1.1 200 OK"]
[2025-07-08 13:38:58,897: INFO: helpers: Accessing as minh120103]
[2025-07-08 13:38:59,256: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/repos/minh120103/E2E_ML "HTTP/1.1 200 OK"]
[2025-07-08 13:38:59,599: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/user "HTTP/1.1 200 OK"]
[2025-07-08 13:38:59,601: INFO: helpers: Initialized MLflow to track repo "minh120103/E2E_ML"]
[2025-07-08 13:38:59,602: INFO: helpers: Repository minh120103/E2E_ML initialized!]
[2025-07-08 13:39:00,648: INFO: main: ==================================================]
[2025-07-08 13:39:00,649: INFO: main: Running Model Preparation]
[2025-07-08 13:39:00,649: INFO: prepare_model: >>> Stage Prepare base model started <<<]
[2025-07-08 13:39:00,653: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 13:39:00,654: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 13:39:00,654: INFO: common: created directory at: artifacts]
[2025-07-08 13:39:00,655: INFO: common: created directory at: artifacts/model_version]
[2025-07-08 13:39:00,655: INFO: common: created directory at: artifacts/data_version]
[2025-07-08 13:39:00,656: INFO: configuration: Prepare base model config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'objective': 'binary:logistic', 'max_depth': 6, 'n_estimators': 300, 'random_state': 42, 'learning_rate': 0.1, 'scale_pos_weight': 10, 'n_jobs': -1}]
[2025-07-08 13:39:00,973: INFO: base_model: Creating base model and scaler]
[2025-07-08 13:39:00,973: INFO: base_model: Creating base XGBoost model]
[2025-07-08 13:39:00,973: INFO: base_model: Model params:300, 42, 0.1, 6, 10, -1]
[2025-07-08 13:39:00,974: INFO: base_model: Creating scaler from training data]
[2025-07-08 13:39:01,056: INFO: base_model: Base model saved: artifacts\model_version\base_model_churn_20250708T133900.pkl]
[2025-07-08 13:39:02,474: INFO: prepare_model: >>> Stage Prepare base model completed <<<]
[2025-07-08 13:39:02,474: INFO: main: Base model created at: artifacts\model_version\base_model_churn_20250708T133900.pkl]
[2025-07-08 13:39:02,475: INFO: main: Scaler created at: artifacts\model_version\scaler_churn_version_20250708T133900.pkl]
[2025-07-08 13:39:02,475: INFO: main: ==================================================]
[2025-07-08 13:39:02,476: INFO: main: ==================================================]
[2025-07-08 13:39:02,476: INFO: main: Running Model Training and Evaluation]
[2025-07-08 13:39:02,476: INFO: train_evaluation: >>> Stage TRAIN_AND_EVALUATE_MODEL started <<<]
[2025-07-08 13:39:02,480: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 13:39:02,481: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 13:39:02,481: INFO: common: created directory at: artifacts]
[2025-07-08 13:39:02,482: INFO: common: created directory at: artifacts/model_version]
[2025-07-08 13:39:02,482: INFO: common: created directory at: artifacts/data_version]
[2025-07-08 13:39:02,483: INFO: configuration: Training config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version'}]
[2025-07-08 13:39:02,486: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 13:39:02,487: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 13:39:02,487: INFO: common: created directory at: artifacts]
[2025-07-08 13:39:02,488: INFO: common: created directory at: artifacts/evaluation]
[2025-07-08 13:39:02,489: INFO: common: created directory at: artifacts/model_version]
[2025-07-08 13:39:02,489: INFO: common: created directory at: artifacts/data_version]
[2025-07-08 13:39:02,490: INFO: configuration: Evaluation config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'evaluation_dir': 'artifacts/evaluation'}]
[2025-07-08 13:39:02,490: INFO: model_training: Initiating model training and evaluation with temporary directory management]
[2025-07-08 13:39:02,490: INFO: model_training: Loaded y_train shape: (159774,)]
[2025-07-08 13:39:02,491: INFO: model_training: Loaded y_test shape: (39944,)]
[2025-07-08 13:39:02,491: INFO: model_training: NaN count in y_train: 0]
[2025-07-08 13:39:02,492: INFO: model_training: NaN count in y_test: 0]
[2025-07-08 13:39:02,492: INFO: model_training: Final X_train_scaled shape: (159774, 11)]
[2025-07-08 13:39:02,492: INFO: model_training: Final y_train shape: (159774,)]
[2025-07-08 13:39:02,493: INFO: model_training: Final X_test_scaled shape: (39944, 11)]
[2025-07-08 13:39:02,493: INFO: model_training: Final y_test shape: (39944,)]
[2025-07-08 13:39:02,495: INFO: model_training: Loading model: XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              feature_weights=None, gamma=None, grow_policy=None,
              importance_type=None, interaction_constraints=None,
              learning_rate=0.1, max_bin=None, max_cat_threshold=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=6,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, multi_strategy=None, n_estimators=300,
              n_jobs=-1, num_parallel_tree=None, ...)]
[2025-07-08 13:39:02,497: INFO: model_training: Starting model training for model_fraud_20250708T133902]
[2025-07-08 13:39:03,666: INFO: model_training: Model training for model_fraud_20250708T133902 completed]
[2025-07-08 13:39:03,678: INFO: model_training:   trained model file (for future use): artifacts\model_version\model_churn_version_20250708T133902.pkl]
[2025-07-08 13:39:04,689: INFO: model_training: Model accuracy on test data: 0.9981974764670539]
[2025-07-08 13:39:04,689: INFO: model_training: Model accuracy is 85% or above, not needed finetuned, log trained model to mlflow]
[2025-07-08 13:39:04,690: INFO: model_training: Logging model to MLflow as model_fraud_20250708T133902]
[2025-07-08 13:39:05,267: WARNING: model_training: Failed to log or register model to MLflow: INTERNAL_ERROR: Response: {'error': 'unsupported endpoint, please contact support@dagshub.com'}]
[2025-07-08 13:39:05,267: WARNING: model_training: Continuing without MLflow model registration]
[2025-07-08 13:39:05,268: INFO: model_training: Performing detailed evaluation on test data]
[2025-07-08 13:39:05,413: INFO: common: json file saved at: artifacts\evaluation\metrics_20250708T133902.json]
[2025-07-08 13:39:05,414: INFO: model_training: Detailed metrics saved to: artifacts\evaluation\metrics_20250708T133902.json]
[2025-07-08 13:39:52,182: INFO: model_training: Creating confusion matrix plot]
[2025-07-08 13:39:52,292: INFO: model_training: Confusion matrix saved to: artifacts\evaluation\confusion_matrix_20250708T133902.png]
[2025-07-08 13:39:53,192: INFO: model_training: Creating Precision-Recall curve plot]
[2025-07-08 13:39:53,333: INFO: model_training: Precision-Recall curve saved to: artifacts\evaluation\precision_recall_curve_20250708T133902.png]
[2025-07-08 13:39:54,186: INFO: model_training: Creating ROC curve plot]
[2025-07-08 13:39:54,318: INFO: model_training: ROC curve saved to: artifacts\evaluation\roc_curve_20250708T133902.png]
[2025-07-08 13:39:55,179: INFO: train_evaluation: >>> Stage TRAIN_AND_EVALUATE_MODEL completed <<<]
[2025-07-08 13:39:55,180: INFO: main: Training and evaluation completed. Final model at: artifacts\model_version\model_churn_version_20250708T133902.pkl]
[2025-07-08 13:39:55,180: INFO: main: Logged Metrics: {'precision': 0.9964678374210238, 'recall': 0.9999500773800609, 'f1_score': 0.9982059204624738, 'roc_auc': 0.9999928674808555, 'mcc': 0.9964010044780308, 'avg_precision': 0.9999927418432609, 'classification_report': {'0': {'precision': 0.9999496043944968, 'recall': 0.9964344900316376, 'f1-score': 0.9981889526109267, 'support': 19913.0}, '1': {'precision': 0.9964678374210238, 'recall': 0.9999500773800609, 'f1-score': 0.9982059204624738, 'support': 20031.0}, 'accuracy': 0.9981974764670539, 'macro avg': {'precision': 0.9982087209077604, 'recall': 0.9981922837058492, 'f1-score': 0.9981974365367002, 'support': 39944.0}, 'weighted avg': {'precision': 0.9982035781015458, 'recall': 0.9981974764670539, 'f1-score': 0.998197461599369, 'support': 39944.0}}}]
[2025-07-08 13:39:55,180: INFO: main: ==================================================]
[2025-07-08 13:39:57,040: INFO: main: >>>>>> stage Model Training Pipeline completed <<<<<<

x====================x]
[2025-07-08 13:42:15,106: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2025-07-08 13:42:15,107: INFO: preprocess_data: >>> Stage Data Ingestion stage started <<<]
[2025-07-08 13:42:15,111: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 13:42:15,112: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 13:42:15,112: INFO: common: created directory at: artifacts]
[2025-07-08 13:42:15,113: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-08 13:42:15,113: INFO: common: created directory at: artifacts/data_version]
[2025-07-08 13:42:15,113: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-08 13:42:15,114: INFO: data_ingestion: Initiating data ingestion]
[2025-07-08 13:42:15,114: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-08 13:42:15,293: INFO: data_ingestion: Loaded dataset with 100000 rows]
[2025-07-08 13:42:15,293: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-08 13:42:15,294: INFO: data_ingestion: Starting preprocessing of 100000 rows...]
[2025-07-08 13:42:15,294: INFO: data_ingestion: Initial columns: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-08 13:42:15,338: INFO: data_ingestion: After feature engineering columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-08 13:42:15,338: INFO: data_ingestion: Data shape after feature engineering: (100000, 12)]
[2025-07-08 13:42:15,353: INFO: data_ingestion: First few rows of feature engineered data: 
   step      amount  oldbalanceOrg  ...  type_DEBIT  type_PAYMENT  type_TRANSFER
0   278   330218.42       20866.00  ...           0             0              0
1    15    11647.08       30370.00  ...           0             1              0
2    10   152264.21      106589.00  ...           0             0              0
3   403  1551760.63           0.00  ...           0             0              1
4   206    78172.30     2921331.58  ...           0             0              0

[5 rows x 12 columns]]
[2025-07-08 13:42:15,354: INFO: data_ingestion: After encoding columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-08 13:42:15,354: INFO: data_ingestion: Data shape after encoding: (100000, 12)]
[2025-07-08 13:42:15,361: INFO: data_ingestion: Data shape after removing NaN: (100000, 12)]
[2025-07-08 13:42:15,364: INFO: data_ingestion: X shape (features): (100000, 11)]
[2025-07-08 13:42:15,364: INFO: data_ingestion: y shape (target): (100000,)]
[2025-07-08 13:42:15,365: INFO: data_ingestion: Target variable shape: (100000,)]
[2025-07-08 13:42:15,365: INFO: data_ingestion: NaN count in target: 0]
[2025-07-08 13:42:15,368: INFO: data_ingestion: Target variable distribution: 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-08 13:42:15,369: INFO: data_ingestion: Final feature matrix shape: (100000, 11)]
[2025-07-08 13:42:15,370: INFO: data_ingestion: Final target vector shape: (100000,)]
[2025-07-08 13:42:15,372: INFO: data_ingestion: Target variable distribution (normalized): 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-08 13:42:15,372: INFO: data_ingestion: Target variable is imbalanced. Applying SMOTE...]
[2025-07-08 13:42:15,443: INFO: data_ingestion: Resampled feature matrix shape: (199718, 11)]
[2025-07-08 13:42:15,445: INFO: data_ingestion: Resampled target distribution: 
isFraud
0    99859
1    99859
Name: count, dtype: int64]
[2025-07-08 13:42:16,664: INFO: data_ingestion: Created versioned input data file: artifacts\data_version\input_raw_data_version_20250708T134215.csv]
[2025-07-08 13:42:16,664: INFO: data_ingestion: Created versioned processed data file: artifacts\data_version\processed_data_version_20250708T134215.csv]
[2025-07-08 13:42:16,664: INFO: data_ingestion: Splitting data into train and test sets]
[2025-07-08 13:42:16,704: INFO: data_ingestion: Train data: (159774, 11), Test data: (39944, 11)]
[2025-07-08 13:42:16,704: INFO: data_ingestion: Data ingestion completed successfully]
[2025-07-08 13:42:16,704: INFO: data_ingestion: Data shape - Train: (159774, 11), Test: (39944, 11)]
[2025-07-08 13:42:16,706: INFO: preprocess_data: >>> Stage Data Ingestion stage completed <<<]
[2025-07-08 13:42:16,712: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x====================x]
[2025-07-08 13:42:16,712: INFO: main: >>>>>> stage Model Training Pipeline started <<<<<<]
[2025-07-08 13:42:16,716: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 13:42:16,717: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 13:42:16,717: INFO: common: created directory at: artifacts]
[2025-07-08 13:42:16,718: INFO: configuration: MLFlow configuration: MLFlowConfig(dagshub_username='minh120103', dagshub_repo_name='E2E_ML', tracking_uri='https://dagshub.com/minh120103/E2E_ML.mlflow', experiment_name='Fraud_Detection_Experiment')]
[2025-07-08 13:42:17,078: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/user "HTTP/1.1 200 OK"]
[2025-07-08 13:42:17,083: INFO: helpers: Accessing as minh120103]
[2025-07-08 13:42:17,450: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/repos/minh120103/E2E_ML "HTTP/1.1 200 OK"]
[2025-07-08 13:42:17,773: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/user "HTTP/1.1 200 OK"]
[2025-07-08 13:42:17,775: INFO: helpers: Initialized MLflow to track repo "minh120103/E2E_ML"]
[2025-07-08 13:42:17,776: INFO: helpers: Repository minh120103/E2E_ML initialized!]
[2025-07-08 13:42:18,791: INFO: main: ==================================================]
[2025-07-08 13:42:18,791: INFO: main: Running Model Preparation]
[2025-07-08 13:42:18,792: INFO: prepare_model: >>> Stage Prepare base model started <<<]
[2025-07-08 13:42:18,795: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 13:42:18,796: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 13:42:18,797: INFO: common: created directory at: artifacts]
[2025-07-08 13:42:18,798: INFO: common: created directory at: artifacts/model_version]
[2025-07-08 13:42:18,798: INFO: common: created directory at: artifacts/data_version]
[2025-07-08 13:42:18,799: INFO: configuration: Prepare base model config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'objective': 'binary:logistic', 'max_depth': 6, 'n_estimators': 300, 'random_state': 42, 'learning_rate': 0.1, 'scale_pos_weight': 10, 'n_jobs': -1}]
[2025-07-08 13:42:19,135: INFO: base_model: Creating base model and scaler]
[2025-07-08 13:42:19,135: INFO: base_model: Creating base XGBoost model]
[2025-07-08 13:42:19,135: INFO: base_model: Model params:300, 42, 0.1, 6, 10, -1]
[2025-07-08 13:42:19,136: INFO: base_model: Creating scaler from training data]
[2025-07-08 13:42:19,212: INFO: base_model: Base model saved: artifacts\model_version\base_model_churn_20250708T134219.pkl]
[2025-07-08 13:42:20,528: INFO: prepare_model: >>> Stage Prepare base model completed <<<]
[2025-07-08 13:42:20,528: INFO: main: Base model created at: artifacts\model_version\base_model_churn_20250708T134219.pkl]
[2025-07-08 13:42:20,529: INFO: main: Scaler created at: artifacts\model_version\scaler_churn_version_20250708T134219.pkl]
[2025-07-08 13:42:20,529: INFO: main: ==================================================]
[2025-07-08 13:42:20,529: INFO: main: ==================================================]
[2025-07-08 13:42:20,529: INFO: main: Running Model Training and Evaluation]
[2025-07-08 13:42:20,530: INFO: train_evaluation: >>> Stage TRAIN_AND_EVALUATE_MODEL started <<<]
[2025-07-08 13:42:20,533: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 13:42:20,534: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 13:42:20,535: INFO: common: created directory at: artifacts]
[2025-07-08 13:42:20,535: INFO: common: created directory at: artifacts/model_version]
[2025-07-08 13:42:20,536: INFO: common: created directory at: artifacts/data_version]
[2025-07-08 13:42:20,536: INFO: configuration: Training config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version'}]
[2025-07-08 13:42:20,539: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 13:42:20,541: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 13:42:20,541: INFO: common: created directory at: artifacts]
[2025-07-08 13:42:20,542: INFO: common: created directory at: artifacts/evaluation]
[2025-07-08 13:42:20,542: INFO: common: created directory at: artifacts/model_version]
[2025-07-08 13:42:20,543: INFO: common: created directory at: artifacts/data_version]
[2025-07-08 13:42:20,543: INFO: configuration: Evaluation config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'evaluation_dir': 'artifacts/evaluation'}]
[2025-07-08 13:42:20,543: INFO: model_training: Initiating model training and evaluation with temporary directory management]
[2025-07-08 13:42:20,544: INFO: model_training: Loaded y_train shape: (159774,)]
[2025-07-08 13:42:20,544: INFO: model_training: Loaded y_test shape: (39944,)]
[2025-07-08 13:42:20,545: INFO: model_training: NaN count in y_train: 0]
[2025-07-08 13:42:20,545: INFO: model_training: NaN count in y_test: 0]
[2025-07-08 13:42:20,546: INFO: model_training: Final X_train_scaled shape: (159774, 11)]
[2025-07-08 13:42:20,546: INFO: model_training: Final y_train shape: (159774,)]
[2025-07-08 13:42:20,546: INFO: model_training: Final X_test_scaled shape: (39944, 11)]
[2025-07-08 13:42:20,546: INFO: model_training: Final y_test shape: (39944,)]
[2025-07-08 13:42:20,549: INFO: model_training: Loading model: XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              feature_weights=None, gamma=None, grow_policy=None,
              importance_type=None, interaction_constraints=None,
              learning_rate=0.1, max_bin=None, max_cat_threshold=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=6,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, multi_strategy=None, n_estimators=300,
              n_jobs=-1, num_parallel_tree=None, ...)]
[2025-07-08 13:42:20,550: INFO: model_training: Starting model training for model_fraud_20250708T134220]
[2025-07-08 13:42:21,739: INFO: model_training: Model training for model_fraud_20250708T134220 completed]
[2025-07-08 13:42:21,754: INFO: model_training:   trained model file (for future use): artifacts\model_version\model_churn_version_20250708T134220.pkl]
[2025-07-08 13:42:22,757: INFO: model_training: Model accuracy on test data: 0.9981974764670539]
[2025-07-08 13:42:22,758: INFO: model_training: Model accuracy is 85% or above, not needed finetuned, log trained model to mlflow]
[2025-07-08 13:42:22,758: INFO: model_training: Logging model to MLflow as model_fraud_20250708T134220]
[2025-07-08 13:42:23,343: WARNING: model_training: Failed to log or register model to MLflow: INTERNAL_ERROR: Response: {'error': 'unsupported endpoint, please contact support@dagshub.com'}]
[2025-07-08 13:42:23,343: WARNING: model_training: Continuing without MLflow model registration]
[2025-07-08 13:42:23,344: INFO: model_training: Performing detailed evaluation on test data]
[2025-07-08 13:42:23,504: INFO: common: json file saved at: artifacts\evaluation\metrics_20250708T134220.json]
[2025-07-08 13:42:23,504: INFO: model_training: Detailed metrics saved to: artifacts\evaluation\metrics_20250708T134220.json]
[2025-07-08 13:43:10,374: INFO: model_training: Creating confusion matrix plot]
[2025-07-08 13:43:10,482: INFO: model_training: Confusion matrix saved to: artifacts\evaluation\confusion_matrix_20250708T134220.png]
[2025-07-08 13:43:11,348: INFO: model_training: Creating Precision-Recall curve plot]
[2025-07-08 13:43:11,483: INFO: model_training: Precision-Recall curve saved to: artifacts\evaluation\precision_recall_curve_20250708T134220.png]
[2025-07-08 13:43:12,342: INFO: model_training: Creating ROC curve plot]
[2025-07-08 13:43:12,469: INFO: model_training: ROC curve saved to: artifacts\evaluation\roc_curve_20250708T134220.png]
[2025-07-08 13:43:13,353: INFO: train_evaluation: >>> Stage TRAIN_AND_EVALUATE_MODEL completed <<<]
[2025-07-08 13:43:13,353: INFO: main: Training and evaluation completed. Final model at: artifacts\model_version\model_churn_version_20250708T134220.pkl]
[2025-07-08 13:43:13,353: INFO: main: Logged Metrics: {'precision': 0.9964678374210238, 'recall': 0.9999500773800609, 'f1_score': 0.9982059204624738, 'roc_auc': 0.9999928674808555, 'mcc': 0.9964010044780308, 'avg_precision': 0.9999927418432609, 'classification_report': {'0': {'precision': 0.9999496043944968, 'recall': 0.9964344900316376, 'f1-score': 0.9981889526109267, 'support': 19913.0}, '1': {'precision': 0.9964678374210238, 'recall': 0.9999500773800609, 'f1-score': 0.9982059204624738, 'support': 20031.0}, 'accuracy': 0.9981974764670539, 'macro avg': {'precision': 0.9982087209077604, 'recall': 0.9981922837058492, 'f1-score': 0.9981974365367002, 'support': 39944.0}, 'weighted avg': {'precision': 0.9982035781015458, 'recall': 0.9981974764670539, 'f1-score': 0.998197461599369, 'support': 39944.0}}}]
[2025-07-08 13:43:13,354: INFO: main: ==================================================]
[2025-07-08 13:43:15,202: INFO: main: >>>>>> stage Model Training Pipeline completed <<<<<<

x====================x]
[2025-07-08 14:28:36,332: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2025-07-08 14:28:36,333: INFO: preprocess_data: >>> Stage Data Ingestion stage started <<<]
[2025-07-08 14:28:36,337: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 14:28:36,339: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 14:28:36,340: INFO: common: created directory at: artifacts]
[2025-07-08 14:28:36,340: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-08 14:28:36,341: INFO: common: created directory at: artifacts/data_version]
[2025-07-08 14:28:36,341: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-08 14:28:36,342: INFO: data_ingestion: Initiating data ingestion]
[2025-07-08 14:28:36,342: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-08 14:28:36,512: INFO: data_ingestion: Loaded dataset with 100000 rows]
[2025-07-08 14:28:36,513: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-08 14:28:36,514: INFO: data_ingestion: Starting preprocessing of 100000 rows...]
[2025-07-08 14:28:36,514: INFO: data_ingestion: Initial columns: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-08 14:28:36,561: INFO: data_ingestion: After feature engineering columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-08 14:28:36,561: INFO: data_ingestion: Data shape after feature engineering: (100000, 12)]
[2025-07-08 14:28:36,577: INFO: data_ingestion: First few rows of feature engineered data: 
   step      amount  oldbalanceOrg  ...  type_DEBIT  type_PAYMENT  type_TRANSFER
0   278   330218.42       20866.00  ...           0             0              0
1    15    11647.08       30370.00  ...           0             1              0
2    10   152264.21      106589.00  ...           0             0              0
3   403  1551760.63           0.00  ...           0             0              1
4   206    78172.30     2921331.58  ...           0             0              0

[5 rows x 12 columns]]
[2025-07-08 14:28:36,578: INFO: data_ingestion: After encoding columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-08 14:28:36,579: INFO: data_ingestion: Data shape after encoding: (100000, 12)]
[2025-07-08 14:28:36,586: INFO: data_ingestion: Data shape after removing NaN: (100000, 12)]
[2025-07-08 14:28:36,589: INFO: data_ingestion: X shape (features): (100000, 11)]
[2025-07-08 14:28:36,589: INFO: data_ingestion: y shape (target): (100000,)]
[2025-07-08 14:28:36,590: INFO: data_ingestion: Target variable shape: (100000,)]
[2025-07-08 14:28:36,590: INFO: data_ingestion: NaN count in target: 0]
[2025-07-08 14:28:36,593: INFO: data_ingestion: Target variable distribution: 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-08 14:28:36,595: INFO: data_ingestion: Final feature matrix shape: (100000, 11)]
[2025-07-08 14:28:36,595: INFO: data_ingestion: Final target vector shape: (100000,)]
[2025-07-08 14:28:36,597: INFO: data_ingestion: Target variable distribution (normalized): 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-08 14:28:36,597: INFO: data_ingestion: Target variable is imbalanced. Applying SMOTE...]
[2025-07-08 14:28:36,661: INFO: data_ingestion: Resampled feature matrix shape: (199718, 11)]
[2025-07-08 14:28:36,663: INFO: data_ingestion: Resampled target distribution: 
isFraud
0    99859
1    99859
Name: count, dtype: int64]
[2025-07-08 14:28:37,892: INFO: data_ingestion: Created versioned input data file: artifacts\data_version\input_raw_data_version_20250708T142836.csv]
[2025-07-08 14:28:37,892: INFO: data_ingestion: Created versioned processed data file: artifacts\data_version\processed_data_version_20250708T142836.csv]
[2025-07-08 14:28:37,892: INFO: data_ingestion: Splitting data into train and test sets]
[2025-07-08 14:28:37,931: INFO: data_ingestion: Train data: (159774, 11), Test data: (39944, 11)]
[2025-07-08 14:28:37,931: INFO: data_ingestion: Data ingestion completed successfully]
[2025-07-08 14:28:37,932: INFO: data_ingestion: Data shape - Train: (159774, 11), Test: (39944, 11)]
[2025-07-08 14:28:37,935: INFO: preprocess_data: >>> Stage Data Ingestion stage completed <<<]
[2025-07-08 14:28:37,942: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x====================x]
[2025-07-08 14:28:37,942: INFO: main: >>>>>> stage Model Training Pipeline started <<<<<<]
[2025-07-08 14:28:37,946: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 14:28:37,948: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 14:28:37,949: INFO: common: created directory at: artifacts]
[2025-07-08 14:28:37,949: INFO: configuration: MLFlow configuration: MLFlowConfig(dagshub_username='minh120103', dagshub_repo_name='E2E_ML', tracking_uri='https://dagshub.com/minh120103/E2E_ML.mlflow', experiment_name='Fraud_Detection_Experiment')]
[2025-07-08 14:28:38,320: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/user "HTTP/1.1 200 OK"]
[2025-07-08 14:28:38,326: INFO: helpers: Accessing as minh120103]
[2025-07-08 14:28:38,679: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/repos/minh120103/E2E_ML "HTTP/1.1 200 OK"]
[2025-07-08 14:28:39,019: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/user "HTTP/1.1 200 OK"]
[2025-07-08 14:28:39,022: INFO: helpers: Initialized MLflow to track repo "minh120103/E2E_ML"]
[2025-07-08 14:28:39,023: INFO: helpers: Repository minh120103/E2E_ML initialized!]
[2025-07-08 14:28:40,040: INFO: main: ==================================================]
[2025-07-08 14:28:40,041: INFO: main: Running Model Preparation]
[2025-07-08 14:28:40,041: INFO: prepare_model: >>> Stage Prepare base model started <<<]
[2025-07-08 14:28:40,047: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 14:28:40,048: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 14:28:40,048: INFO: common: created directory at: artifacts]
[2025-07-08 14:28:40,049: INFO: common: created directory at: artifacts/model_version]
[2025-07-08 14:28:40,049: INFO: common: created directory at: artifacts/data_version]
[2025-07-08 14:28:40,050: INFO: configuration: Prepare base model config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'objective': 'binary:logistic', 'max_depth': 6, 'n_estimators': 300, 'random_state': 42, 'learning_rate': 0.1, 'scale_pos_weight': 10, 'n_jobs': -1}]
[2025-07-08 14:28:40,365: INFO: base_model: Creating base model and scaler]
[2025-07-08 14:28:40,365: INFO: base_model: Creating base XGBoost model]
[2025-07-08 14:28:40,366: INFO: base_model: Model params:300, 42, 0.1, 6, 10, -1]
[2025-07-08 14:28:40,366: INFO: base_model: Creating scaler from training data]
[2025-07-08 14:28:40,443: INFO: base_model: Base model saved: artifacts\model_version\base_model_churn_20250708T142840.pkl]
[2025-07-08 14:28:41,741: INFO: prepare_model: >>> Stage Prepare base model completed <<<]
[2025-07-08 14:28:41,742: INFO: main: Base model created at: artifacts\model_version\base_model_churn_20250708T142840.pkl]
[2025-07-08 14:28:41,742: INFO: main: Scaler created at: artifacts\model_version\scaler_churn_version_20250708T142840.pkl]
[2025-07-08 14:28:41,742: INFO: main: ==================================================]
[2025-07-08 14:28:41,743: INFO: main: ==================================================]
[2025-07-08 14:28:41,743: INFO: main: Running Model Training and Evaluation]
[2025-07-08 14:28:41,743: INFO: train_evaluation: >>> Stage TRAIN_AND_EVALUATE_MODEL started <<<]
[2025-07-08 14:28:41,747: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 14:28:41,748: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 14:28:41,748: INFO: common: created directory at: artifacts]
[2025-07-08 14:28:41,749: INFO: common: created directory at: artifacts/model_version]
[2025-07-08 14:28:41,749: INFO: common: created directory at: artifacts/data_version]
[2025-07-08 14:28:41,750: INFO: configuration: Training config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version'}]
[2025-07-08 14:28:41,753: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 14:28:41,754: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 14:28:41,755: INFO: common: created directory at: artifacts]
[2025-07-08 14:28:41,755: INFO: common: created directory at: artifacts/evaluation]
[2025-07-08 14:28:41,756: INFO: common: created directory at: artifacts/model_version]
[2025-07-08 14:28:41,756: INFO: common: created directory at: artifacts/data_version]
[2025-07-08 14:28:41,756: INFO: configuration: Evaluation config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'evaluation_dir': 'artifacts/evaluation'}]
[2025-07-08 14:28:41,757: INFO: model_training: Initiating model training and evaluation with temporary directory management]
[2025-07-08 14:28:41,757: INFO: model_training: Loaded y_train shape: (159774,)]
[2025-07-08 14:28:41,757: INFO: model_training: Loaded y_test shape: (39944,)]
[2025-07-08 14:28:41,758: INFO: model_training: NaN count in y_train: 0]
[2025-07-08 14:28:41,758: INFO: model_training: NaN count in y_test: 0]
[2025-07-08 14:28:41,759: INFO: model_training: Final X_train_scaled shape: (159774, 11)]
[2025-07-08 14:28:41,759: INFO: model_training: Final y_train shape: (159774,)]
[2025-07-08 14:28:41,759: INFO: model_training: Final X_test_scaled shape: (39944, 11)]
[2025-07-08 14:28:41,759: INFO: model_training: Final y_test shape: (39944,)]
[2025-07-08 14:28:41,762: INFO: model_training: Loading model: XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              feature_weights=None, gamma=None, grow_policy=None,
              importance_type=None, interaction_constraints=None,
              learning_rate=0.1, max_bin=None, max_cat_threshold=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=6,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, multi_strategy=None, n_estimators=300,
              n_jobs=-1, num_parallel_tree=None, ...)]
[2025-07-08 14:28:41,763: INFO: model_training: Starting model training for model_fraud_20250708T142841]
[2025-07-08 14:28:42,925: INFO: model_training: Model training for model_fraud_20250708T142841 completed]
[2025-07-08 14:28:42,938: INFO: model_training:   trained model file (for future use): artifacts\model_version\model_churn_version_20250708T142841.pkl]
[2025-07-08 14:28:43,306: INFO: model_training: Model accuracy on test data: 0.9981974764670539]
[2025-07-08 14:28:43,306: INFO: model_training: Model accuracy is 85% or above, not needed finetuned, log trained model to mlflow]
[2025-07-08 14:28:43,307: INFO: model_training: Logging model to MLflow as model_fraud_20250708T142841]
[2025-07-08 14:28:43,307: WARNING: model_training: Failed to log or register model to MLflow: log_model() missing 1 required positional argument: 'artifact_path']
[2025-07-08 14:28:43,307: WARNING: model_training: Continuing without MLflow model registration]
[2025-07-08 14:28:43,308: INFO: model_training: Performing detailed evaluation on test data]
[2025-07-08 14:28:43,460: INFO: common: json file saved at: artifacts\evaluation\metrics_20250708T142841.json]
[2025-07-08 14:28:43,461: INFO: model_training: Detailed metrics saved to: artifacts\evaluation\metrics_20250708T142841.json]
[2025-07-08 14:28:53,820: INFO: model_training: Creating confusion matrix plot]
[2025-07-08 14:28:53,944: INFO: model_training: Confusion matrix saved to: artifacts\evaluation\confusion_matrix_20250708T142841.png]
[2025-07-08 14:28:54,609: INFO: model_training: Creating Precision-Recall curve plot]
[2025-07-08 14:28:54,742: INFO: model_training: Precision-Recall curve saved to: artifacts\evaluation\precision_recall_curve_20250708T142841.png]
[2025-07-08 14:28:55,600: INFO: model_training: Creating ROC curve plot]
[2025-07-08 14:28:55,725: INFO: model_training: ROC curve saved to: artifacts\evaluation\roc_curve_20250708T142841.png]
[2025-07-08 14:28:56,608: INFO: train_evaluation: >>> Stage TRAIN_AND_EVALUATE_MODEL completed <<<]
[2025-07-08 14:28:56,610: INFO: main: Training and evaluation completed. Final model at: artifacts\model_version\model_churn_version_20250708T142841.pkl]
[2025-07-08 14:28:56,610: INFO: main: Logged Metrics: {'precision': 0.9964678374210238, 'recall': 0.9999500773800609, 'f1_score': 0.9982059204624738, 'roc_auc': 0.9999928674808555, 'mcc': 0.9964010044780308, 'avg_precision': 0.9999927418432609, 'classification_report': {'0': {'precision': 0.9999496043944968, 'recall': 0.9964344900316376, 'f1-score': 0.9981889526109267, 'support': 19913.0}, '1': {'precision': 0.9964678374210238, 'recall': 0.9999500773800609, 'f1-score': 0.9982059204624738, 'support': 20031.0}, 'accuracy': 0.9981974764670539, 'macro avg': {'precision': 0.9982087209077604, 'recall': 0.9981922837058492, 'f1-score': 0.9981974365367002, 'support': 39944.0}, 'weighted avg': {'precision': 0.9982035781015458, 'recall': 0.9981974764670539, 'f1-score': 0.998197461599369, 'support': 39944.0}}}]
[2025-07-08 14:28:56,611: INFO: main: ==================================================]
[2025-07-08 14:28:57,464: INFO: main: >>>>>> stage Model Training Pipeline completed <<<<<<

x====================x]
[2025-07-08 14:29:50,713: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2025-07-08 14:29:50,713: INFO: preprocess_data: >>> Stage Data Ingestion stage started <<<]
[2025-07-08 14:29:50,717: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 14:29:50,718: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 14:29:50,719: INFO: common: created directory at: artifacts]
[2025-07-08 14:29:50,719: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-08 14:29:50,720: INFO: common: created directory at: artifacts/data_version]
[2025-07-08 14:29:50,720: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-08 14:29:50,721: INFO: data_ingestion: Initiating data ingestion]
[2025-07-08 14:29:50,721: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-08 14:29:50,893: INFO: data_ingestion: Loaded dataset with 100000 rows]
[2025-07-08 14:29:50,894: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-08 14:29:50,894: INFO: data_ingestion: Starting preprocessing of 100000 rows...]
[2025-07-08 14:29:50,894: INFO: data_ingestion: Initial columns: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-08 14:29:50,936: INFO: data_ingestion: After feature engineering columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-08 14:29:50,937: INFO: data_ingestion: Data shape after feature engineering: (100000, 12)]
[2025-07-08 14:29:50,950: INFO: data_ingestion: First few rows of feature engineered data: 
   step      amount  oldbalanceOrg  ...  type_DEBIT  type_PAYMENT  type_TRANSFER
0   278   330218.42       20866.00  ...           0             0              0
1    15    11647.08       30370.00  ...           0             1              0
2    10   152264.21      106589.00  ...           0             0              0
3   403  1551760.63           0.00  ...           0             0              1
4   206    78172.30     2921331.58  ...           0             0              0

[5 rows x 12 columns]]
[2025-07-08 14:29:50,951: INFO: data_ingestion: After encoding columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-08 14:29:50,952: INFO: data_ingestion: Data shape after encoding: (100000, 12)]
[2025-07-08 14:29:50,960: INFO: data_ingestion: Data shape after removing NaN: (100000, 12)]
[2025-07-08 14:29:50,964: INFO: data_ingestion: X shape (features): (100000, 11)]
[2025-07-08 14:29:50,964: INFO: data_ingestion: y shape (target): (100000,)]
[2025-07-08 14:29:50,964: INFO: data_ingestion: Target variable shape: (100000,)]
[2025-07-08 14:29:50,965: INFO: data_ingestion: NaN count in target: 0]
[2025-07-08 14:29:50,967: INFO: data_ingestion: Target variable distribution: 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-08 14:29:50,968: INFO: data_ingestion: Final feature matrix shape: (100000, 11)]
[2025-07-08 14:29:50,969: INFO: data_ingestion: Final target vector shape: (100000,)]
[2025-07-08 14:29:50,971: INFO: data_ingestion: Target variable distribution (normalized): 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-08 14:29:50,971: INFO: data_ingestion: Target variable is imbalanced. Applying SMOTE...]
[2025-07-08 14:29:51,041: INFO: data_ingestion: Resampled feature matrix shape: (199718, 11)]
[2025-07-08 14:29:51,043: INFO: data_ingestion: Resampled target distribution: 
isFraud
0    99859
1    99859
Name: count, dtype: int64]
[2025-07-08 14:29:52,309: INFO: data_ingestion: Created versioned input data file: artifacts\data_version\input_raw_data_version_20250708T142950.csv]
[2025-07-08 14:29:52,310: INFO: data_ingestion: Created versioned processed data file: artifacts\data_version\processed_data_version_20250708T142950.csv]
[2025-07-08 14:29:52,310: INFO: data_ingestion: Splitting data into train and test sets]
[2025-07-08 14:29:52,345: INFO: data_ingestion: Train data: (159774, 11), Test data: (39944, 11)]
[2025-07-08 14:29:52,345: INFO: data_ingestion: Data ingestion completed successfully]
[2025-07-08 14:29:52,346: INFO: data_ingestion: Data shape - Train: (159774, 11), Test: (39944, 11)]
[2025-07-08 14:29:52,348: INFO: preprocess_data: >>> Stage Data Ingestion stage completed <<<]
[2025-07-08 14:29:52,352: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x====================x]
[2025-07-08 14:29:52,353: INFO: main: >>>>>> stage Model Training Pipeline started <<<<<<]
[2025-07-08 14:29:52,356: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 14:29:52,358: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 14:29:52,358: INFO: common: created directory at: artifacts]
[2025-07-08 14:29:52,359: INFO: configuration: MLFlow configuration: MLFlowConfig(dagshub_username='minh120103', dagshub_repo_name='E2E_ML', tracking_uri='https://dagshub.com/minh120103/E2E_ML.mlflow', experiment_name='Fraud_Detection_Experiment')]
[2025-07-08 14:29:52,713: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/user "HTTP/1.1 200 OK"]
[2025-07-08 14:29:52,719: INFO: helpers: Accessing as minh120103]
[2025-07-08 14:29:53,084: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/repos/minh120103/E2E_ML "HTTP/1.1 200 OK"]
[2025-07-08 14:29:53,436: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/user "HTTP/1.1 200 OK"]
[2025-07-08 14:29:53,438: INFO: helpers: Initialized MLflow to track repo "minh120103/E2E_ML"]
[2025-07-08 14:29:53,439: INFO: helpers: Repository minh120103/E2E_ML initialized!]
[2025-07-08 14:29:54,451: INFO: main: ==================================================]
[2025-07-08 14:29:54,451: INFO: main: Running Model Preparation]
[2025-07-08 14:29:54,452: INFO: prepare_model: >>> Stage Prepare base model started <<<]
[2025-07-08 14:29:54,458: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 14:29:54,459: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 14:29:54,459: INFO: common: created directory at: artifacts]
[2025-07-08 14:29:54,460: INFO: common: created directory at: artifacts/model_version]
[2025-07-08 14:29:54,460: INFO: common: created directory at: artifacts/data_version]
[2025-07-08 14:29:54,461: INFO: configuration: Prepare base model config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'objective': 'binary:logistic', 'max_depth': 6, 'n_estimators': 300, 'random_state': 42, 'learning_rate': 0.1, 'scale_pos_weight': 10, 'n_jobs': -1}]
[2025-07-08 14:29:54,793: INFO: base_model: Creating base model and scaler]
[2025-07-08 14:29:54,794: INFO: base_model: Creating base XGBoost model]
[2025-07-08 14:29:54,794: INFO: base_model: Model params:300, 42, 0.1, 6, 10, -1]
[2025-07-08 14:29:54,794: INFO: base_model: Creating scaler from training data]
[2025-07-08 14:29:54,871: INFO: base_model: Base model saved: artifacts\model_version\base_model_churn_20250708T142954.pkl]
[2025-07-08 14:29:56,106: INFO: prepare_model: >>> Stage Prepare base model completed <<<]
[2025-07-08 14:29:56,106: INFO: main: Base model created at: artifacts\model_version\base_model_churn_20250708T142954.pkl]
[2025-07-08 14:29:56,106: INFO: main: Scaler created at: artifacts\model_version\scaler_churn_version_20250708T142954.pkl]
[2025-07-08 14:29:56,107: INFO: main: ==================================================]
[2025-07-08 14:29:56,107: INFO: main: ==================================================]
[2025-07-08 14:29:56,107: INFO: main: Running Model Training and Evaluation]
[2025-07-08 14:29:56,108: INFO: train_evaluation: >>> Stage TRAIN_AND_EVALUATE_MODEL started <<<]
[2025-07-08 14:29:56,111: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 14:29:56,112: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 14:29:56,113: INFO: common: created directory at: artifacts]
[2025-07-08 14:29:56,113: INFO: common: created directory at: artifacts/model_version]
[2025-07-08 14:29:56,114: INFO: common: created directory at: artifacts/data_version]
[2025-07-08 14:29:56,114: INFO: configuration: Training config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version'}]
[2025-07-08 14:29:56,118: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 14:29:56,119: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 14:29:56,119: INFO: common: created directory at: artifacts]
[2025-07-08 14:29:56,120: INFO: common: created directory at: artifacts/evaluation]
[2025-07-08 14:29:56,120: INFO: common: created directory at: artifacts/model_version]
[2025-07-08 14:29:56,121: INFO: common: created directory at: artifacts/data_version]
[2025-07-08 14:29:56,121: INFO: configuration: Evaluation config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'evaluation_dir': 'artifacts/evaluation'}]
[2025-07-08 14:29:56,122: INFO: model_training: Initiating model training and evaluation with temporary directory management]
[2025-07-08 14:29:56,122: INFO: model_training: Loaded y_train shape: (159774,)]
[2025-07-08 14:29:56,122: INFO: model_training: Loaded y_test shape: (39944,)]
[2025-07-08 14:29:56,123: INFO: model_training: NaN count in y_train: 0]
[2025-07-08 14:29:56,123: INFO: model_training: NaN count in y_test: 0]
[2025-07-08 14:29:56,124: INFO: model_training: Final X_train_scaled shape: (159774, 11)]
[2025-07-08 14:29:56,124: INFO: model_training: Final y_train shape: (159774,)]
[2025-07-08 14:29:56,124: INFO: model_training: Final X_test_scaled shape: (39944, 11)]
[2025-07-08 14:29:56,124: INFO: model_training: Final y_test shape: (39944,)]
[2025-07-08 14:29:56,127: INFO: model_training: Loading model: XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              feature_weights=None, gamma=None, grow_policy=None,
              importance_type=None, interaction_constraints=None,
              learning_rate=0.1, max_bin=None, max_cat_threshold=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=6,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, multi_strategy=None, n_estimators=300,
              n_jobs=-1, num_parallel_tree=None, ...)]
[2025-07-08 14:29:56,127: INFO: model_training: Starting model training for model_fraud_20250708T142956]
[2025-07-08 14:29:57,182: INFO: model_training: Model training for model_fraud_20250708T142956 completed]
[2025-07-08 14:29:57,193: INFO: model_training:   trained model file (for future use): artifacts\model_version\model_churn_version_20250708T142956.pkl]
[2025-07-08 14:29:57,557: INFO: model_training: Model accuracy on test data: 0.9981974764670539]
[2025-07-08 14:29:57,557: INFO: model_training: Model accuracy is 85% or above, not needed finetuned, log trained model to mlflow]
[2025-07-08 14:29:57,557: INFO: model_training: Logging model to MLflow as model_fraud_20250708T142956]
[2025-07-08 14:30:17,041: INFO: model_training: Successfully registered model under unique name: XGBoost]
[2025-07-08 14:30:17,042: INFO: model_training: Performing detailed evaluation on test data]
[2025-07-08 14:30:17,180: INFO: common: json file saved at: artifacts\evaluation\metrics_20250708T142956.json]
[2025-07-08 14:30:17,180: INFO: model_training: Detailed metrics saved to: artifacts\evaluation\metrics_20250708T142956.json]
[2025-07-08 14:30:29,692: INFO: model_training: Creating confusion matrix plot]
[2025-07-08 14:30:29,797: INFO: model_training: Confusion matrix saved to: artifacts\evaluation\confusion_matrix_20250708T142956.png]
[2025-07-08 14:30:30,763: INFO: model_training: Creating Precision-Recall curve plot]
[2025-07-08 14:30:30,901: INFO: model_training: Precision-Recall curve saved to: artifacts\evaluation\precision_recall_curve_20250708T142956.png]
[2025-07-08 14:30:31,716: INFO: model_training: Creating ROC curve plot]
[2025-07-08 14:30:31,843: INFO: model_training: ROC curve saved to: artifacts\evaluation\roc_curve_20250708T142956.png]
[2025-07-08 14:30:32,748: INFO: train_evaluation: >>> Stage TRAIN_AND_EVALUATE_MODEL completed <<<]
[2025-07-08 14:30:32,748: INFO: main: Training and evaluation completed. Final model at: artifacts\model_version\model_churn_version_20250708T142956.pkl]
[2025-07-08 14:30:32,748: INFO: main: Logged Metrics: {'precision': 0.9964678374210238, 'recall': 0.9999500773800609, 'f1_score': 0.9982059204624738, 'roc_auc': 0.9999928674808555, 'mcc': 0.9964010044780308, 'avg_precision': 0.9999927418432609, 'classification_report': {'0': {'precision': 0.9999496043944968, 'recall': 0.9964344900316376, 'f1-score': 0.9981889526109267, 'support': 19913.0}, '1': {'precision': 0.9964678374210238, 'recall': 0.9999500773800609, 'f1-score': 0.9982059204624738, 'support': 20031.0}, 'accuracy': 0.9981974764670539, 'macro avg': {'precision': 0.9982087209077604, 'recall': 0.9981922837058492, 'f1-score': 0.9981974365367002, 'support': 39944.0}, 'weighted avg': {'precision': 0.9982035781015458, 'recall': 0.9981974764670539, 'f1-score': 0.998197461599369, 'support': 39944.0}}}]
[2025-07-08 14:30:32,749: INFO: main: ==================================================]
[2025-07-08 14:30:33,562: INFO: main: >>>>>> stage Model Training Pipeline completed <<<<<<

x====================x]
[2025-07-08 17:01:21,988: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 17:01:21,991: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 17:01:21,992: INFO: common: created directory at: artifacts]
[2025-07-08 17:02:13,890: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 17:02:13,892: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 17:02:13,892: INFO: common: created directory at: artifacts]
[2025-07-08 17:03:47,014: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 17:03:47,016: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 17:03:47,016: INFO: common: created directory at: artifacts]
[2025-07-08 17:03:47,016: INFO: configuration: MLFlow configuration: MLFlowConfig(dagshub_username='minh120103', dagshub_repo_name='E2E_ML', tracking_uri='https://dagshub.com/minh120103/E2E_ML.mlflow', experiment_name='Fraud_Detection_Experiment')]
[2025-07-08 17:03:47,016: INFO: predict_pipeline: Loading model from: runs:/621b0660b6674e21b5f7090fbc211a6f/models]
[2025-07-08 21:05:20,508: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-08 21:05:20,510: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-08 21:05:20,510: INFO: common: created directory at: artifacts]
[2025-07-08 21:05:20,510: INFO: configuration: MLFlow configuration: MLFlowConfig(dagshub_username='minh120103', dagshub_repo_name='E2E_ML', tracking_uri='https://dagshub.com/minh120103/E2E_ML.mlflow', experiment_name='Fraud_Detection_Experiment')]
[2025-07-08 21:05:20,511: INFO: predict_pipeline: Loading model from: runs:/621b0660b6674e21b5f7090fbc211a6f/models]
[2025-07-09 13:27:10,775: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2025-07-09 13:27:10,776: INFO: preprocess_data: >>> Stage Data Ingestion stage started <<<]
[2025-07-09 13:27:10,779: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 13:27:10,781: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 13:27:10,782: INFO: common: created directory at: artifacts]
[2025-07-09 13:27:10,783: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-09 13:27:10,784: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 13:27:10,784: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-09 13:27:10,785: INFO: data_ingestion: Initiating data ingestion]
[2025-07-09 13:27:10,785: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-09 13:27:11,016: INFO: data_ingestion: Loaded dataset with 100000 rows]
[2025-07-09 13:27:11,017: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-09 13:27:11,017: INFO: data_ingestion: Starting preprocessing of 100000 rows...]
[2025-07-09 13:27:11,017: INFO: data_ingestion: Initial columns: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-09 13:27:11,069: INFO: data_ingestion: After feature engineering columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-09 13:27:11,069: INFO: data_ingestion: Data shape after feature engineering: (100000, 12)]
[2025-07-09 13:27:11,085: INFO: data_ingestion: First few rows of feature engineered data: 
   step      amount  oldbalanceOrg  ...  type_DEBIT  type_PAYMENT  type_TRANSFER
0   278   330218.42       20866.00  ...           0             0              0
1    15    11647.08       30370.00  ...           0             1              0
2    10   152264.21      106589.00  ...           0             0              0
3   403  1551760.63           0.00  ...           0             0              1
4   206    78172.30     2921331.58  ...           0             0              0

[5 rows x 12 columns]]
[2025-07-09 13:27:11,086: INFO: data_ingestion: After encoding columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-09 13:27:11,086: INFO: data_ingestion: Data shape after encoding: (100000, 12)]
[2025-07-09 13:27:11,095: INFO: data_ingestion: Data shape after removing NaN: (100000, 12)]
[2025-07-09 13:27:11,099: INFO: data_ingestion: X shape (features): (100000, 11)]
[2025-07-09 13:27:11,099: INFO: data_ingestion: y shape (target): (100000,)]
[2025-07-09 13:27:11,099: INFO: data_ingestion: Target variable shape: (100000,)]
[2025-07-09 13:27:11,100: INFO: data_ingestion: NaN count in target: 0]
[2025-07-09 13:27:11,104: INFO: data_ingestion: Target variable distribution: 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-09 13:27:11,106: INFO: data_ingestion: Final feature matrix shape: (100000, 11)]
[2025-07-09 13:27:11,106: INFO: data_ingestion: Final target vector shape: (100000,)]
[2025-07-09 13:27:11,108: INFO: data_ingestion: Target variable distribution (normalized): 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-09 13:27:11,108: INFO: data_ingestion: Target variable is imbalanced. Applying SMOTE...]
[2025-07-09 13:27:11,182: INFO: data_ingestion: Resampled feature matrix shape: (199718, 11)]
[2025-07-09 13:27:11,185: INFO: data_ingestion: Resampled target distribution: 
isFraud
0    99859
1    99859
Name: count, dtype: int64]
[2025-07-09 13:27:12,472: INFO: data_ingestion: Created versioned input data file: artifacts\data_version\input_raw_data_version_20250709T132710.csv]
[2025-07-09 13:27:12,472: INFO: data_ingestion: Created versioned processed data file: artifacts\data_version\processed_data_version_20250709T132710.csv]
[2025-07-09 13:27:12,473: INFO: data_ingestion: Splitting data into train and test sets]
[2025-07-09 13:27:12,508: INFO: data_ingestion: Train data: (159774, 11), Test data: (39944, 11)]
[2025-07-09 13:27:12,508: INFO: data_ingestion: Data ingestion completed successfully]
[2025-07-09 13:27:12,508: INFO: data_ingestion: Data shape - Train: (159774, 11), Test: (39944, 11)]
[2025-07-09 13:27:12,511: INFO: preprocess_data: >>> Stage Data Ingestion stage completed <<<]
[2025-07-09 13:27:12,515: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x====================x]
[2025-07-09 13:27:12,515: INFO: main: >>>>>> stage Model Training Pipeline started <<<<<<]
[2025-07-09 13:27:12,520: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 13:27:12,521: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 13:27:12,521: INFO: common: created directory at: artifacts]
[2025-07-09 13:27:12,522: INFO: configuration: MLFlow configuration: MLFlowConfig(dagshub_username='minh120103', dagshub_repo_name='E2E_ML', tracking_uri='https://dagshub.com/minh120103/E2E_ML.mlflow', experiment_name='Fraud_Detection_Experiment')]
[2025-07-09 13:27:12,905: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/user "HTTP/1.1 200 OK"]
[2025-07-09 13:27:12,912: INFO: helpers: Accessing as minh120103]
[2025-07-09 13:27:13,262: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/repos/minh120103/E2E_ML "HTTP/1.1 200 OK"]
[2025-07-09 13:27:13,601: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/user "HTTP/1.1 200 OK"]
[2025-07-09 13:27:13,603: INFO: helpers: Initialized MLflow to track repo "minh120103/E2E_ML"]
[2025-07-09 13:27:13,604: INFO: helpers: Repository minh120103/E2E_ML initialized!]
[2025-07-09 13:27:14,719: INFO: main: ==================================================]
[2025-07-09 13:27:14,719: INFO: main: Running Model Preparation]
[2025-07-09 13:27:14,719: INFO: prepare_model: >>> Stage Prepare base model started <<<]
[2025-07-09 13:27:14,723: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 13:27:14,724: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 13:27:14,725: INFO: common: created directory at: artifacts]
[2025-07-09 13:27:14,725: INFO: common: created directory at: artifacts/model_version]
[2025-07-09 13:27:14,726: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 13:27:14,726: INFO: configuration: Prepare base model config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'objective': 'binary:logistic', 'max_depth': 6, 'n_estimators': 300, 'random_state': 42, 'learning_rate': 0.1, 'scale_pos_weight': 10, 'n_jobs': -1}]
[2025-07-09 13:27:15,039: INFO: base_model: Creating base model and scaler]
[2025-07-09 13:27:15,039: INFO: base_model: Creating base XGBoost model]
[2025-07-09 13:27:15,039: INFO: base_model: Model params:300, 42, 0.1, 6, 10, -1]
[2025-07-09 13:27:15,040: INFO: base_model: Creating scaler from training data]
[2025-07-09 13:27:15,122: INFO: base_model: Base model saved: artifacts\model_version\base_model_churn_20250709T132715.pkl]
[2025-07-09 13:27:16,852: INFO: prepare_model: >>> Stage Prepare base model completed <<<]
[2025-07-09 13:27:16,853: INFO: main: Base model created at: artifacts\model_version\base_model_churn_20250709T132715.pkl]
[2025-07-09 13:27:16,853: INFO: main: Scaler created at: artifacts\model_version\scaler_churn_version_20250709T132715.pkl]
[2025-07-09 13:27:16,853: INFO: main: ==================================================]
[2025-07-09 13:27:16,854: INFO: main: ==================================================]
[2025-07-09 13:27:16,854: INFO: main: Running Model Training and Evaluation]
[2025-07-09 13:27:16,854: INFO: train_evaluation: >>> Stage TRAIN_AND_EVALUATE_MODEL started <<<]
[2025-07-09 13:27:16,858: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 13:27:16,859: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 13:27:16,860: INFO: common: created directory at: artifacts]
[2025-07-09 13:27:16,860: INFO: common: created directory at: artifacts/model_version]
[2025-07-09 13:27:16,861: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 13:27:16,861: INFO: configuration: Training config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version'}]
[2025-07-09 13:27:16,864: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 13:27:16,866: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 13:27:16,866: INFO: common: created directory at: artifacts]
[2025-07-09 13:27:16,867: INFO: common: created directory at: artifacts/evaluation]
[2025-07-09 13:27:16,868: INFO: common: created directory at: artifacts/model_version]
[2025-07-09 13:27:16,868: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 13:27:16,869: INFO: configuration: Evaluation config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'evaluation_dir': 'artifacts/evaluation'}]
[2025-07-09 13:27:16,869: INFO: model_training: Initiating model training and evaluation with temporary directory management]
[2025-07-09 13:27:16,869: INFO: model_training: Loaded y_train shape: (159774,)]
[2025-07-09 13:27:16,869: INFO: model_training: Loaded y_test shape: (39944,)]
[2025-07-09 13:27:16,869: INFO: model_training: NaN count in y_train: 0]
[2025-07-09 13:27:16,870: INFO: model_training: NaN count in y_test: 0]
[2025-07-09 13:27:16,870: INFO: model_training: Final X_train_scaled shape: (159774, 11)]
[2025-07-09 13:27:16,871: INFO: model_training: Final y_train shape: (159774,)]
[2025-07-09 13:27:16,871: INFO: model_training: Final X_test_scaled shape: (39944, 11)]
[2025-07-09 13:27:16,871: INFO: model_training: Final y_test shape: (39944,)]
[2025-07-09 13:27:16,877: INFO: model_training: Loading model: XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              feature_weights=None, gamma=None, grow_policy=None,
              importance_type=None, interaction_constraints=None,
              learning_rate=0.1, max_bin=None, max_cat_threshold=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=6,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, multi_strategy=None, n_estimators=300,
              n_jobs=-1, num_parallel_tree=None, ...)]
[2025-07-09 13:27:16,878: INFO: model_training: Starting model training for model_fraud_20250709T132716]
[2025-07-09 13:27:18,300: INFO: model_training: Model training for model_fraud_20250709T132716 completed]
[2025-07-09 13:27:18,310: INFO: model_training:   trained model file (for future use): artifacts\model_version\model_churn_version_20250709T132716.pkl]
[2025-07-09 13:27:18,686: INFO: model_training: Model accuracy on test data: 0.9981974764670539]
[2025-07-09 13:27:18,686: INFO: model_training: Model accuracy is 85% or above, not needed finetuned, log trained model to mlflow]
[2025-07-09 13:27:18,687: INFO: model_training: Logging model to MLflow as model_fraud_20250709T132716]
[2025-07-09 13:27:44,540: INFO: model_training: Successfully registered model under unique name: XGBoost]
[2025-07-09 13:27:44,540: INFO: model_training: Performing detailed evaluation on test data]
[2025-07-09 13:27:44,712: INFO: common: json file saved at: artifacts\evaluation\metrics_20250709T132716.json]
[2025-07-09 13:27:44,713: INFO: model_training: Detailed metrics saved to: artifacts\evaluation\metrics_20250709T132716.json]
[2025-07-09 13:27:57,295: INFO: model_training: Creating confusion matrix plot]
[2025-07-09 13:27:57,606: INFO: model_training: Confusion matrix saved to: artifacts\evaluation\confusion_matrix_20250709T132716.png]
[2025-07-09 13:27:58,282: INFO: model_training: Creating Precision-Recall curve plot]
[2025-07-09 13:27:58,422: INFO: model_training: Precision-Recall curve saved to: artifacts\evaluation\precision_recall_curve_20250709T132716.png]
[2025-07-09 13:27:59,280: INFO: model_training: Creating ROC curve plot]
[2025-07-09 13:27:59,413: INFO: model_training: ROC curve saved to: artifacts\evaluation\roc_curve_20250709T132716.png]
[2025-07-09 13:28:00,274: INFO: train_evaluation: >>> Stage TRAIN_AND_EVALUATE_MODEL completed <<<]
[2025-07-09 13:28:00,274: INFO: main: Training and evaluation completed. Final model at: artifacts\model_version\model_churn_version_20250709T132716.pkl]
[2025-07-09 13:28:00,274: INFO: main: Logged Metrics: {'precision': 0.9964678374210238, 'recall': 0.9999500773800609, 'f1_score': 0.9982059204624738, 'roc_auc': 0.9999928674808555, 'mcc': 0.9964010044780308, 'avg_precision': 0.9999927418432609, 'classification_report': {'0': {'precision': 0.9999496043944968, 'recall': 0.9964344900316376, 'f1-score': 0.9981889526109267, 'support': 19913.0}, '1': {'precision': 0.9964678374210238, 'recall': 0.9999500773800609, 'f1-score': 0.9982059204624738, 'support': 20031.0}, 'accuracy': 0.9981974764670539, 'macro avg': {'precision': 0.9982087209077604, 'recall': 0.9981922837058492, 'f1-score': 0.9981974365367002, 'support': 39944.0}, 'weighted avg': {'precision': 0.9982035781015458, 'recall': 0.9981974764670539, 'f1-score': 0.998197461599369, 'support': 39944.0}}}]
[2025-07-09 13:28:00,275: INFO: main: ==================================================]
[2025-07-09 13:28:01,122: INFO: main: >>>>>> stage Model Training Pipeline completed <<<<<<

x====================x]
[2025-07-09 13:28:01,123: INFO: main: >>>>>> stage STAGE 4: Cloud Storage Push started <<<<<<]
[2025-07-09 13:28:01,123: INFO: main: ==================================================]
[2025-07-09 13:28:01,124: INFO: main: STAGE 4: Cloud Storage Push]
[2025-07-09 13:28:01,124: INFO: main: ==================================================]
[2025-07-09 13:28:01,124: INFO: cloud_storage_push: >>> Stage Cloud Storage Push started <<<]
[2025-07-09 13:28:01,128: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 13:28:01,128: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 13:28:01,129: INFO: common: created directory at: artifacts]
[2025-07-09 13:28:01,129: ERROR: main: "'ConfigBox' object has no attribute 'cloud_storage_push'"]
Traceback (most recent call last):
  File "box\\box.py", line 594, in box.box.Box.__getitem__
KeyError: 'cloud_storage_push'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box\\box.py", line 633, in box.box.Box.__getattr__
  File "box\\box.py", line 621, in box.box.Box.__getitem__
box.exceptions.BoxKeyError: "'cloud_storage_push'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box\\box.py", line 635, in box.box.Box.__getattr__
AttributeError: 'ConfigBox' object has no attribute 'cloud_storage_push'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box\\config_box.py", line 29, in box.config_box.ConfigBox.__getattr__
  File "box\\box.py", line 649, in box.box.Box.__getattr__
box.exceptions.BoxKeyError: "'ConfigBox' object has no attribute 'cloud_storage_push'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box\\box.py", line 594, in box.box.Box.__getitem__
KeyError: 'cloud_storage_push'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box\\box.py", line 633, in box.box.Box.__getattr__
  File "box\\box.py", line 621, in box.box.Box.__getitem__
box.exceptions.BoxKeyError: "'cloud_storage_push'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box\\box.py", line 635, in box.box.Box.__getattr__
AttributeError: 'ConfigBox' object has no attribute 'cloud_storage_push'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\main.py", line 73, in <module>
    cloud_push.main()
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\src\fraud_detection\pipelines\cloud_storage_push.py", line 14, in main
    cloud_storage_push_config = config.get_cloud_storage_push_config()
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\src\fraud_detection\config\configuration.py", line 114, in get_cloud_storage_push_config
    config = self.config.cloud_storage_push
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "box\\config_box.py", line 31, in box.config_box.ConfigBox.__getattr__
  File "box\\box.py", line 649, in box.box.Box.__getattr__
box.exceptions.BoxKeyError: "'ConfigBox' object has no attribute 'cloud_storage_push'"
[2025-07-09 13:30:45,774: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2025-07-09 13:30:45,774: INFO: preprocess_data: >>> Stage Data Ingestion stage started <<<]
[2025-07-09 13:30:45,778: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 13:30:45,780: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 13:30:45,780: INFO: common: created directory at: artifacts]
[2025-07-09 13:30:45,781: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-09 13:30:45,781: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 13:30:45,782: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-09 13:30:45,782: INFO: data_ingestion: Initiating data ingestion]
[2025-07-09 13:30:45,782: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-09 13:30:46,032: INFO: data_ingestion: Loaded dataset with 100000 rows]
[2025-07-09 13:30:46,033: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-09 13:30:46,033: INFO: data_ingestion: Starting preprocessing of 100000 rows...]
[2025-07-09 13:30:46,033: INFO: data_ingestion: Initial columns: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-09 13:30:46,087: INFO: data_ingestion: After feature engineering columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-09 13:30:46,088: INFO: data_ingestion: Data shape after feature engineering: (100000, 12)]
[2025-07-09 13:30:46,102: INFO: data_ingestion: First few rows of feature engineered data: 
   step      amount  oldbalanceOrg  ...  type_DEBIT  type_PAYMENT  type_TRANSFER
0   278   330218.42       20866.00  ...           0             0              0
1    15    11647.08       30370.00  ...           0             1              0
2    10   152264.21      106589.00  ...           0             0              0
3   403  1551760.63           0.00  ...           0             0              1
4   206    78172.30     2921331.58  ...           0             0              0

[5 rows x 12 columns]]
[2025-07-09 13:30:46,103: INFO: data_ingestion: After encoding columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-09 13:30:46,103: INFO: data_ingestion: Data shape after encoding: (100000, 12)]
[2025-07-09 13:30:46,116: INFO: data_ingestion: Data shape after removing NaN: (100000, 12)]
[2025-07-09 13:30:46,120: INFO: data_ingestion: X shape (features): (100000, 11)]
[2025-07-09 13:30:46,120: INFO: data_ingestion: y shape (target): (100000,)]
[2025-07-09 13:30:46,120: INFO: data_ingestion: Target variable shape: (100000,)]
[2025-07-09 13:30:46,121: INFO: data_ingestion: NaN count in target: 0]
[2025-07-09 13:30:46,123: INFO: data_ingestion: Target variable distribution: 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-09 13:30:46,125: INFO: data_ingestion: Final feature matrix shape: (100000, 11)]
[2025-07-09 13:30:46,125: INFO: data_ingestion: Final target vector shape: (100000,)]
[2025-07-09 13:30:46,127: INFO: data_ingestion: Target variable distribution (normalized): 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-09 13:30:46,128: INFO: data_ingestion: Target variable is imbalanced. Applying SMOTE...]
[2025-07-09 13:30:46,212: INFO: data_ingestion: Resampled feature matrix shape: (199718, 11)]
[2025-07-09 13:30:46,214: INFO: data_ingestion: Resampled target distribution: 
isFraud
0    99859
1    99859
Name: count, dtype: int64]
[2025-07-09 13:30:47,520: INFO: data_ingestion: Created versioned input data file: artifacts\data_version\input_raw_data_version_20250709T133045.csv]
[2025-07-09 13:30:47,521: INFO: data_ingestion: Created versioned processed data file: artifacts\data_version\processed_data_version_20250709T133045.csv]
[2025-07-09 13:30:47,521: INFO: data_ingestion: Splitting data into train and test sets]
[2025-07-09 13:30:47,562: INFO: data_ingestion: Train data: (159774, 11), Test data: (39944, 11)]
[2025-07-09 13:30:47,563: INFO: data_ingestion: Data ingestion completed successfully]
[2025-07-09 13:30:47,563: INFO: data_ingestion: Data shape - Train: (159774, 11), Test: (39944, 11)]
[2025-07-09 13:30:47,566: INFO: preprocess_data: >>> Stage Data Ingestion stage completed <<<]
[2025-07-09 13:30:47,570: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x====================x]
[2025-07-09 13:30:47,571: INFO: main: >>>>>> stage Model Training Pipeline started <<<<<<]
[2025-07-09 13:30:47,574: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 13:30:47,575: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 13:30:47,576: INFO: common: created directory at: artifacts]
[2025-07-09 13:30:47,576: INFO: configuration: MLFlow configuration: MLFlowConfig(dagshub_username='minh120103', dagshub_repo_name='E2E_ML', tracking_uri='https://dagshub.com/minh120103/E2E_ML.mlflow', experiment_name='Fraud_Detection_Experiment')]
[2025-07-09 13:30:47,957: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/user "HTTP/1.1 200 OK"]
[2025-07-09 13:30:47,963: INFO: helpers: Accessing as minh120103]
[2025-07-09 13:30:48,337: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/repos/minh120103/E2E_ML "HTTP/1.1 200 OK"]
[2025-07-09 13:30:48,686: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/user "HTTP/1.1 200 OK"]
[2025-07-09 13:30:48,690: INFO: helpers: Initialized MLflow to track repo "minh120103/E2E_ML"]
[2025-07-09 13:30:48,691: INFO: helpers: Repository minh120103/E2E_ML initialized!]
[2025-07-09 13:30:49,736: INFO: main: ==================================================]
[2025-07-09 13:30:49,737: INFO: main: Running Model Preparation]
[2025-07-09 13:30:49,737: INFO: prepare_model: >>> Stage Prepare base model started <<<]
[2025-07-09 13:30:49,740: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 13:30:49,741: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 13:30:49,742: INFO: common: created directory at: artifacts]
[2025-07-09 13:30:49,743: INFO: common: created directory at: artifacts/model_version]
[2025-07-09 13:30:49,743: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 13:30:49,744: INFO: configuration: Prepare base model config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'objective': 'binary:logistic', 'max_depth': 6, 'n_estimators': 300, 'random_state': 42, 'learning_rate': 0.1, 'scale_pos_weight': 10, 'n_jobs': -1}]
[2025-07-09 13:30:50,298: INFO: base_model: Creating base model and scaler]
[2025-07-09 13:30:50,298: INFO: base_model: Creating base XGBoost model]
[2025-07-09 13:30:50,298: INFO: base_model: Model params:300, 42, 0.1, 6, 10, -1]
[2025-07-09 13:30:50,299: INFO: base_model: Creating scaler from training data]
[2025-07-09 13:30:50,402: INFO: base_model: Base model saved: artifacts\model_version\base_model_churn_20250709T133050.pkl]
[2025-07-09 13:30:51,904: INFO: prepare_model: >>> Stage Prepare base model completed <<<]
[2025-07-09 13:30:51,905: INFO: main: Base model created at: artifacts\model_version\base_model_churn_20250709T133050.pkl]
[2025-07-09 13:30:51,905: INFO: main: Scaler created at: artifacts\model_version\scaler_churn_version_20250709T133050.pkl]
[2025-07-09 13:30:51,905: INFO: main: ==================================================]
[2025-07-09 13:30:51,905: INFO: main: ==================================================]
[2025-07-09 13:30:51,906: INFO: main: Running Model Training and Evaluation]
[2025-07-09 13:30:51,906: INFO: train_evaluation: >>> Stage TRAIN_AND_EVALUATE_MODEL started <<<]
[2025-07-09 13:30:51,909: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 13:30:51,910: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 13:30:51,911: INFO: common: created directory at: artifacts]
[2025-07-09 13:30:51,911: INFO: common: created directory at: artifacts/model_version]
[2025-07-09 13:30:51,912: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 13:30:51,912: INFO: configuration: Training config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version'}]
[2025-07-09 13:30:51,916: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 13:30:51,916: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 13:30:51,917: INFO: common: created directory at: artifacts]
[2025-07-09 13:30:51,918: INFO: common: created directory at: artifacts/evaluation]
[2025-07-09 13:30:51,918: INFO: common: created directory at: artifacts/model_version]
[2025-07-09 13:30:51,919: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 13:30:51,919: INFO: configuration: Evaluation config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'evaluation_dir': 'artifacts/evaluation'}]
[2025-07-09 13:30:51,919: INFO: model_training: Initiating model training and evaluation with temporary directory management]
[2025-07-09 13:30:51,920: INFO: model_training: Loaded y_train shape: (159774,)]
[2025-07-09 13:30:51,920: INFO: model_training: Loaded y_test shape: (39944,)]
[2025-07-09 13:30:51,921: INFO: model_training: NaN count in y_train: 0]
[2025-07-09 13:30:51,921: INFO: model_training: NaN count in y_test: 0]
[2025-07-09 13:30:51,922: INFO: model_training: Final X_train_scaled shape: (159774, 11)]
[2025-07-09 13:30:51,922: INFO: model_training: Final y_train shape: (159774,)]
[2025-07-09 13:30:51,922: INFO: model_training: Final X_test_scaled shape: (39944, 11)]
[2025-07-09 13:30:51,923: INFO: model_training: Final y_test shape: (39944,)]
[2025-07-09 13:30:51,926: INFO: model_training: Loading model: XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              feature_weights=None, gamma=None, grow_policy=None,
              importance_type=None, interaction_constraints=None,
              learning_rate=0.1, max_bin=None, max_cat_threshold=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=6,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, multi_strategy=None, n_estimators=300,
              n_jobs=-1, num_parallel_tree=None, ...)]
[2025-07-09 13:30:51,927: INFO: model_training: Starting model training for model_fraud_20250709T133051]
[2025-07-09 13:30:53,345: INFO: model_training: Model training for model_fraud_20250709T133051 completed]
[2025-07-09 13:30:53,359: INFO: model_training:   trained model file (for future use): artifacts\model_version\model_churn_version_20250709T133051.pkl]
[2025-07-09 13:30:53,754: INFO: model_training: Model accuracy on test data: 0.9981974764670539]
[2025-07-09 13:30:53,755: INFO: model_training: Model accuracy is 85% or above, not needed finetuned, log trained model to mlflow]
[2025-07-09 13:30:53,755: INFO: model_training: Logging model to MLflow as model_fraud_20250709T133051]
[2025-07-09 13:31:10,057: INFO: model_training: Successfully registered model under unique name: XGBoost]
[2025-07-09 13:31:10,057: INFO: model_training: Performing detailed evaluation on test data]
[2025-07-09 13:31:10,204: INFO: common: json file saved at: artifacts\evaluation\metrics_20250709T133051.json]
[2025-07-09 13:31:10,204: INFO: model_training: Detailed metrics saved to: artifacts\evaluation\metrics_20250709T133051.json]
[2025-07-09 13:31:22,749: INFO: model_training: Creating confusion matrix plot]
[2025-07-09 13:31:22,870: INFO: model_training: Confusion matrix saved to: artifacts\evaluation\confusion_matrix_20250709T133051.png]
[2025-07-09 13:31:23,728: INFO: model_training: Creating Precision-Recall curve plot]
[2025-07-09 13:31:23,869: INFO: model_training: Precision-Recall curve saved to: artifacts\evaluation\precision_recall_curve_20250709T133051.png]
[2025-07-09 13:31:24,884: INFO: model_training: Creating ROC curve plot]
[2025-07-09 13:31:25,033: INFO: model_training: ROC curve saved to: artifacts\evaluation\roc_curve_20250709T133051.png]
[2025-07-09 13:31:25,854: INFO: train_evaluation: >>> Stage TRAIN_AND_EVALUATE_MODEL completed <<<]
[2025-07-09 13:31:25,855: INFO: main: Training and evaluation completed. Final model at: artifacts\model_version\model_churn_version_20250709T133051.pkl]
[2025-07-09 13:31:25,855: INFO: main: Logged Metrics: {'precision': 0.9964678374210238, 'recall': 0.9999500773800609, 'f1_score': 0.9982059204624738, 'roc_auc': 0.9999928674808555, 'mcc': 0.9964010044780308, 'avg_precision': 0.9999927418432609, 'classification_report': {'0': {'precision': 0.9999496043944968, 'recall': 0.9964344900316376, 'f1-score': 0.9981889526109267, 'support': 19913.0}, '1': {'precision': 0.9964678374210238, 'recall': 0.9999500773800609, 'f1-score': 0.9982059204624738, 'support': 20031.0}, 'accuracy': 0.9981974764670539, 'macro avg': {'precision': 0.9982087209077604, 'recall': 0.9981922837058492, 'f1-score': 0.9981974365367002, 'support': 39944.0}, 'weighted avg': {'precision': 0.9982035781015458, 'recall': 0.9981974764670539, 'f1-score': 0.998197461599369, 'support': 39944.0}}}]
[2025-07-09 13:31:25,856: INFO: main: ==================================================]
[2025-07-09 13:31:26,598: INFO: main: >>>>>> stage Model Training Pipeline completed <<<<<<

x====================x]
[2025-07-09 13:31:26,598: INFO: main: >>>>>> stage STAGE 4: Cloud Storage Push started <<<<<<]
[2025-07-09 13:31:26,599: INFO: main: ==================================================]
[2025-07-09 13:31:26,599: INFO: main: STAGE 4: Cloud Storage Push]
[2025-07-09 13:31:26,599: INFO: main: ==================================================]
[2025-07-09 13:31:26,599: INFO: cloud_storage_push: >>> Stage Cloud Storage Push started <<<]
[2025-07-09 13:31:26,604: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 13:31:26,605: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 13:31:26,606: INFO: common: created directory at: artifacts]
[2025-07-09 13:31:26,607: ERROR: main: "'ConfigBox' object has no attribute 'cloud_storage_push'"]
Traceback (most recent call last):
  File "box\\box.py", line 594, in box.box.Box.__getitem__
KeyError: 'cloud_storage_push'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box\\box.py", line 633, in box.box.Box.__getattr__
  File "box\\box.py", line 621, in box.box.Box.__getitem__
box.exceptions.BoxKeyError: "'cloud_storage_push'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box\\box.py", line 635, in box.box.Box.__getattr__
AttributeError: 'ConfigBox' object has no attribute 'cloud_storage_push'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box\\config_box.py", line 29, in box.config_box.ConfigBox.__getattr__
  File "box\\box.py", line 649, in box.box.Box.__getattr__
box.exceptions.BoxKeyError: "'ConfigBox' object has no attribute 'cloud_storage_push'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box\\box.py", line 594, in box.box.Box.__getitem__
KeyError: 'cloud_storage_push'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "box\\box.py", line 633, in box.box.Box.__getattr__
  File "box\\box.py", line 621, in box.box.Box.__getitem__
box.exceptions.BoxKeyError: "'cloud_storage_push'"

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "box\\box.py", line 635, in box.box.Box.__getattr__
AttributeError: 'ConfigBox' object has no attribute 'cloud_storage_push'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\main.py", line 73, in <module>
    cloud_push.main()
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\src\fraud_detection\pipelines\cloud_storage_push.py", line 14, in main
    cloud_storage_push_config = config.get_cloud_storage_push_config()
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\src\fraud_detection\config\configuration.py", line 114, in get_cloud_storage_push_config
    config = self.config.cloud_storage_push
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "box\\config_box.py", line 31, in box.config_box.ConfigBox.__getattr__
  File "box\\box.py", line 649, in box.box.Box.__getattr__
box.exceptions.BoxKeyError: "'ConfigBox' object has no attribute 'cloud_storage_push'"
[2025-07-09 13:33:49,584: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2025-07-09 13:33:49,584: INFO: preprocess_data: >>> Stage Data Ingestion stage started <<<]
[2025-07-09 13:33:49,589: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 13:33:49,590: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 13:33:49,591: INFO: common: created directory at: artifacts]
[2025-07-09 13:33:49,591: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-09 13:33:49,592: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 13:33:49,592: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-09 13:33:49,592: INFO: data_ingestion: Initiating data ingestion]
[2025-07-09 13:33:49,592: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-09 13:33:49,801: INFO: data_ingestion: Loaded dataset with 100000 rows]
[2025-07-09 13:33:49,801: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-09 13:33:49,802: INFO: data_ingestion: Starting preprocessing of 100000 rows...]
[2025-07-09 13:33:49,802: INFO: data_ingestion: Initial columns: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-09 13:33:49,848: INFO: data_ingestion: After feature engineering columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-09 13:33:49,848: INFO: data_ingestion: Data shape after feature engineering: (100000, 12)]
[2025-07-09 13:33:49,863: INFO: data_ingestion: First few rows of feature engineered data: 
   step      amount  oldbalanceOrg  ...  type_DEBIT  type_PAYMENT  type_TRANSFER
0   278   330218.42       20866.00  ...           0             0              0
1    15    11647.08       30370.00  ...           0             1              0
2    10   152264.21      106589.00  ...           0             0              0
3   403  1551760.63           0.00  ...           0             0              1
4   206    78172.30     2921331.58  ...           0             0              0

[5 rows x 12 columns]]
[2025-07-09 13:33:49,863: INFO: data_ingestion: After encoding columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-09 13:33:49,864: INFO: data_ingestion: Data shape after encoding: (100000, 12)]
[2025-07-09 13:33:49,873: INFO: data_ingestion: Data shape after removing NaN: (100000, 12)]
[2025-07-09 13:33:49,876: INFO: data_ingestion: X shape (features): (100000, 11)]
[2025-07-09 13:33:49,877: INFO: data_ingestion: y shape (target): (100000,)]
[2025-07-09 13:33:49,877: INFO: data_ingestion: Target variable shape: (100000,)]
[2025-07-09 13:33:49,878: INFO: data_ingestion: NaN count in target: 0]
[2025-07-09 13:33:49,880: INFO: data_ingestion: Target variable distribution: 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-09 13:33:49,882: INFO: data_ingestion: Final feature matrix shape: (100000, 11)]
[2025-07-09 13:33:49,882: INFO: data_ingestion: Final target vector shape: (100000,)]
[2025-07-09 13:33:49,883: INFO: data_ingestion: Target variable distribution (normalized): 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-09 13:33:49,884: INFO: data_ingestion: Target variable is imbalanced. Applying SMOTE...]
[2025-07-09 13:33:49,953: INFO: data_ingestion: Resampled feature matrix shape: (199718, 11)]
[2025-07-09 13:33:49,956: INFO: data_ingestion: Resampled target distribution: 
isFraud
0    99859
1    99859
Name: count, dtype: int64]
[2025-07-09 13:33:51,248: INFO: data_ingestion: Created versioned input data file: artifacts\data_version\input_raw_data_version_20250709T133349.csv]
[2025-07-09 13:33:51,248: INFO: data_ingestion: Created versioned processed data file: artifacts\data_version\processed_data_version_20250709T133349.csv]
[2025-07-09 13:33:51,249: INFO: data_ingestion: Splitting data into train and test sets]
[2025-07-09 13:33:51,298: INFO: data_ingestion: Train data: (159774, 11), Test data: (39944, 11)]
[2025-07-09 13:33:51,298: INFO: data_ingestion: Data ingestion completed successfully]
[2025-07-09 13:33:51,299: INFO: data_ingestion: Data shape - Train: (159774, 11), Test: (39944, 11)]
[2025-07-09 13:33:51,301: INFO: preprocess_data: >>> Stage Data Ingestion stage completed <<<]
[2025-07-09 13:33:51,305: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x====================x]
[2025-07-09 13:33:51,305: INFO: main: >>>>>> stage Model Training Pipeline started <<<<<<]
[2025-07-09 13:33:51,311: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 13:33:51,312: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 13:33:51,313: INFO: common: created directory at: artifacts]
[2025-07-09 13:33:51,313: INFO: configuration: MLFlow configuration: MLFlowConfig(dagshub_username='minh120103', dagshub_repo_name='E2E_ML', tracking_uri='https://dagshub.com/minh120103/E2E_ML.mlflow', experiment_name='Fraud_Detection_Experiment')]
[2025-07-09 13:33:51,672: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/user "HTTP/1.1 200 OK"]
[2025-07-09 13:33:51,679: INFO: helpers: Accessing as minh120103]
[2025-07-09 13:33:52,056: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/repos/minh120103/E2E_ML "HTTP/1.1 200 OK"]
[2025-07-09 13:33:52,421: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/user "HTTP/1.1 200 OK"]
[2025-07-09 13:33:52,424: INFO: helpers: Initialized MLflow to track repo "minh120103/E2E_ML"]
[2025-07-09 13:33:52,425: INFO: helpers: Repository minh120103/E2E_ML initialized!]
[2025-07-09 13:33:53,529: INFO: main: ==================================================]
[2025-07-09 13:33:53,529: INFO: main: Running Model Preparation]
[2025-07-09 13:33:53,529: INFO: prepare_model: >>> Stage Prepare base model started <<<]
[2025-07-09 13:33:53,533: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 13:33:53,535: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 13:33:53,535: INFO: common: created directory at: artifacts]
[2025-07-09 13:33:53,536: INFO: common: created directory at: artifacts/model_version]
[2025-07-09 13:33:53,536: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 13:33:53,537: INFO: configuration: Prepare base model config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'objective': 'binary:logistic', 'max_depth': 6, 'n_estimators': 300, 'random_state': 42, 'learning_rate': 0.1, 'scale_pos_weight': 10, 'n_jobs': -1}]
[2025-07-09 13:33:53,862: INFO: base_model: Creating base model and scaler]
[2025-07-09 13:33:53,862: INFO: base_model: Creating base XGBoost model]
[2025-07-09 13:33:53,863: INFO: base_model: Model params:300, 42, 0.1, 6, 10, -1]
[2025-07-09 13:33:53,863: INFO: base_model: Creating scaler from training data]
[2025-07-09 13:33:53,951: INFO: base_model: Base model saved: artifacts\model_version\base_model_churn_20250709T133353.pkl]
[2025-07-09 13:33:55,304: INFO: prepare_model: >>> Stage Prepare base model completed <<<]
[2025-07-09 13:33:55,305: INFO: main: Base model created at: artifacts\model_version\base_model_churn_20250709T133353.pkl]
[2025-07-09 13:33:55,305: INFO: main: Scaler created at: artifacts\model_version\scaler_churn_version_20250709T133353.pkl]
[2025-07-09 13:33:55,305: INFO: main: ==================================================]
[2025-07-09 13:33:55,306: INFO: main: ==================================================]
[2025-07-09 13:33:55,306: INFO: main: Running Model Training and Evaluation]
[2025-07-09 13:33:55,306: INFO: train_evaluation: >>> Stage TRAIN_AND_EVALUATE_MODEL started <<<]
[2025-07-09 13:33:55,310: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 13:33:55,311: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 13:33:55,312: INFO: common: created directory at: artifacts]
[2025-07-09 13:33:55,312: INFO: common: created directory at: artifacts/model_version]
[2025-07-09 13:33:55,313: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 13:33:55,313: INFO: configuration: Training config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version'}]
[2025-07-09 13:33:55,317: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 13:33:55,318: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 13:33:55,319: INFO: common: created directory at: artifacts]
[2025-07-09 13:33:55,320: INFO: common: created directory at: artifacts/evaluation]
[2025-07-09 13:33:55,320: INFO: common: created directory at: artifacts/model_version]
[2025-07-09 13:33:55,320: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 13:33:55,321: INFO: configuration: Evaluation config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'evaluation_dir': 'artifacts/evaluation'}]
[2025-07-09 13:33:55,321: INFO: model_training: Initiating model training and evaluation with temporary directory management]
[2025-07-09 13:33:55,321: INFO: model_training: Loaded y_train shape: (159774,)]
[2025-07-09 13:33:55,321: INFO: model_training: Loaded y_test shape: (39944,)]
[2025-07-09 13:33:55,322: INFO: model_training: NaN count in y_train: 0]
[2025-07-09 13:33:55,323: INFO: model_training: NaN count in y_test: 0]
[2025-07-09 13:33:55,323: INFO: model_training: Final X_train_scaled shape: (159774, 11)]
[2025-07-09 13:33:55,324: INFO: model_training: Final y_train shape: (159774,)]
[2025-07-09 13:33:55,324: INFO: model_training: Final X_test_scaled shape: (39944, 11)]
[2025-07-09 13:33:55,324: INFO: model_training: Final y_test shape: (39944,)]
[2025-07-09 13:33:55,327: INFO: model_training: Loading model: XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              feature_weights=None, gamma=None, grow_policy=None,
              importance_type=None, interaction_constraints=None,
              learning_rate=0.1, max_bin=None, max_cat_threshold=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=6,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, multi_strategy=None, n_estimators=300,
              n_jobs=-1, num_parallel_tree=None, ...)]
[2025-07-09 13:33:55,327: INFO: model_training: Starting model training for model_fraud_20250709T133355]
[2025-07-09 13:33:56,773: INFO: model_training: Model training for model_fraud_20250709T133355 completed]
[2025-07-09 13:33:56,788: INFO: model_training:   trained model file (for future use): artifacts\model_version\model_churn_version_20250709T133355.pkl]
[2025-07-09 13:33:57,185: INFO: model_training: Model accuracy on test data: 0.9981974764670539]
[2025-07-09 13:33:57,185: INFO: model_training: Model accuracy is 85% or above, not needed finetuned, log trained model to mlflow]
[2025-07-09 13:33:57,185: INFO: model_training: Logging model to MLflow as model_fraud_20250709T133355]
[2025-07-09 13:34:13,279: INFO: model_training: Successfully registered model under unique name: XGBoost]
[2025-07-09 13:34:13,279: INFO: model_training: Performing detailed evaluation on test data]
[2025-07-09 13:34:13,419: INFO: common: json file saved at: artifacts\evaluation\metrics_20250709T133355.json]
[2025-07-09 13:34:13,419: INFO: model_training: Detailed metrics saved to: artifacts\evaluation\metrics_20250709T133355.json]
[2025-07-09 13:34:26,032: INFO: model_training: Creating confusion matrix plot]
[2025-07-09 13:34:26,140: INFO: model_training: Confusion matrix saved to: artifacts\evaluation\confusion_matrix_20250709T133355.png]
[2025-07-09 13:34:26,980: INFO: model_training: Creating Precision-Recall curve plot]
[2025-07-09 13:34:27,118: INFO: model_training: Precision-Recall curve saved to: artifacts\evaluation\precision_recall_curve_20250709T133355.png]
[2025-07-09 13:34:28,044: INFO: model_training: Creating ROC curve plot]
[2025-07-09 13:34:28,174: INFO: model_training: ROC curve saved to: artifacts\evaluation\roc_curve_20250709T133355.png]
[2025-07-09 13:34:28,969: INFO: train_evaluation: >>> Stage TRAIN_AND_EVALUATE_MODEL completed <<<]
[2025-07-09 13:34:28,970: INFO: main: Training and evaluation completed. Final model at: artifacts\model_version\model_churn_version_20250709T133355.pkl]
[2025-07-09 13:34:28,970: INFO: main: Logged Metrics: {'precision': 0.9964678374210238, 'recall': 0.9999500773800609, 'f1_score': 0.9982059204624738, 'roc_auc': 0.9999928674808555, 'mcc': 0.9964010044780308, 'avg_precision': 0.9999927418432609, 'classification_report': {'0': {'precision': 0.9999496043944968, 'recall': 0.9964344900316376, 'f1-score': 0.9981889526109267, 'support': 19913.0}, '1': {'precision': 0.9964678374210238, 'recall': 0.9999500773800609, 'f1-score': 0.9982059204624738, 'support': 20031.0}, 'accuracy': 0.9981974764670539, 'macro avg': {'precision': 0.9982087209077604, 'recall': 0.9981922837058492, 'f1-score': 0.9981974365367002, 'support': 39944.0}, 'weighted avg': {'precision': 0.9982035781015458, 'recall': 0.9981974764670539, 'f1-score': 0.998197461599369, 'support': 39944.0}}}]
[2025-07-09 13:34:28,971: INFO: main: ==================================================]
[2025-07-09 13:34:29,813: INFO: main: >>>>>> stage Model Training Pipeline completed <<<<<<

x====================x]
[2025-07-09 13:34:29,813: INFO: main: >>>>>> stage STAGE 4: Cloud Storage Push started <<<<<<]
[2025-07-09 13:34:29,814: INFO: main: ==================================================]
[2025-07-09 13:34:29,814: INFO: main: STAGE 4: Cloud Storage Push]
[2025-07-09 13:34:29,814: INFO: main: ==================================================]
[2025-07-09 13:34:29,814: INFO: cloud_storage_push: >>> Stage Cloud Storage Push started <<<]
[2025-07-09 13:34:29,819: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 13:34:29,820: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 13:34:29,820: INFO: common: created directory at: artifacts]
[2025-07-09 13:34:29,825: INFO: configuration: Cloud Storage Push config: {'root_dir': 'artifacts', 'bucket_name': 'databucket231', 'data_version_dir': 'artifacts/data_version', 'evaluation_dir': 'artifacts/evaluation'}]
[2025-07-09 13:34:29,857: INFO: credentials: Found credentials in shared credentials file: ~/.aws/credentials]
[2025-07-09 13:34:30,348: INFO: cloud_storage_push: Ensured directory structure exists for cloud storage push]
[2025-07-09 13:34:30,348: INFO: cloud_storage_push: Starting cloud storage push process...]
[2025-07-09 13:34:31,039: INFO: cloud_storage_push: Bucket 'databucket231' exists and is accessible]
[2025-07-09 13:34:31,041: INFO: cloud_storage_push: Found 6 files to upload to cloud storage.]
[2025-07-09 13:34:31,875: INFO: cloud_storage_push: Uploaded artifacts\evaluation\metrics_20250709T133355.json to bucket databucket231.]
[2025-07-09 13:34:32,366: INFO: cloud_storage_push: Uploaded artifacts\evaluation\precision_recall_curve_20250709T133355.png to bucket databucket231.]
[2025-07-09 13:34:32,773: INFO: cloud_storage_push: Uploaded artifacts\evaluation\roc_curve_20250709T133355.png to bucket databucket231.]
[2025-07-09 13:34:32,835: INFO: cloud_storage_push: Uploaded artifacts\evaluation\confusion_matrix_20250709T133355.png to bucket databucket231.]
[2025-07-09 13:34:43,398: INFO: cloud_storage_push: Uploaded artifacts\data_version\processed_data_version_20250709T133349.csv to bucket databucket231.]
[2025-07-09 13:34:46,714: INFO: cloud_storage_push: Uploaded artifacts\data_version\input_raw_data_version_20250709T133349.csv to bucket databucket231.]
[2025-07-09 13:34:46,715: INFO: cloud_storage_push: Successfully uploaded 6 files to S3 bucket: databucket231]
[2025-07-09 13:34:46,715: INFO: cloud_storage_push: >>> Stage Cloud Storage Push completed <<<]
[2025-07-09 13:34:46,715: INFO: main: Cloud storage push completed successfully]
[2025-07-09 13:34:46,716: INFO: main: >>>>>> stage STAGE 4: Cloud Storage Push completed <<<<<<

x====================x]
[2025-07-09 13:48:31,872: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2025-07-09 13:48:31,873: INFO: preprocess_data: >>> Stage Data Ingestion stage started <<<]
[2025-07-09 13:48:31,878: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 13:48:31,879: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 13:48:31,880: INFO: common: created directory at: artifacts]
[2025-07-09 13:48:31,880: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-09 13:48:31,881: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 13:48:31,881: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-09 13:48:31,882: INFO: data_ingestion: Initiating data ingestion]
[2025-07-09 13:48:31,882: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-09 13:48:32,072: INFO: data_ingestion: Loaded dataset with 100000 rows]
[2025-07-09 13:48:32,073: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-09 13:48:32,073: INFO: data_ingestion: Starting preprocessing of 100000 rows...]
[2025-07-09 13:48:32,074: INFO: data_ingestion: Initial columns: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-09 13:48:32,120: INFO: data_ingestion: After feature engineering columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-09 13:48:32,121: INFO: data_ingestion: Data shape after feature engineering: (100000, 12)]
[2025-07-09 13:48:32,135: INFO: data_ingestion: First few rows of feature engineered data: 
   step      amount  oldbalanceOrg  ...  type_DEBIT  type_PAYMENT  type_TRANSFER
0   278   330218.42       20866.00  ...           0             0              0
1    15    11647.08       30370.00  ...           0             1              0
2    10   152264.21      106589.00  ...           0             0              0
3   403  1551760.63           0.00  ...           0             0              1
4   206    78172.30     2921331.58  ...           0             0              0

[5 rows x 12 columns]]
[2025-07-09 13:48:32,136: INFO: data_ingestion: After encoding columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-09 13:48:32,136: INFO: data_ingestion: Data shape after encoding: (100000, 12)]
[2025-07-09 13:48:32,146: INFO: data_ingestion: Data shape after removing NaN: (100000, 12)]
[2025-07-09 13:48:32,150: INFO: data_ingestion: X shape (features): (100000, 11)]
[2025-07-09 13:48:32,150: INFO: data_ingestion: y shape (target): (100000,)]
[2025-07-09 13:48:32,150: INFO: data_ingestion: Target variable shape: (100000,)]
[2025-07-09 13:48:32,151: INFO: data_ingestion: NaN count in target: 0]
[2025-07-09 13:48:32,153: INFO: data_ingestion: Target variable distribution: 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-09 13:48:32,155: INFO: data_ingestion: Final feature matrix shape: (100000, 11)]
[2025-07-09 13:48:32,155: INFO: data_ingestion: Final target vector shape: (100000,)]
[2025-07-09 13:48:32,157: INFO: data_ingestion: Target variable distribution (normalized): 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-09 13:48:32,158: INFO: data_ingestion: Target variable is imbalanced. Applying SMOTE...]
[2025-07-09 13:48:32,243: INFO: data_ingestion: Resampled feature matrix shape: (199718, 11)]
[2025-07-09 13:48:32,245: INFO: data_ingestion: Resampled target distribution: 
isFraud
0    99859
1    99859
Name: count, dtype: int64]
[2025-07-09 13:48:33,619: INFO: data_ingestion: Created versioned input data file: artifacts\data_version\input_raw_data_version_20250709T134831.csv]
[2025-07-09 13:48:33,620: INFO: data_ingestion: Created versioned processed data file: artifacts\data_version\processed_data_version_20250709T134831.csv]
[2025-07-09 13:48:33,620: INFO: data_ingestion: Splitting data into train and test sets]
[2025-07-09 13:48:33,670: INFO: data_ingestion: Train data: (159774, 11), Test data: (39944, 11)]
[2025-07-09 13:48:33,671: INFO: data_ingestion: Data ingestion completed successfully]
[2025-07-09 13:48:33,671: INFO: data_ingestion: Data shape - Train: (159774, 11), Test: (39944, 11)]
[2025-07-09 13:48:33,674: INFO: preprocess_data: >>> Stage Data Ingestion stage completed <<<]
[2025-07-09 13:48:33,677: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x====================x]
[2025-07-09 13:48:33,678: INFO: main: >>>>>> stage Model Training Pipeline started <<<<<<]
[2025-07-09 13:48:33,682: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 13:48:33,683: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 13:48:33,684: INFO: common: created directory at: artifacts]
[2025-07-09 13:48:33,684: INFO: configuration: MLFlow configuration: MLFlowConfig(dagshub_username='minh120103', dagshub_repo_name='E2E_ML', tracking_uri='https://dagshub.com/minh120103/E2E_ML.mlflow', experiment_name='Fraud_Detection_Experiment')]
[2025-07-09 13:48:34,059: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/user "HTTP/1.1 200 OK"]
[2025-07-09 13:48:34,066: INFO: helpers: Accessing as minh120103]
[2025-07-09 13:48:34,444: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/repos/minh120103/E2E_ML "HTTP/1.1 200 OK"]
[2025-07-09 13:48:34,786: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/user "HTTP/1.1 200 OK"]
[2025-07-09 13:48:34,788: INFO: helpers: Initialized MLflow to track repo "minh120103/E2E_ML"]
[2025-07-09 13:48:34,790: INFO: helpers: Repository minh120103/E2E_ML initialized!]
[2025-07-09 13:48:38,864: INFO: main: ==================================================]
[2025-07-09 13:48:38,864: INFO: main: Running Model Preparation]
[2025-07-09 13:48:38,865: INFO: prepare_model: >>> Stage Prepare base model started <<<]
[2025-07-09 13:48:38,871: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 13:48:38,873: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 13:48:38,874: INFO: common: created directory at: artifacts]
[2025-07-09 13:48:38,875: INFO: common: created directory at: artifacts/model_version]
[2025-07-09 13:48:38,875: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 13:48:38,876: INFO: configuration: Prepare base model config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'objective': 'binary:logistic', 'max_depth': 6, 'n_estimators': 300, 'random_state': 42, 'learning_rate': 0.1, 'scale_pos_weight': 10, 'n_jobs': -1}]
[2025-07-09 13:48:39,204: INFO: base_model: Creating base model and scaler]
[2025-07-09 13:48:39,204: INFO: base_model: Creating base XGBoost model]
[2025-07-09 13:48:39,204: INFO: base_model: Model params:300, 42, 0.1, 6, 10, -1]
[2025-07-09 13:48:39,205: INFO: base_model: Creating scaler from training data]
[2025-07-09 13:48:39,290: INFO: base_model: Base model saved: artifacts\model_version\base_model_churn_20250709T134839.pkl]
[2025-07-09 13:48:40,783: INFO: prepare_model: >>> Stage Prepare base model completed <<<]
[2025-07-09 13:48:40,784: INFO: main: Base model created at: artifacts\model_version\base_model_churn_20250709T134839.pkl]
[2025-07-09 13:48:40,784: INFO: main: Scaler created at: artifacts\model_version\scaler_churn_version_20250709T134839.pkl]
[2025-07-09 13:48:40,784: INFO: main: ==================================================]
[2025-07-09 13:48:40,785: INFO: main: ==================================================]
[2025-07-09 13:48:40,785: INFO: main: Running Model Training and Evaluation]
[2025-07-09 13:48:40,785: INFO: train_evaluation: >>> Stage TRAIN_AND_EVALUATE_MODEL started <<<]
[2025-07-09 13:48:40,789: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 13:48:40,790: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 13:48:40,791: INFO: common: created directory at: artifacts]
[2025-07-09 13:48:40,791: INFO: common: created directory at: artifacts/model_version]
[2025-07-09 13:48:40,792: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 13:48:40,792: INFO: configuration: Training config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version'}]
[2025-07-09 13:48:40,796: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 13:48:40,797: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 13:48:40,798: INFO: common: created directory at: artifacts]
[2025-07-09 13:48:40,799: INFO: common: created directory at: artifacts/evaluation]
[2025-07-09 13:48:40,799: INFO: common: created directory at: artifacts/model_version]
[2025-07-09 13:48:40,800: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 13:48:40,800: INFO: configuration: Evaluation config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'evaluation_dir': 'artifacts/evaluation'}]
[2025-07-09 13:48:40,800: INFO: model_training: Initiating model training and evaluation with temporary directory management]
[2025-07-09 13:48:40,800: INFO: model_training: Loaded y_train shape: (159774,)]
[2025-07-09 13:48:40,801: INFO: model_training: Loaded y_test shape: (39944,)]
[2025-07-09 13:48:40,801: INFO: model_training: NaN count in y_train: 0]
[2025-07-09 13:48:40,802: INFO: model_training: NaN count in y_test: 0]
[2025-07-09 13:48:40,802: INFO: model_training: Final X_train_scaled shape: (159774, 11)]
[2025-07-09 13:48:40,803: INFO: model_training: Final y_train shape: (159774,)]
[2025-07-09 13:48:40,803: INFO: model_training: Final X_test_scaled shape: (39944, 11)]
[2025-07-09 13:48:40,803: INFO: model_training: Final y_test shape: (39944,)]
[2025-07-09 13:48:40,806: INFO: model_training: Loading model: XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              feature_weights=None, gamma=None, grow_policy=None,
              importance_type=None, interaction_constraints=None,
              learning_rate=0.1, max_bin=None, max_cat_threshold=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=6,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, multi_strategy=None, n_estimators=300,
              n_jobs=-1, num_parallel_tree=None, ...)]
[2025-07-09 13:48:40,806: INFO: model_training: Starting model training for model_fraud_20250709T134840]
[2025-07-09 13:48:42,163: INFO: model_training: Model training for model_fraud_20250709T134840 completed]
[2025-07-09 13:48:42,176: INFO: model_training:   trained model file (for future use): artifacts\model_version\model_churn_version_20250709T134840.pkl]
[2025-07-09 13:48:44,313: INFO: model_training: Model accuracy on test data: 0.9981974764670539]
[2025-07-09 13:48:44,314: INFO: model_training: Model accuracy is 85% or above, not needed finetuned, log trained model to mlflow]
[2025-07-09 13:48:44,314: INFO: model_training: Logging model to MLflow as model_fraud_20250709T134840]
[2025-07-09 13:49:01,442: INFO: model_training: Successfully registered model under unique name: XGBoost]
[2025-07-09 13:49:01,443: INFO: model_training: Performing detailed evaluation on test data]
[2025-07-09 13:49:01,596: INFO: common: json file saved at: artifacts\evaluation\metrics_20250709T134840.json]
[2025-07-09 13:49:01,596: INFO: model_training: Detailed metrics saved to: artifacts\evaluation\metrics_20250709T134840.json]
[2025-07-09 13:49:13,585: INFO: model_training: Creating confusion matrix plot]
[2025-07-09 13:49:13,697: INFO: model_training: Confusion matrix saved to: artifacts\evaluation\confusion_matrix_20250709T134840.png]
[2025-07-09 13:49:14,446: INFO: model_training: Creating Precision-Recall curve plot]
[2025-07-09 13:49:14,582: INFO: model_training: Precision-Recall curve saved to: artifacts\evaluation\precision_recall_curve_20250709T134840.png]
[2025-07-09 13:49:15,423: INFO: model_training: Creating ROC curve plot]
[2025-07-09 13:49:15,562: INFO: model_training: ROC curve saved to: artifacts\evaluation\roc_curve_20250709T134840.png]
[2025-07-09 13:49:16,436: INFO: train_evaluation: >>> Stage TRAIN_AND_EVALUATE_MODEL completed <<<]
[2025-07-09 13:49:16,436: INFO: main: Training and evaluation completed. Final model at: artifacts\model_version\model_churn_version_20250709T134840.pkl]
[2025-07-09 13:49:16,437: INFO: main: Logged Metrics: {'precision': 0.9964678374210238, 'recall': 0.9999500773800609, 'f1_score': 0.9982059204624738, 'roc_auc': 0.9999928674808555, 'mcc': 0.9964010044780308, 'avg_precision': 0.9999927418432609, 'classification_report': {'0': {'precision': 0.9999496043944968, 'recall': 0.9964344900316376, 'f1-score': 0.9981889526109267, 'support': 19913.0}, '1': {'precision': 0.9964678374210238, 'recall': 0.9999500773800609, 'f1-score': 0.9982059204624738, 'support': 20031.0}, 'accuracy': 0.9981974764670539, 'macro avg': {'precision': 0.9982087209077604, 'recall': 0.9981922837058492, 'f1-score': 0.9981974365367002, 'support': 39944.0}, 'weighted avg': {'precision': 0.9982035781015458, 'recall': 0.9981974764670539, 'f1-score': 0.998197461599369, 'support': 39944.0}}}]
[2025-07-09 13:49:16,437: INFO: main: ==================================================]
[2025-07-09 13:49:17,296: INFO: main: >>>>>> stage Model Training Pipeline completed <<<<<<

x====================x]
[2025-07-09 13:49:17,297: INFO: main: >>>>>> stage STAGE 4: Cloud Storage Push started <<<<<<]
[2025-07-09 13:49:17,297: INFO: main: ==================================================]
[2025-07-09 13:49:17,297: INFO: main: STAGE 4: Cloud Storage Push]
[2025-07-09 13:49:17,298: INFO: main: ==================================================]
[2025-07-09 13:49:17,298: INFO: cloud_storage_push: >>> Stage Cloud Storage Push started <<<]
[2025-07-09 13:49:17,303: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 13:49:17,304: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 13:49:17,305: INFO: common: created directory at: artifacts]
[2025-07-09 13:49:17,307: INFO: configuration: Cloud Storage Push config: {'root_dir': 'artifacts', 'bucket_name': 'databucket231', 'data_version_dir': 'artifacts/data_version', 'evaluation_dir': 'artifacts/evaluation'}]
[2025-07-09 13:49:17,323: INFO: credentials: Found credentials in shared credentials file: ~/.aws/credentials]
[2025-07-09 13:49:17,607: INFO: cloud_storage_push: Ensured directory structure exists for cloud storage push]
[2025-07-09 13:49:17,608: INFO: cloud_storage_push: Starting cloud storage push process...]
[2025-07-09 13:49:18,291: INFO: cloud_storage_push: Bucket 'databucket231' exists and is accessible]
[2025-07-09 13:49:18,293: INFO: cloud_storage_push: Found 6 files to upload to cloud storage.]
[2025-07-09 13:49:18,989: INFO: cloud_storage_push: Uploaded artifacts\evaluation\metrics_20250709T134840.json to bucket databucket231.]
[2025-07-09 13:49:19,310: INFO: cloud_storage_push: Uploaded artifacts\evaluation\confusion_matrix_20250709T134840.png to bucket databucket231.]
[2025-07-09 13:49:19,612: INFO: cloud_storage_push: Uploaded artifacts\evaluation\precision_recall_curve_20250709T134840.png to bucket databucket231.]
[2025-07-09 13:49:20,054: INFO: cloud_storage_push: Uploaded artifacts\evaluation\roc_curve_20250709T134840.png to bucket databucket231.]
[2025-07-09 13:49:32,895: INFO: cloud_storage_push: Uploaded artifacts\data_version\input_raw_data_version_20250709T134831.csv to bucket databucket231.]
[2025-07-09 13:49:33,533: INFO: cloud_storage_push: Uploaded artifacts\data_version\processed_data_version_20250709T134831.csv to bucket databucket231.]
[2025-07-09 13:49:33,534: INFO: cloud_storage_push: Successfully uploaded 6 files to S3 bucket: databucket231]
[2025-07-09 13:49:33,534: INFO: cloud_storage_push: >>> Stage Cloud Storage Push completed <<<]
[2025-07-09 13:49:33,535: INFO: main: Cloud storage push completed successfully]
[2025-07-09 13:49:33,535: INFO: main: >>>>>> stage STAGE 4: Cloud Storage Push completed <<<<<<

x====================x]
[2025-07-09 13:49:33,535: INFO: clean_up_: ==================================================]
[2025-07-09 13:49:33,536: INFO: clean_up_: CLEANUP: Removing temporary versioned files]
[2025-07-09 13:49:33,536: INFO: clean_up_: ==================================================]
[2025-07-09 13:49:33,541: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 13:49:33,543: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 13:49:33,543: INFO: common: created directory at: artifacts]
[2025-07-09 13:49:33,544: INFO: clean_up_: Found 2 timestamp-versioned data files to clean]
[2025-07-09 13:49:33,545: INFO: clean_up_: Deleted temporary file: input_raw_data_version_20250709T134831.csv]
[2025-07-09 13:49:33,546: INFO: clean_up_: Deleted temporary file: processed_data_version_20250709T134831.csv]
[2025-07-09 13:49:33,548: INFO: clean_up_: Found 4 timestamp-versioned evaluation files to clean]
[2025-07-09 13:49:33,548: INFO: clean_up_: Deleted temporary file: metrics_20250709T134840.json]
[2025-07-09 13:49:33,549: INFO: clean_up_: Deleted temporary file: confusion_matrix_20250709T134840.png]
[2025-07-09 13:49:33,549: INFO: clean_up_: Deleted temporary file: precision_recall_curve_20250709T134840.png]
[2025-07-09 13:49:33,550: INFO: clean_up_: Deleted temporary file: roc_curve_20250709T134840.png]
[2025-07-09 13:49:33,551: INFO: clean_up_: Deleted temporary file: input_raw.csv]
[2025-07-09 13:49:33,552: INFO: clean_up_: Kept 0 essential data files for DVC tracking]
[2025-07-09 13:49:33,552: INFO: clean_up_: Kept 0 essential evaluation files for DVC tracking]
[2025-07-09 13:49:33,553: INFO: main: Temporary files cleaned up successfully]
[2025-07-09 15:22:03,510: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2025-07-09 15:22:03,511: INFO: preprocess_data: >>> Stage Data Ingestion stage started <<<]
[2025-07-09 15:22:03,516: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 15:22:03,518: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 15:22:03,519: INFO: common: created directory at: artifacts]
[2025-07-09 15:22:03,519: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-09 15:22:03,520: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 15:22:03,520: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-09 15:22:03,521: INFO: data_ingestion: Initiating data ingestion]
[2025-07-09 15:22:03,521: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-09 15:22:03,700: INFO: data_ingestion: Loaded dataset with 100000 rows]
[2025-07-09 15:22:03,700: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-09 15:22:03,700: INFO: data_ingestion: Starting preprocessing of 100000 rows...]
[2025-07-09 15:22:03,700: INFO: data_ingestion: Initial columns: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-09 15:22:03,747: INFO: data_ingestion: After feature engineering columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-09 15:22:03,747: INFO: data_ingestion: Data shape after feature engineering: (100000, 12)]
[2025-07-09 15:22:03,763: INFO: data_ingestion: First few rows of feature engineered data: 
   step      amount  oldbalanceOrg  ...  type_DEBIT  type_PAYMENT  type_TRANSFER
0   278   330218.42       20866.00  ...           0             0              0
1    15    11647.08       30370.00  ...           0             1              0
2    10   152264.21      106589.00  ...           0             0              0
3   403  1551760.63           0.00  ...           0             0              1
4   206    78172.30     2921331.58  ...           0             0              0

[5 rows x 12 columns]]
[2025-07-09 15:22:03,764: INFO: data_ingestion: After encoding columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-09 15:22:03,764: INFO: data_ingestion: Data shape after encoding: (100000, 12)]
[2025-07-09 15:22:03,771: INFO: data_ingestion: Data shape after removing NaN: (100000, 12)]
[2025-07-09 15:22:03,782: INFO: data_ingestion: X shape (features): (100000, 11)]
[2025-07-09 15:22:03,782: INFO: data_ingestion: y shape (target): (100000,)]
[2025-07-09 15:22:03,783: INFO: data_ingestion: Target variable shape: (100000,)]
[2025-07-09 15:22:03,783: INFO: data_ingestion: NaN count in target: 0]
[2025-07-09 15:22:03,786: INFO: data_ingestion: Target variable distribution: 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-09 15:22:03,788: INFO: data_ingestion: Final feature matrix shape: (100000, 11)]
[2025-07-09 15:22:03,788: INFO: data_ingestion: Final target vector shape: (100000,)]
[2025-07-09 15:22:03,790: INFO: data_ingestion: Target variable distribution (normalized): 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-09 15:22:03,790: INFO: data_ingestion: Target variable is imbalanced. Applying SMOTE...]
[2025-07-09 15:22:03,857: INFO: data_ingestion: Resampled feature matrix shape: (199718, 11)]
[2025-07-09 15:22:03,860: INFO: data_ingestion: Resampled target distribution: 
isFraud
0    99859
1    99859
Name: count, dtype: int64]
[2025-07-09 15:22:03,864: ERROR: main: too many values to unpack (expected 3)]
Traceback (most recent call last):
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\main.py", line 17, in <module>
    X_train, X_test, y_train, y_test = data_ingestion_pipeline.main()
                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\src\fraud_detection\pipelines\preprocess_data.py", line 15, in main
    X_train, X_test, y_train, y_test,_,_ = data_ingestion.data_ingestion_pipeline()
                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\minh1\Desktop\Study\SFIN\New folder\src\fraud_detection\components\data_ingestion.py", line 60, in data_ingestion_pipeline
    X, y, df_processed = self.preprocess_data(df)
    ^^^^^^^^^^^^^^^^^^
ValueError: too many values to unpack (expected 3)
[2025-07-09 15:26:46,774: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2025-07-09 15:26:46,774: INFO: preprocess_data: >>> Stage Data Ingestion stage started <<<]
[2025-07-09 15:26:46,778: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 15:26:46,779: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 15:26:46,780: INFO: common: created directory at: artifacts]
[2025-07-09 15:26:46,781: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-09 15:26:46,781: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 15:26:46,782: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-09 15:26:46,782: INFO: data_ingestion: Initiating data ingestion]
[2025-07-09 15:26:46,782: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-09 15:26:46,960: INFO: data_ingestion: Loaded dataset with 100000 rows]
[2025-07-09 15:26:46,960: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-09 15:26:46,961: INFO: data_ingestion: Starting preprocessing of 100000 rows...]
[2025-07-09 15:26:46,961: INFO: data_ingestion: Initial columns: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-09 15:26:47,000: INFO: data_ingestion: After feature engineering columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-09 15:26:47,002: INFO: data_ingestion: Data shape after feature engineering: (100000, 12)]
[2025-07-09 15:26:47,015: INFO: data_ingestion: First few rows of feature engineered data: 
   step      amount  oldbalanceOrg  ...  type_DEBIT  type_PAYMENT  type_TRANSFER
0   278   330218.42       20866.00  ...           0             0              0
1    15    11647.08       30370.00  ...           0             1              0
2    10   152264.21      106589.00  ...           0             0              0
3   403  1551760.63           0.00  ...           0             0              1
4   206    78172.30     2921331.58  ...           0             0              0

[5 rows x 12 columns]]
[2025-07-09 15:26:47,016: INFO: data_ingestion: After encoding columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-09 15:26:47,016: INFO: data_ingestion: Data shape after encoding: (100000, 12)]
[2025-07-09 15:26:47,023: INFO: data_ingestion: Data shape after removing NaN: (100000, 12)]
[2025-07-09 15:26:47,026: INFO: data_ingestion: X shape (features): (100000, 11)]
[2025-07-09 15:26:47,027: INFO: data_ingestion: y shape (target): (100000,)]
[2025-07-09 15:26:47,027: INFO: data_ingestion: Target variable shape: (100000,)]
[2025-07-09 15:26:47,027: INFO: data_ingestion: NaN count in target: 0]
[2025-07-09 15:26:47,029: INFO: data_ingestion: Target variable distribution: 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-09 15:26:47,031: INFO: data_ingestion: Final feature matrix shape: (100000, 11)]
[2025-07-09 15:26:47,031: INFO: data_ingestion: Final target vector shape: (100000,)]
[2025-07-09 15:26:47,033: INFO: data_ingestion: Target variable distribution (normalized): 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-09 15:26:47,034: INFO: data_ingestion: Target variable is imbalanced. Applying SMOTE...]
[2025-07-09 15:26:47,093: INFO: data_ingestion: Resampled feature matrix shape: (199718, 11)]
[2025-07-09 15:26:47,095: INFO: data_ingestion: Resampled target distribution: 
isFraud
0    99859
1    99859
Name: count, dtype: int64]
[2025-07-09 15:26:48,817: INFO: data_ingestion: Created versioned input data file: artifacts\data_version\input_raw_data_version_20250709T152646.csv]
[2025-07-09 15:26:48,817: INFO: data_ingestion: Created versioned processed data file: artifacts\data_version\processed_data_version_20250709T152646.csv]
[2025-07-09 15:26:48,818: INFO: data_ingestion: Created versioned feature engineered data file: artifacts\data_version\featured_data_version_20250709T152646.csv]
[2025-07-09 15:26:48,818: INFO: data_ingestion: Splitting data into train and test sets]
[2025-07-09 15:26:48,851: INFO: data_ingestion: Train data: (159774, 11), Test data: (39944, 11)]
[2025-07-09 15:26:48,851: INFO: data_ingestion: Data ingestion completed successfully]
[2025-07-09 15:26:48,852: INFO: data_ingestion: Data shape - Train: (159774, 11), Test: (39944, 11)]
[2025-07-09 15:26:48,855: INFO: preprocess_data: >>> Stage Data Ingestion stage completed <<<]
[2025-07-09 15:26:48,859: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x====================x]
[2025-07-09 15:26:48,860: INFO: main: >>>>>> stage Model Training Pipeline started <<<<<<]
[2025-07-09 15:26:48,864: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 15:26:48,865: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 15:26:48,866: INFO: common: created directory at: artifacts]
[2025-07-09 15:26:48,866: INFO: configuration: MLFlow configuration: MLFlowConfig(dagshub_username='minh120103', dagshub_repo_name='E2E_ML', tracking_uri='https://dagshub.com/minh120103/E2E_ML.mlflow', experiment_name='Fraud_Detection_Experiment')]
[2025-07-09 15:26:49,420: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/user "HTTP/1.1 200 OK"]
[2025-07-09 15:26:49,426: INFO: helpers: Accessing as minh120103]
[2025-07-09 15:26:49,815: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/repos/minh120103/E2E_ML "HTTP/1.1 200 OK"]
[2025-07-09 15:26:50,166: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/user "HTTP/1.1 200 OK"]
[2025-07-09 15:26:50,168: INFO: helpers: Initialized MLflow to track repo "minh120103/E2E_ML"]
[2025-07-09 15:26:50,169: INFO: helpers: Repository minh120103/E2E_ML initialized!]
[2025-07-09 15:26:51,218: INFO: main: ==================================================]
[2025-07-09 15:26:51,218: INFO: main: Running Model Preparation]
[2025-07-09 15:26:51,218: INFO: prepare_model: >>> Stage Prepare base model started <<<]
[2025-07-09 15:26:51,222: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 15:26:51,223: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 15:26:51,224: INFO: common: created directory at: artifacts]
[2025-07-09 15:26:51,224: INFO: common: created directory at: artifacts/model_version]
[2025-07-09 15:26:51,225: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 15:26:51,225: INFO: configuration: Prepare base model config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'objective': 'binary:logistic', 'max_depth': 6, 'n_estimators': 300, 'random_state': 42, 'learning_rate': 0.1, 'scale_pos_weight': 10, 'n_jobs': -1}]
[2025-07-09 15:26:51,546: INFO: base_model: Creating base model and scaler]
[2025-07-09 15:26:51,547: INFO: base_model: Creating base XGBoost model]
[2025-07-09 15:26:51,547: INFO: base_model: Model params:300, 42, 0.1, 6, 10, -1]
[2025-07-09 15:26:51,547: INFO: base_model: Creating scaler from training data]
[2025-07-09 15:26:51,626: INFO: base_model: Base model saved: artifacts\model_version\base_model_churn_20250709T152651.pkl]
[2025-07-09 15:26:52,894: INFO: prepare_model: >>> Stage Prepare base model completed <<<]
[2025-07-09 15:26:52,894: INFO: main: Base model created at: artifacts\model_version\base_model_churn_20250709T152651.pkl]
[2025-07-09 15:26:52,895: INFO: main: Scaler created at: artifacts\model_version\scaler_churn_version_20250709T152651.pkl]
[2025-07-09 15:26:52,895: INFO: main: ==================================================]
[2025-07-09 15:26:52,895: INFO: main: ==================================================]
[2025-07-09 15:26:52,895: INFO: main: Running Model Training and Evaluation]
[2025-07-09 15:26:52,896: INFO: train_evaluation: >>> Stage TRAIN_AND_EVALUATE_MODEL started <<<]
[2025-07-09 15:26:52,900: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 15:26:52,901: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 15:26:52,902: INFO: common: created directory at: artifacts]
[2025-07-09 15:26:52,902: INFO: common: created directory at: artifacts/model_version]
[2025-07-09 15:26:52,903: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 15:26:52,903: INFO: configuration: Training config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version'}]
[2025-07-09 15:26:52,907: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 15:26:52,908: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 15:26:52,909: INFO: common: created directory at: artifacts]
[2025-07-09 15:26:52,912: INFO: common: created directory at: artifacts/evaluation]
[2025-07-09 15:26:52,913: INFO: common: created directory at: artifacts/model_version]
[2025-07-09 15:26:52,913: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 15:26:52,913: INFO: configuration: Evaluation config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'evaluation_dir': 'artifacts/evaluation'}]
[2025-07-09 15:26:52,914: INFO: model_training: Initiating model training and evaluation with temporary directory management]
[2025-07-09 15:26:52,914: INFO: model_training: Loaded y_train shape: (159774,)]
[2025-07-09 15:26:52,914: INFO: model_training: Loaded y_test shape: (39944,)]
[2025-07-09 15:26:52,915: INFO: model_training: NaN count in y_train: 0]
[2025-07-09 15:26:52,916: INFO: model_training: NaN count in y_test: 0]
[2025-07-09 15:26:52,916: INFO: model_training: Final X_train_scaled shape: (159774, 11)]
[2025-07-09 15:26:52,916: INFO: model_training: Final y_train shape: (159774,)]
[2025-07-09 15:26:52,917: INFO: model_training: Final X_test_scaled shape: (39944, 11)]
[2025-07-09 15:26:52,917: INFO: model_training: Final y_test shape: (39944,)]
[2025-07-09 15:26:52,920: INFO: model_training: Loading model: XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              feature_weights=None, gamma=None, grow_policy=None,
              importance_type=None, interaction_constraints=None,
              learning_rate=0.1, max_bin=None, max_cat_threshold=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=6,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, multi_strategy=None, n_estimators=300,
              n_jobs=-1, num_parallel_tree=None, ...)]
[2025-07-09 15:26:52,921: INFO: model_training: Starting model training for model_fraud_20250709T152652]
[2025-07-09 15:26:54,061: INFO: model_training: Model training for model_fraud_20250709T152652 completed]
[2025-07-09 15:26:54,071: INFO: model_training:   trained model file (for future use): artifacts\model_version\model_churn_version_20250709T152652.pkl]
[2025-07-09 15:26:54,448: INFO: model_training: Model accuracy on test data: 0.9981974764670539]
[2025-07-09 15:26:54,448: INFO: model_training: Model accuracy is 85% or above, not needed finetuned, log trained model to mlflow]
[2025-07-09 15:26:54,448: INFO: model_training: Logging model to MLflow as model_fraud_20250709T152652]
[2025-07-09 15:27:10,534: INFO: model_training: Successfully registered model under unique name: XGBoost]
[2025-07-09 15:27:10,534: INFO: model_training: Performing detailed evaluation on test data]
[2025-07-09 15:27:10,675: INFO: common: json file saved at: artifacts\evaluation\metrics_20250709T152652.json]
[2025-07-09 15:27:10,676: INFO: model_training: Detailed metrics saved to: artifacts\evaluation\metrics_20250709T152652.json]
[2025-07-09 15:27:23,260: INFO: model_training: Creating confusion matrix plot]
[2025-07-09 15:27:23,386: INFO: model_training: Confusion matrix saved to: artifacts\evaluation\confusion_matrix_20250709T152652.png]
[2025-07-09 15:27:24,247: INFO: model_training: Creating Precision-Recall curve plot]
[2025-07-09 15:27:24,380: INFO: model_training: Precision-Recall curve saved to: artifacts\evaluation\precision_recall_curve_20250709T152652.png]
[2025-07-09 15:27:25,303: INFO: model_training: Creating ROC curve plot]
[2025-07-09 15:27:25,433: INFO: model_training: ROC curve saved to: artifacts\evaluation\roc_curve_20250709T152652.png]
[2025-07-09 15:27:26,398: INFO: train_evaluation: >>> Stage TRAIN_AND_EVALUATE_MODEL completed <<<]
[2025-07-09 15:27:26,398: INFO: main: Training and evaluation completed. Final model at: artifacts\model_version\model_churn_version_20250709T152652.pkl]
[2025-07-09 15:27:26,399: INFO: main: Logged Metrics: {'precision': 0.9964678374210238, 'recall': 0.9999500773800609, 'f1_score': 0.9982059204624738, 'roc_auc': 0.9999928674808555, 'mcc': 0.9964010044780308, 'avg_precision': 0.9999927418432609, 'classification_report': {'0': {'precision': 0.9999496043944968, 'recall': 0.9964344900316376, 'f1-score': 0.9981889526109267, 'support': 19913.0}, '1': {'precision': 0.9964678374210238, 'recall': 0.9999500773800609, 'f1-score': 0.9982059204624738, 'support': 20031.0}, 'accuracy': 0.9981974764670539, 'macro avg': {'precision': 0.9982087209077604, 'recall': 0.9981922837058492, 'f1-score': 0.9981974365367002, 'support': 39944.0}, 'weighted avg': {'precision': 0.9982035781015458, 'recall': 0.9981974764670539, 'f1-score': 0.998197461599369, 'support': 39944.0}}}]
[2025-07-09 15:27:26,400: INFO: main: ==================================================]
[2025-07-09 15:27:27,120: INFO: main: >>>>>> stage Model Training Pipeline completed <<<<<<

x====================x]
[2025-07-09 15:27:27,120: INFO: main: >>>>>> stage STAGE 4: Cloud Storage Push started <<<<<<]
[2025-07-09 15:27:27,121: INFO: main: ==================================================]
[2025-07-09 15:27:27,121: INFO: main: STAGE 4: Cloud Storage Push]
[2025-07-09 15:27:27,121: INFO: main: ==================================================]
[2025-07-09 15:27:27,121: INFO: cloud_storage_push: >>> Stage Cloud Storage Push started <<<]
[2025-07-09 15:27:27,126: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 15:27:27,127: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 15:27:27,127: INFO: common: created directory at: artifacts]
[2025-07-09 15:27:27,130: INFO: configuration: Cloud Storage Push config: {'root_dir': 'artifacts', 'bucket_name': 'databucket231', 'data_version_dir': 'artifacts/data_version', 'evaluation_dir': 'artifacts/evaluation'}]
[2025-07-09 15:27:27,145: INFO: credentials: Found credentials in shared credentials file: ~/.aws/credentials]
[2025-07-09 15:27:27,399: INFO: cloud_storage_push: Ensured directory structure exists for cloud storage push]
[2025-07-09 15:27:27,399: INFO: cloud_storage_push: Starting cloud storage push process...]
[2025-07-09 15:27:28,058: INFO: cloud_storage_push: Bucket 'databucket231' exists and is accessible]
[2025-07-09 15:27:28,060: INFO: cloud_storage_push: Found 7 files to upload to cloud storage.]
[2025-07-09 15:27:29,039: INFO: cloud_storage_push: Uploaded artifacts\evaluation\metrics_20250709T152652.json to bucket databucket231.]
[2025-07-09 15:27:29,169: INFO: cloud_storage_push: Uploaded artifacts\evaluation\confusion_matrix_20250709T152652.png to bucket databucket231.]
[2025-07-09 15:27:29,175: INFO: cloud_storage_push: Uploaded artifacts\evaluation\roc_curve_20250709T152652.png to bucket databucket231.]
[2025-07-09 15:27:29,272: INFO: cloud_storage_push: Uploaded artifacts\evaluation\precision_recall_curve_20250709T152652.png to bucket databucket231.]
[2025-07-09 15:27:43,841: INFO: cloud_storage_push: Uploaded artifacts\data_version\processed_data_version_20250709T152646.csv to bucket databucket231.]
[2025-07-09 15:27:47,337: INFO: cloud_storage_push: Uploaded artifacts\data_version\featured_data_version_20250709T152646.csv to bucket databucket231.]
[2025-07-09 15:27:48,998: INFO: cloud_storage_push: Uploaded artifacts\data_version\input_raw_data_version_20250709T152646.csv to bucket databucket231.]
[2025-07-09 15:27:48,999: INFO: cloud_storage_push: Successfully uploaded 7 files to S3 bucket: databucket231]
[2025-07-09 15:27:48,999: INFO: cloud_storage_push: >>> Stage Cloud Storage Push completed <<<]
[2025-07-09 15:27:48,999: INFO: main: Cloud storage push completed successfully]
[2025-07-09 15:27:49,000: INFO: main: >>>>>> stage STAGE 4: Cloud Storage Push completed <<<<<<

x====================x]
[2025-07-09 16:14:14,578: INFO: main: 5 changes detected]
[2025-07-09 16:14:15,328: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2025-07-09 16:14:15,328: INFO: preprocess_data: >>> Stage Data Ingestion stage started <<<]
[2025-07-09 16:14:15,333: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 16:14:15,334: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 16:14:15,335: INFO: common: created directory at: artifacts]
[2025-07-09 16:14:15,335: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-09 16:14:15,335: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 16:14:15,336: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-09 16:14:15,336: INFO: data_ingestion: Initiating data ingestion]
[2025-07-09 16:14:15,336: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-09 16:14:15,516: INFO: data_ingestion: Loaded dataset with 100000 rows]
[2025-07-09 16:14:15,516: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-09 16:14:15,517: INFO: data_ingestion: Starting preprocessing of 100000 rows...]
[2025-07-09 16:14:15,517: INFO: data_ingestion: Initial columns: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-09 16:14:15,560: INFO: data_ingestion: After feature engineering columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-09 16:14:15,561: INFO: data_ingestion: Data shape after feature engineering: (100000, 12)]
[2025-07-09 16:14:15,575: INFO: data_ingestion: First few rows of feature engineered data: 
   step      amount  oldbalanceOrg  oldbalanceDest  isFraud  ...  type_CASH_IN  type_CASH_OUT  type_DEBIT  type_PAYMENT  type_TRANSFER
0   278   330218.42       20866.00       452419.57        0  ...             1              0           0             0              0
1    15    11647.08       30370.00            0.00        0  ...             0              0           0             1              0
2    10   152264.21      106589.00       201303.01        0  ...             1              0           0             0              0
3   403  1551760.63           0.00      3198359.45        0  ...             0              0           0             0              1
4   206    78172.30     2921331.58       415821.90        0  ...             1              0           0             0              0

[5 rows x 12 columns]]
[2025-07-09 16:14:15,576: INFO: data_ingestion: After encoding columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-09 16:14:15,576: INFO: data_ingestion: Data shape after encoding: (100000, 12)]
[2025-07-09 16:14:15,583: INFO: data_ingestion: Data shape after removing NaN: (100000, 12)]
[2025-07-09 16:14:15,587: INFO: data_ingestion: X shape (features): (100000, 11)]
[2025-07-09 16:14:15,587: INFO: data_ingestion: y shape (target): (100000,)]
[2025-07-09 16:14:15,588: INFO: data_ingestion: Target variable shape: (100000,)]
[2025-07-09 16:14:15,588: INFO: data_ingestion: NaN count in target: 0]
[2025-07-09 16:14:15,592: INFO: data_ingestion: Target variable distribution: 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-09 16:14:15,595: INFO: data_ingestion: Final feature matrix shape: (100000, 11)]
[2025-07-09 16:14:15,596: INFO: data_ingestion: Final target vector shape: (100000,)]
[2025-07-09 16:14:15,598: INFO: data_ingestion: Target variable distribution (normalized): 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-09 16:14:15,599: INFO: data_ingestion: Target variable is imbalanced. Applying SMOTE...]
[2025-07-09 16:14:15,677: INFO: data_ingestion: Resampled feature matrix shape: (199718, 11)]
[2025-07-09 16:14:15,679: INFO: data_ingestion: Resampled target distribution: 
isFraud
0    99859
1    99859
Name: count, dtype: int64]
[2025-07-09 16:14:15,759: INFO: main: 1 change detected]
[2025-07-09 16:14:16,116: INFO: main: 1 change detected]
[2025-07-09 16:14:16,474: INFO: main: 3 changes detected]
[2025-07-09 16:14:16,833: INFO: main: 1 change detected]
[2025-07-09 16:14:17,189: INFO: main: 3 changes detected]
[2025-07-09 16:14:17,390: INFO: data_ingestion: Created versioned input data file: artifacts\data_version\input_raw_data_version_20250709T161415.csv]
[2025-07-09 16:14:17,390: INFO: data_ingestion: Created versioned processed data file: artifacts\data_version\processed_data_version_20250709T161415.csv]
[2025-07-09 16:14:17,390: INFO: data_ingestion: Created versioned feature engineered data file: artifacts\data_version\featured_data_version_20250709T161415.csv]
[2025-07-09 16:14:17,406: INFO: data_ingestion: Splitting data into train and test sets]
[2025-07-09 16:14:17,439: INFO: data_ingestion: Train data: (159774, 11), Test data: (39944, 11)]
[2025-07-09 16:14:17,439: INFO: data_ingestion: Data ingestion completed successfully]
[2025-07-09 16:14:17,439: INFO: data_ingestion: Data shape - Train: (159774, 11), Test: (39944, 11)]
[2025-07-09 16:14:17,439: INFO: preprocess_data: >>> Stage Data Ingestion stage completed <<<]
[2025-07-09 16:14:17,439: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x====================x]
[2025-07-09 16:14:17,439: INFO: main: >>>>>> stage Model Training Pipeline started <<<<<<]
[2025-07-09 16:14:17,452: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 16:14:17,453: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 16:14:17,453: INFO: common: created directory at: artifacts]
[2025-07-09 16:14:17,454: INFO: configuration: MLFlow configuration: MLFlowConfig(dagshub_username='minh120103', dagshub_repo_name='E2E_ML', tracking_uri='https://dagshub.com/minh120103/E2E_ML.mlflow', experiment_name='Fraud_Detection_Experiment')]
[2025-07-09 16:14:17,551: INFO: main: 1 change detected]
[2025-07-09 16:14:17,860: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/user "HTTP/1.1 200 OK"]
[2025-07-09 16:14:17,870: INFO: helpers: Accessing as minh120103]
[2025-07-09 16:14:18,228: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/repos/minh120103/E2E_ML "HTTP/1.1 200 OK"]
[2025-07-09 16:14:18,546: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/user "HTTP/1.1 200 OK"]
[2025-07-09 16:14:18,546: INFO: helpers: Initialized MLflow to track repo "minh120103/E2E_ML"]
[2025-07-09 16:14:18,546: INFO: helpers: Repository minh120103/E2E_ML initialized!]
[2025-07-09 16:14:19,587: INFO: main: ==================================================]
[2025-07-09 16:14:19,587: INFO: main: Running Model Preparation]
[2025-07-09 16:14:19,587: INFO: prepare_model: >>> Stage Prepare base model started <<<]
[2025-07-09 16:14:19,591: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 16:14:19,592: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 16:14:19,593: INFO: common: created directory at: artifacts]
[2025-07-09 16:14:19,593: INFO: common: created directory at: artifacts/model_version]
[2025-07-09 16:14:19,594: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 16:14:19,594: INFO: configuration: Prepare base model config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'objective': 'binary:logistic', 'max_depth': 6, 'n_estimators': 300, 'random_state': 42, 'learning_rate': 0.1, 'scale_pos_weight': 10, 'n_jobs': -1}]
[2025-07-09 16:14:19,915: INFO: base_model: Creating base model and scaler]
[2025-07-09 16:14:19,916: INFO: base_model: Creating base XGBoost model]
[2025-07-09 16:14:19,916: INFO: base_model: Model params:300, 42, 0.1, 6, 10, -1]
[2025-07-09 16:14:19,917: INFO: base_model: Creating scaler from training data]
[2025-07-09 16:14:19,990: INFO: base_model: Base model saved: artifacts\model_version\base_model_churn_20250709T161419.pkl]
[2025-07-09 16:14:20,083: INFO: main: 3 changes detected]
[2025-07-09 16:14:21,481: INFO: prepare_model: >>> Stage Prepare base model completed <<<]
[2025-07-09 16:14:21,481: INFO: main: Base model created at: artifacts\model_version\base_model_churn_20250709T161419.pkl]
[2025-07-09 16:14:21,481: INFO: main: Scaler created at: artifacts\model_version\scaler_churn_version_20250709T161419.pkl]
[2025-07-09 16:14:21,481: INFO: main: ==================================================]
[2025-07-09 16:14:21,481: INFO: main: ==================================================]
[2025-07-09 16:14:21,481: INFO: main: Running Model Training and Evaluation]
[2025-07-09 16:14:21,481: INFO: train_evaluation: >>> Stage TRAIN_AND_EVALUATE_MODEL started <<<]
[2025-07-09 16:14:21,481: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 16:14:21,481: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 16:14:21,495: INFO: common: created directory at: artifacts]
[2025-07-09 16:14:21,495: INFO: common: created directory at: artifacts/model_version]
[2025-07-09 16:14:21,496: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 16:14:21,496: INFO: configuration: Training config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version'}]
[2025-07-09 16:14:21,499: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 16:14:21,500: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 16:14:21,500: INFO: common: created directory at: artifacts]
[2025-07-09 16:14:21,500: INFO: common: created directory at: artifacts/evaluation]
[2025-07-09 16:14:21,500: INFO: common: created directory at: artifacts/model_version]
[2025-07-09 16:14:21,500: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 16:14:21,500: INFO: configuration: Evaluation config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'evaluation_dir': 'artifacts/evaluation'}]
[2025-07-09 16:14:21,500: INFO: model_training: Initiating model training and evaluation with temporary directory management]
[2025-07-09 16:14:21,500: INFO: model_training: Loaded y_train shape: (159774,)]
[2025-07-09 16:14:21,500: INFO: model_training: Loaded y_test shape: (39944,)]
[2025-07-09 16:14:21,500: INFO: model_training: NaN count in y_train: 0]
[2025-07-09 16:14:21,500: INFO: model_training: NaN count in y_test: 0]
[2025-07-09 16:14:21,500: INFO: model_training: Final X_train_scaled shape: (159774, 11)]
[2025-07-09 16:14:21,500: INFO: model_training: Final y_train shape: (159774,)]
[2025-07-09 16:14:21,500: INFO: model_training: Final X_test_scaled shape: (39944, 11)]
[2025-07-09 16:14:21,506: INFO: model_training: Final y_test shape: (39944,)]
[2025-07-09 16:14:21,510: INFO: model_training: Loading model: XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              feature_weights=None, gamma=None, grow_policy=None,
              importance_type=None, interaction_constraints=None,
              learning_rate=0.1, max_bin=None, max_cat_threshold=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=6,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, multi_strategy=None, n_estimators=300,
              n_jobs=-1, num_parallel_tree=None, ...)]
[2025-07-09 16:14:21,511: INFO: model_training: Starting model training for model_fraud_20250709T161421]
[2025-07-09 16:14:22,612: INFO: model_training: Model training for model_fraud_20250709T161421 completed]
[2025-07-09 16:14:22,619: INFO: model_training:   trained model file (for future use): artifacts\model_version\model_churn_version_20250709T161421.pkl]
[2025-07-09 16:14:22,680: INFO: main: 1 change detected]
[2025-07-09 16:14:23,021: INFO: model_training: Model accuracy on test data: 0.9981974764670539]
[2025-07-09 16:14:23,022: INFO: model_training: Model accuracy is 85% or above, not needed finetuned, log trained model to mlflow]
[2025-07-09 16:14:23,022: INFO: model_training: Logging model to MLflow as model_fraud_20250709T161421]
[2025-07-09 16:14:38,906: INFO: main: 1 change detected]
[2025-07-09 16:14:41,550: INFO: model_training: Successfully registered model under unique name: XGBoost]
[2025-07-09 16:14:41,551: INFO: model_training: Performing detailed evaluation on test data]
[2025-07-09 16:14:41,694: INFO: common: json file saved at: artifacts\evaluation\metrics_20250709T161421.json]
[2025-07-09 16:14:41,694: INFO: model_training: Detailed metrics saved to: artifacts\evaluation\metrics_20250709T161421.json]
[2025-07-09 16:14:41,745: INFO: main: 1 change detected]
[2025-07-09 16:14:54,255: INFO: model_training: Creating confusion matrix plot]
[2025-07-09 16:14:54,547: INFO: model_training: Confusion matrix saved to: artifacts\evaluation\confusion_matrix_20250709T161421.png]
[2025-07-09 16:14:54,566: INFO: main: 2 changes detected]
[2025-07-09 16:14:55,247: INFO: model_training: Creating Precision-Recall curve plot]
[2025-07-09 16:14:55,386: INFO: main: 2 changes detected]
[2025-07-09 16:14:55,386: INFO: model_training: Precision-Recall curve saved to: artifacts\evaluation\precision_recall_curve_20250709T161421.png]
[2025-07-09 16:14:56,250: INFO: model_training: Creating ROC curve plot]
[2025-07-09 16:14:56,370: INFO: model_training: ROC curve saved to: artifacts\evaluation\roc_curve_20250709T161421.png]
[2025-07-09 16:14:56,405: INFO: main: 2 changes detected]
[2025-07-09 16:14:57,257: INFO: train_evaluation: >>> Stage TRAIN_AND_EVALUATE_MODEL completed <<<]
[2025-07-09 16:14:57,258: INFO: main: Training and evaluation completed. Final model at: artifacts\model_version\model_churn_version_20250709T161421.pkl]
[2025-07-09 16:14:57,259: INFO: main: Logged Metrics: {'precision': 0.9964678374210238, 'recall': 0.9999500773800609, 'f1_score': 0.9982059204624738, 'roc_auc': 0.9999928674808555, 'mcc': 0.9964010044780308, 'avg_precision': 0.9999927418432609, 'classification_report': {'0': {'precision': 0.9999496043944968, 'recall': 0.9964344900316376, 'f1-score': 0.9981889526109267, 'support': 19913.0}, '1': {'precision': 0.9964678374210238, 'recall': 0.9999500773800609, 'f1-score': 0.9982059204624738, 'support': 20031.0}, 'accuracy': 0.9981974764670539, 'macro avg': {'precision': 0.9982087209077604, 'recall': 0.9981922837058492, 'f1-score': 0.9981974365367002, 'support': 39944.0}, 'weighted avg': {'precision': 0.9982035781015458, 'recall': 0.9981974764670539, 'f1-score': 0.998197461599369, 'support': 39944.0}}}]
[2025-07-09 16:14:57,259: INFO: main: ==================================================]
[2025-07-09 16:14:58,102: INFO: main: >>>>>> stage Model Training Pipeline completed <<<<<<

x====================x]
[2025-07-09 16:14:58,103: INFO: main: >>>>>> stage STAGE 4: Cloud Storage Push started <<<<<<]
[2025-07-09 16:14:58,103: INFO: main: ==================================================]
[2025-07-09 16:14:58,103: INFO: main: STAGE 4: Cloud Storage Push]
[2025-07-09 16:14:58,104: INFO: main: ==================================================]
[2025-07-09 16:14:58,104: INFO: cloud_storage_push: >>> Stage Cloud Storage Push started <<<]
[2025-07-09 16:14:58,108: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 16:14:58,110: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 16:14:58,110: INFO: common: created directory at: artifacts]
[2025-07-09 16:14:58,112: INFO: configuration: Cloud Storage Push config: {'root_dir': 'artifacts', 'bucket_name': 'databucket231', 'data_version_dir': 'artifacts/data_version', 'evaluation_dir': 'artifacts/evaluation'}]
[2025-07-09 16:14:58,145: INFO: credentials: Found credentials in shared credentials file: ~/.aws/credentials]
[2025-07-09 16:14:58,435: INFO: cloud_storage_push: Ensured directory structure exists for cloud storage push]
[2025-07-09 16:14:58,435: INFO: cloud_storage_push: Starting cloud storage push process...]
[2025-07-09 16:14:58,496: INFO: main: 1 change detected]
[2025-07-09 16:14:59,136: INFO: cloud_storage_push: Bucket 'databucket231' exists and is accessible]
[2025-07-09 16:14:59,136: INFO: cloud_storage_push: Found 14 files to upload to cloud storage.]
[2025-07-09 16:15:00,163: INFO: cloud_storage_push: Uploaded artifacts\evaluation\confusion_matrix_20250709T152652.png to bucket databucket231.]
[2025-07-09 16:15:00,186: INFO: cloud_storage_push: Uploaded artifacts\evaluation\confusion_matrix_20250709T161421.png to bucket databucket231.]
[2025-07-09 16:15:00,533: INFO: cloud_storage_push: Uploaded artifacts\evaluation\metrics_20250709T161421.json to bucket databucket231.]
[2025-07-09 16:15:00,800: INFO: cloud_storage_push: Uploaded artifacts\evaluation\metrics_20250709T152652.json to bucket databucket231.]
[2025-07-09 16:15:01,311: INFO: cloud_storage_push: Uploaded artifacts\evaluation\precision_recall_curve_20250709T161421.png to bucket databucket231.]
[2025-07-09 16:15:01,421: INFO: cloud_storage_push: Uploaded artifacts\evaluation\precision_recall_curve_20250709T152652.png to bucket databucket231.]
[2025-07-09 16:15:01,809: INFO: cloud_storage_push: Uploaded artifacts\evaluation\roc_curve_20250709T152652.png to bucket databucket231.]
[2025-07-09 16:15:02,414: INFO: cloud_storage_push: Uploaded artifacts\evaluation\roc_curve_20250709T161421.png to bucket databucket231.]
[2025-07-09 16:15:30,558: INFO: cloud_storage_push: Uploaded artifacts\data_version\processed_data_version_20250709T152646.csv to bucket databucket231.]
[2025-07-09 16:15:33,450: INFO: cloud_storage_push: Uploaded artifacts\data_version\featured_data_version_20250709T161415.csv to bucket databucket231.]
[2025-07-09 16:15:33,993: INFO: cloud_storage_push: Uploaded artifacts\data_version\featured_data_version_20250709T152646.csv to bucket databucket231.]
[2025-07-09 16:15:36,885: INFO: cloud_storage_push: Uploaded artifacts\data_version\input_raw_data_version_20250709T161415.csv to bucket databucket231.]
[2025-07-09 16:15:38,614: INFO: cloud_storage_push: Uploaded artifacts\data_version\input_raw_data_version_20250709T152646.csv to bucket databucket231.]
[2025-07-09 16:15:39,059: INFO: cloud_storage_push: Uploaded artifacts\data_version\processed_data_version_20250709T161415.csv to bucket databucket231.]
[2025-07-09 16:15:39,060: INFO: cloud_storage_push: Successfully uploaded 14 files to S3 bucket: databucket231]
[2025-07-09 16:15:39,060: INFO: cloud_storage_push: >>> Stage Cloud Storage Push completed <<<]
[2025-07-09 16:15:39,061: INFO: main: Cloud storage push completed successfully]
[2025-07-09 16:15:39,061: INFO: main: >>>>>> stage STAGE 4: Cloud Storage Push completed <<<<<<

x====================x]
[2025-07-09 16:15:39,845: INFO: main: 1 change detected]
[2025-07-09 16:15:40,205: INFO: main: 1 change detected]
[2025-07-09 16:15:40,616: INFO: main: 1 change detected]
[2025-07-09 16:15:41,020: INFO: main: 1 change detected]
[2025-07-09 16:15:41,425: INFO: main: 1 change detected]
[2025-07-09 16:15:41,831: INFO: main: 1 change detected]
[2025-07-09 16:15:42,236: INFO: main: 1 change detected]
[2025-07-09 16:15:42,641: INFO: main: 1 change detected]
[2025-07-09 16:15:43,045: INFO: main: 1 change detected]
[2025-07-09 16:15:43,451: INFO: main: 1 change detected]
[2025-07-09 16:15:43,858: INFO: main: 1 change detected]
[2025-07-09 16:15:44,267: INFO: main: 1 change detected]
[2025-07-09 16:15:44,679: INFO: main: 1 change detected]
[2025-07-09 16:15:45,081: INFO: main: 1 change detected]
[2025-07-09 16:15:45,487: INFO: main: 1 change detected]
[2025-07-09 16:15:45,892: INFO: main: 1 change detected]
[2025-07-09 16:15:46,300: INFO: main: 1 change detected]
[2025-07-09 16:15:46,659: INFO: main: 1 change detected]
[2025-07-09 16:15:47,076: INFO: main: 1 change detected]
[2025-07-09 16:15:47,490: INFO: main: 1 change detected]
[2025-07-09 16:15:47,892: INFO: main: 1 change detected]
[2025-07-09 16:15:48,307: INFO: main: 1 change detected]
[2025-07-09 16:15:48,666: INFO: main: 1 change detected]
[2025-07-09 16:15:49,121: INFO: main: 1 change detected]
[2025-07-09 16:15:49,476: INFO: main: 1 change detected]
[2025-07-09 16:15:49,887: INFO: main: 1 change detected]
[2025-07-09 16:15:50,291: INFO: main: 1 change detected]
[2025-07-09 16:15:50,698: INFO: main: 1 change detected]
[2025-07-09 16:15:51,103: INFO: main: 1 change detected]
[2025-07-09 16:15:51,506: INFO: main: 1 change detected]
[2025-07-09 16:15:51,864: INFO: main: 1 change detected]
[2025-07-09 16:15:52,271: INFO: main: 1 change detected]
[2025-07-09 16:15:52,678: INFO: main: 1 change detected]
[2025-07-09 16:15:53,084: INFO: main: 1 change detected]
[2025-07-09 16:15:53,492: INFO: main: 1 change detected]
[2025-07-09 16:15:53,844: INFO: main: 1 change detected]
[2025-07-09 16:15:54,253: INFO: main: 1 change detected]
[2025-07-09 16:15:54,654: INFO: main: 1 change detected]
[2025-07-09 16:15:55,059: INFO: main: 1 change detected]
[2025-07-09 16:15:55,466: INFO: main: 1 change detected]
[2025-07-09 16:15:55,873: INFO: main: 1 change detected]
[2025-07-09 16:15:56,279: INFO: main: 1 change detected]
[2025-07-09 16:15:56,682: INFO: main: 1 change detected]
[2025-07-09 16:15:57,048: INFO: main: 1 change detected]
[2025-07-09 16:15:57,463: INFO: main: 1 change detected]
[2025-07-09 16:15:57,879: INFO: main: 1 change detected]
[2025-07-09 16:15:58,294: INFO: main: 1 change detected]
[2025-07-09 16:15:58,711: INFO: main: 1 change detected]
[2025-07-09 16:15:59,065: INFO: main: 1 change detected]
[2025-07-09 16:15:59,476: INFO: main: 1 change detected]
[2025-07-09 16:15:59,886: INFO: main: 1 change detected]
[2025-07-09 16:16:00,291: INFO: main: 1 change detected]
[2025-07-09 16:16:00,702: INFO: main: 1 change detected]
[2025-07-09 16:16:01,104: INFO: main: 1 change detected]
[2025-07-09 16:16:01,472: INFO: main: 1 change detected]
[2025-07-09 16:16:01,890: INFO: main: 1 change detected]
[2025-07-09 16:16:02,298: INFO: main: 1 change detected]
[2025-07-09 16:16:02,714: INFO: main: 1 change detected]
[2025-07-09 16:16:03,068: INFO: main: 1 change detected]
[2025-07-09 16:16:03,479: INFO: main: 1 change detected]
[2025-07-09 16:16:03,884: INFO: main: 1 change detected]
[2025-07-09 16:16:04,294: INFO: main: 1 change detected]
[2025-07-09 16:16:04,699: INFO: main: 1 change detected]
[2025-07-09 16:16:05,114: INFO: main: 1 change detected]
[2025-07-09 16:16:05,478: INFO: main: 1 change detected]
[2025-07-09 16:16:05,892: INFO: main: 1 change detected]
[2025-07-09 16:16:06,295: INFO: main: 1 change detected]
[2025-07-09 16:16:06,697: INFO: main: 1 change detected]
[2025-07-09 16:16:07,099: INFO: main: 1 change detected]
[2025-07-09 16:16:07,452: INFO: main: 1 change detected]
[2025-07-09 16:16:07,857: INFO: main: 1 change detected]
[2025-07-09 16:16:08,259: INFO: main: 1 change detected]
[2025-07-09 16:16:08,665: INFO: main: 1 change detected]
[2025-07-09 16:16:09,066: INFO: main: 1 change detected]
[2025-07-09 16:16:09,478: INFO: main: 1 change detected]
[2025-07-09 16:16:09,884: INFO: main: 1 change detected]
[2025-07-09 16:16:10,291: INFO: main: 1 change detected]
[2025-07-09 16:16:10,698: INFO: main: 1 change detected]
[2025-07-09 16:16:11,104: INFO: main: 1 change detected]
[2025-07-09 16:16:11,510: INFO: main: 1 change detected]
[2025-07-09 16:16:11,917: INFO: main: 1 change detected]
[2025-07-09 16:16:12,326: INFO: main: 1 change detected]
[2025-07-09 16:16:12,731: INFO: main: 1 change detected]
[2025-07-09 16:16:13,145: INFO: main: 1 change detected]
[2025-07-09 16:16:13,547: INFO: main: 1 change detected]
[2025-07-09 16:16:13,963: INFO: main: 1 change detected]
[2025-07-09 16:16:14,328: INFO: main: 1 change detected]
[2025-07-09 16:16:14,739: INFO: main: 1 change detected]
[2025-07-09 16:16:15,148: INFO: main: 1 change detected]
[2025-07-09 16:16:15,554: INFO: main: 1 change detected]
[2025-07-09 16:16:15,959: INFO: main: 1 change detected]
[2025-07-09 16:16:16,364: INFO: main: 1 change detected]
[2025-07-09 16:16:16,769: INFO: main: 1 change detected]
[2025-07-09 16:16:17,175: INFO: main: 1 change detected]
[2025-07-09 16:16:17,578: INFO: main: 1 change detected]
[2025-07-09 16:16:17,984: INFO: main: 1 change detected]
[2025-07-09 16:16:18,392: INFO: main: 1 change detected]
[2025-07-09 16:16:18,796: INFO: main: 1 change detected]
[2025-07-09 16:16:19,203: INFO: main: 1 change detected]
[2025-07-09 16:16:19,608: INFO: main: 1 change detected]
[2025-07-09 16:16:20,024: INFO: main: 1 change detected]
[2025-07-09 16:16:20,392: INFO: main: 1 change detected]
[2025-07-09 16:16:20,808: INFO: main: 1 change detected]
[2025-07-09 16:16:21,218: INFO: main: 1 change detected]
[2025-07-09 16:16:21,621: INFO: main: 1 change detected]
[2025-07-09 16:16:22,028: INFO: main: 1 change detected]
[2025-07-09 16:16:22,433: INFO: main: 1 change detected]
[2025-07-09 16:16:22,838: INFO: main: 1 change detected]
[2025-07-09 16:16:23,254: INFO: main: 1 change detected]
[2025-07-09 16:16:23,618: INFO: main: 1 change detected]
[2025-07-09 16:16:24,020: INFO: main: 1 change detected]
[2025-07-09 16:16:24,427: INFO: main: 1 change detected]
[2025-07-09 16:16:24,830: INFO: main: 1 change detected]
[2025-07-09 16:16:25,233: INFO: main: 1 change detected]
[2025-07-09 16:16:25,639: INFO: main: 1 change detected]
[2025-07-09 16:16:26,042: INFO: main: 1 change detected]
[2025-07-09 16:16:26,447: INFO: main: 1 change detected]
[2025-07-09 16:16:26,855: INFO: main: 1 change detected]
[2025-07-09 16:16:27,224: INFO: main: 1 change detected]
[2025-07-09 16:16:27,627: INFO: main: 1 change detected]
[2025-07-09 16:16:28,030: INFO: main: 1 change detected]
[2025-07-09 16:16:28,448: INFO: main: 1 change detected]
[2025-07-09 16:16:28,808: INFO: main: 1 change detected]
[2025-07-09 16:16:29,263: INFO: main: 1 change detected]
[2025-07-09 16:16:29,629: INFO: main: 1 change detected]
[2025-07-09 16:16:30,037: INFO: main: 1 change detected]
[2025-07-09 16:16:30,455: INFO: main: 1 change detected]
[2025-07-09 16:16:30,859: INFO: main: 1 change detected]
[2025-07-09 16:19:30,006: INFO: main: 5 changes detected]
[2025-07-09 16:20:09,294: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 16:20:09,296: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 16:20:09,296: INFO: common: created directory at: artifacts]
[2025-07-09 16:20:09,297: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-09 16:20:09,297: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 16:20:09,298: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-09 16:21:22,304: ERROR: predict_pipeline: Background prediction task error: Failed to load model or scaler: The following failures occurred while downloading one or more artifacts from https://dagshub.com/minh120103/E2E_ML.mlflow/api/2.0/mlflow-artifacts/artifacts/bc590692f45048a2b7d353c97fbf9c41/621b0660b6674e21b5f7090fbc211a6f/artifacts:
##### File scaler_churn_version_20250708T142954.pkl #####
API request to https://dagshub.com/minh120103/E2E_ML.mlflow/api/2.0/mlflow-artifacts/artifacts/bc590692f45048a2b7d353c97fbf9c41/621b0660b6674e21b5f7090fbc211a6f/artifacts/scaler_churn_version_20250708T142954.pkl failed with exception HTTPSConnectionPool(host='dagshub.com', port=443): Max retries exceeded with url: /minh120103/E2E_ML.mlflow/api/2.0/mlflow-artifacts/artifacts/bc590692f45048a2b7d353c97fbf9c41/621b0660b6674e21b5f7090fbc211a6f/artifacts/scaler_churn_version_20250708T142954.pkl (Caused by ResponseError('too many 500 error responses'))]
[2025-07-09 16:21:22,313: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 16:21:22,314: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 16:21:22,315: INFO: common: created directory at: artifacts]
[2025-07-09 16:21:22,316: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-09 16:21:22,316: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 16:21:22,317: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-09 16:22:32,170: ERROR: predict_pipeline: Background prediction task error: Failed to load model or scaler: The following failures occurred while downloading one or more artifacts from https://dagshub.com/minh120103/E2E_ML.mlflow/api/2.0/mlflow-artifacts/artifacts/bc590692f45048a2b7d353c97fbf9c41/621b0660b6674e21b5f7090fbc211a6f/artifacts:
##### File scaler_churn_version_20250708T142954.pkl #####
API request to https://dagshub.com/minh120103/E2E_ML.mlflow/api/2.0/mlflow-artifacts/artifacts/bc590692f45048a2b7d353c97fbf9c41/621b0660b6674e21b5f7090fbc211a6f/artifacts/scaler_churn_version_20250708T142954.pkl failed with exception HTTPSConnectionPool(host='dagshub.com', port=443): Max retries exceeded with url: /minh120103/E2E_ML.mlflow/api/2.0/mlflow-artifacts/artifacts/bc590692f45048a2b7d353c97fbf9c41/621b0660b6674e21b5f7090fbc211a6f/artifacts/scaler_churn_version_20250708T142954.pkl (Caused by ResponseError('too many 500 error responses'))]
[2025-07-09 16:26:11,328: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 16:26:11,329: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 16:26:11,330: INFO: common: created directory at: artifacts]
[2025-07-09 16:26:11,331: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-09 16:26:11,331: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 16:26:11,332: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-09 16:27:23,200: ERROR: predict_pipeline: Background prediction task error: Failed to load model or scaler: The following failures occurred while downloading one or more artifacts from https://dagshub.com/minh120103/E2E_ML.mlflow/api/2.0/mlflow-artifacts/artifacts/bc590692f45048a2b7d353c97fbf9c41/621b0660b6674e21b5f7090fbc211a6f/artifacts:
##### File scaler_churn_version_20250708T142954.pkl #####
API request to https://dagshub.com/minh120103/E2E_ML.mlflow/api/2.0/mlflow-artifacts/artifacts/bc590692f45048a2b7d353c97fbf9c41/621b0660b6674e21b5f7090fbc211a6f/artifacts/scaler_churn_version_20250708T142954.pkl failed with exception HTTPSConnectionPool(host='dagshub.com', port=443): Max retries exceeded with url: /minh120103/E2E_ML.mlflow/api/2.0/mlflow-artifacts/artifacts/bc590692f45048a2b7d353c97fbf9c41/621b0660b6674e21b5f7090fbc211a6f/artifacts/scaler_churn_version_20250708T142954.pkl (Caused by ResponseError('too many 500 error responses'))]
[2025-07-09 16:27:23,207: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 16:27:23,207: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 16:27:23,213: INFO: common: created directory at: artifacts]
[2025-07-09 16:27:23,213: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-09 16:27:23,214: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 16:27:23,214: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-09 16:31:41,696: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 16:31:41,701: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 16:31:41,701: INFO: common: created directory at: artifacts]
[2025-07-09 16:31:41,701: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-09 16:31:41,701: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 16:31:41,701: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-09 16:31:50,017: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 16:31:50,018: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 16:31:50,019: INFO: common: created directory at: artifacts]
[2025-07-09 16:31:50,019: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-09 16:31:50,019: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 16:31:50,019: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-09 16:31:50,844: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-09 16:31:51,010: INFO: data_ingestion: Loaded dataset with 100000 rows]
[2025-07-09 16:31:51,010: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-09 16:31:51,371: ERROR: predict_pipeline: Background prediction task error: Prediction error: The feature names should match those that were passed during fit.
Feature names unseen at fit time:
- isFraud
]
[2025-07-09 16:31:51,383: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 16:31:51,384: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 16:31:51,384: INFO: common: created directory at: artifacts]
[2025-07-09 16:31:51,385: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-09 16:31:51,385: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 16:31:51,385: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-09 16:32:05,487: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 16:32:05,488: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 16:32:05,489: INFO: common: created directory at: artifacts]
[2025-07-09 16:32:05,489: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-09 16:32:05,490: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 16:32:05,490: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-09 16:32:06,249: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-09 16:32:06,412: INFO: data_ingestion: Loaded dataset with 100000 rows]
[2025-07-09 16:32:06,412: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-09 16:32:07,254: ERROR: predict_pipeline: Background prediction task error: Prediction error: The feature names should match those that were passed during fit.
Feature names unseen at fit time:
- isFraud
]
[2025-07-09 16:42:01,476: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 16:42:01,478: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 16:42:01,479: INFO: common: created directory at: artifacts]
[2025-07-09 16:42:01,479: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-09 16:42:01,480: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 16:42:01,480: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-09 16:42:09,262: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 16:42:09,263: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 16:42:09,264: INFO: common: created directory at: artifacts]
[2025-07-09 16:42:09,265: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-09 16:42:09,265: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 16:42:09,265: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-09 16:42:09,833: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-09 16:42:10,000: INFO: data_ingestion: Loaded dataset with 100000 rows]
[2025-07-09 16:42:10,001: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-09 16:42:10,366: ERROR: predict_pipeline: Background prediction task error: Prediction error: The feature names should match those that were passed during fit.
Feature names unseen at fit time:
- isFraud
]
[2025-07-09 16:42:10,378: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 16:42:10,379: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 16:42:10,380: INFO: common: created directory at: artifacts]
[2025-07-09 16:42:10,381: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-09 16:42:10,381: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 16:42:10,381: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-09 16:42:25,215: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 16:42:25,217: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 16:42:25,217: INFO: common: created directory at: artifacts]
[2025-07-09 16:42:25,217: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-09 16:42:25,218: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 16:42:25,218: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-09 16:42:26,038: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-09 16:42:26,198: INFO: data_ingestion: Loaded dataset with 100000 rows]
[2025-07-09 16:42:26,199: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-09 16:42:27,038: ERROR: predict_pipeline: Background prediction task error: Prediction error: The feature names should match those that were passed during fit.
Feature names unseen at fit time:
- isFraud
]
[2025-07-09 16:50:03,437: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 16:50:03,437: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 16:50:03,437: INFO: common: created directory at: artifacts]
[2025-07-09 16:50:03,437: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-09 16:50:03,437: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 16:50:03,437: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-09 16:50:12,858: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 16:50:12,860: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 16:50:12,860: INFO: common: created directory at: artifacts]
[2025-07-09 16:50:12,861: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-09 16:50:12,861: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 16:50:12,862: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-09 16:50:13,456: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-09 16:50:13,619: INFO: data_ingestion: Loaded dataset with 100000 rows]
[2025-07-09 16:50:13,620: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-09 16:50:13,987: ERROR: predict_pipeline: Background prediction task error: Prediction error: The feature names should match those that were passed during fit.
Feature names unseen at fit time:
- isFraud
]
[2025-07-09 16:50:14,001: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 16:50:14,002: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 16:50:14,003: INFO: common: created directory at: artifacts]
[2025-07-09 16:50:14,003: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-09 16:50:14,004: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 16:50:14,004: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-09 16:50:27,280: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 16:50:27,281: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 16:50:27,282: INFO: common: created directory at: artifacts]
[2025-07-09 16:50:27,283: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-09 16:50:27,283: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 16:50:27,284: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-09 16:50:28,005: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-09 16:50:28,165: INFO: data_ingestion: Loaded dataset with 100000 rows]
[2025-07-09 16:50:28,166: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-09 16:50:29,024: ERROR: predict_pipeline: Background prediction task error: Prediction error: The feature names should match those that were passed during fit.
Feature names unseen at fit time:
- isFraud
]
[2025-07-09 17:03:41,132: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 17:03:41,133: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 17:03:41,133: INFO: common: created directory at: artifacts]
[2025-07-09 17:03:41,134: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-09 17:03:41,134: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 17:03:41,135: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-09 17:03:48,640: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 17:03:48,641: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 17:03:48,642: INFO: common: created directory at: artifacts]
[2025-07-09 17:03:48,642: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-09 17:03:48,642: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 17:03:48,643: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-09 17:03:49,236: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-09 17:03:49,417: INFO: data_ingestion: Loaded dataset with 100000 rows]
[2025-07-09 17:03:49,418: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-09 17:03:49,780: ERROR: predict_pipeline: Background prediction task error: Prediction error: The feature names should match those that were passed during fit.
Feature names unseen at fit time:
- isFraud
]
[2025-07-09 17:03:49,791: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 17:03:49,792: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 17:03:49,793: INFO: common: created directory at: artifacts]
[2025-07-09 17:03:49,793: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-09 17:03:49,794: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 17:03:49,794: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-09 17:04:04,834: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-09 17:04:04,834: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-09 17:04:04,843: INFO: common: created directory at: artifacts]
[2025-07-09 17:04:04,844: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-09 17:04:04,845: INFO: common: created directory at: artifacts/data_version]
[2025-07-09 17:04:04,845: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-09 17:04:05,891: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-09 17:04:06,071: INFO: data_ingestion: Loaded dataset with 100000 rows]
[2025-07-09 17:04:06,071: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-09 17:04:06,682: ERROR: predict_pipeline: Background prediction task error: Prediction error: The feature names should match those that were passed during fit.
Feature names unseen at fit time:
- isFraud
]
[2025-07-10 10:25:59,615: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-10 10:25:59,617: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-10 10:25:59,618: INFO: common: created directory at: artifacts]
[2025-07-10 10:25:59,619: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-10 10:25:59,619: INFO: common: created directory at: artifacts/data_version]
[2025-07-10 10:25:59,620: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-10 10:25:59,624: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-10 10:25:59,625: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-10 10:25:59,625: INFO: common: created directory at: artifacts]
[2025-07-10 10:25:59,626: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-10 10:25:59,626: INFO: common: created directory at: artifacts/data_version]
[2025-07-10 10:25:59,626: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-10 10:25:59,698: INFO: main: 1 change detected]
[2025-07-10 10:26:12,844: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-10 10:26:12,845: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-10 10:26:12,845: INFO: common: created directory at: artifacts]
[2025-07-10 10:26:12,846: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-10 10:26:12,846: INFO: common: created directory at: artifacts/data_version]
[2025-07-10 10:26:12,846: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-10 10:26:13,500: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-10 10:26:13,525: INFO: data_ingestion: Loaded dataset with 10000 rows]
[2025-07-10 10:26:13,526: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFlaggedFraud']]
[2025-07-10 10:26:15,348: INFO: predict_pipeline: Successfully saved prediction results to C:\Users\minh1\AppData\Local\Temp\tmps5cb13bt.csv and logged as MLflow artifact]
[2025-07-10 10:26:15,349: INFO: predict_pipeline: Deleted temporary prediction file: C:\Users\minh1\AppData\Local\Temp\tmps5cb13bt.csv]
[2025-07-10 10:26:15,350: INFO: predict_pipeline: Prediction processing time: 2.51 seconds]
[2025-07-10 10:26:15,350: INFO: predict_pipeline: Started at: 2025-07-10 10:26:12]
[2025-07-10 10:26:15,350: INFO: predict_pipeline: Completed at: 2025-07-10 10:26:15]
[2025-07-10 10:26:18,337: INFO: predict_pipeline: Cleanup: Deleted input file artifacts\data_ingestion\input_raw.csv]
[2025-07-10 10:26:18,412: INFO: main: 1 change detected]
[2025-07-10 10:26:19,023: INFO: main: 1 change detected]
[2025-07-10 13:23:42,150: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-10 13:23:42,153: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-10 13:23:42,154: INFO: common: created directory at: artifacts]
[2025-07-10 13:23:42,154: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-10 13:23:42,155: INFO: common: created directory at: artifacts/data_version]
[2025-07-10 13:23:42,155: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-10 13:23:42,159: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-10 13:23:42,160: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-10 13:23:42,160: INFO: common: created directory at: artifacts]
[2025-07-10 13:23:42,161: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-10 13:23:42,161: INFO: common: created directory at: artifacts/data_version]
[2025-07-10 13:23:42,162: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-10 13:23:42,229: INFO: main: 1 change detected]
[2025-07-10 13:24:00,120: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-10 13:24:00,121: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-10 13:24:00,122: INFO: common: created directory at: artifacts]
[2025-07-10 13:24:00,123: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-10 13:24:00,123: INFO: common: created directory at: artifacts/data_version]
[2025-07-10 13:24:00,124: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-10 13:24:00,772: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-10 13:24:00,792: INFO: data_ingestion: Loaded dataset with 10000 rows]
[2025-07-10 13:24:00,794: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFlaggedFraud']]
[2025-07-10 13:24:02,669: INFO: predict_pipeline: Successfully saved prediction results to C:\Users\minh1\AppData\Local\Temp\tmpzdxlefdi.csv and logged as MLflow artifact]
[2025-07-10 13:24:02,669: INFO: predict_pipeline: Deleted temporary prediction file: C:\Users\minh1\AppData\Local\Temp\tmpzdxlefdi.csv]
[2025-07-10 13:24:02,669: INFO: predict_pipeline: Prediction processing time: 2.55 seconds]
[2025-07-10 13:24:02,669: INFO: predict_pipeline: Started at: 2025-07-10 13:24:00]
[2025-07-10 13:24:02,669: INFO: predict_pipeline: Completed at: 2025-07-10 13:24:02]
[2025-07-10 13:24:05,501: INFO: predict_pipeline: Cleanup: Deleted input file artifacts\data_ingestion\input_raw.csv]
[2025-07-10 13:24:05,599: INFO: main: 1 change detected]
[2025-07-10 13:24:06,815: INFO: main: 1 change detected]
[2025-07-10 14:17:48,960: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-10 14:17:48,961: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-10 14:17:48,962: INFO: common: created directory at: artifacts]
[2025-07-10 14:17:48,962: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-10 14:17:48,963: INFO: common: created directory at: artifacts/data_version]
[2025-07-10 14:17:48,963: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-10 14:17:48,967: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-10 14:17:48,969: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-10 14:17:48,969: INFO: common: created directory at: artifacts]
[2025-07-10 14:17:48,970: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-10 14:17:48,970: INFO: common: created directory at: artifacts/data_version]
[2025-07-10 14:17:48,970: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-10 14:17:49,053: INFO: main: 1 change detected]
[2025-07-10 14:17:52,237: INFO: main: 1 change detected]
[2025-07-10 14:17:57,367: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-10 14:17:57,368: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-10 14:17:57,368: INFO: common: created directory at: artifacts]
[2025-07-10 14:17:57,369: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-10 14:17:57,369: INFO: common: created directory at: artifacts/data_version]
[2025-07-10 14:17:57,369: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-10 14:17:57,943: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-10 14:17:57,962: INFO: data_ingestion: Loaded dataset with 10000 rows]
[2025-07-10 14:17:57,962: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFlaggedFraud']]
[2025-07-10 14:17:59,827: INFO: predict_pipeline: Successfully saved prediction results to C:\Users\minh1\AppData\Local\Temp\tmppi2axx1u.csv and logged as MLflow artifact]
[2025-07-10 14:17:59,828: INFO: predict_pipeline: Deleted temporary prediction file: C:\Users\minh1\AppData\Local\Temp\tmppi2axx1u.csv]
[2025-07-10 14:17:59,832: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-10 14:17:59,832: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-10 14:17:59,834: INFO: common: created directory at: artifacts]
[2025-07-10 14:17:59,836: INFO: configuration: Cloud Storage Push config: {'root_dir': 'artifacts', 'bucket_name': 'databucket231', 'data_version_dir': 'artifacts/data_version', 'evaluation_dir': 'artifacts/evaluation'}]
[2025-07-10 14:17:59,870: INFO: credentials: Found credentials in shared credentials file: ~/.aws/credentials]
[2025-07-10 14:18:00,347: INFO: cloud_storage_push: Ensured directory structure exists for cloud storage push]
[2025-07-10 14:18:00,927: INFO: cloud_storage_push: Bucket 'databucket231' exists and is accessible]
[2025-07-10 14:18:00,928: ERROR: cloud_storage_push: Error uploading prediction file to S3: [WinError 2] The system cannot find the file specified: 'C:\\Users\\minh1\\AppData\\Local\\Temp\\tmppi2axx1u.csv']
[2025-07-10 14:18:00,929: INFO: predict_pipeline: Prediction processing time: 3.57 seconds]
[2025-07-10 14:18:00,929: INFO: predict_pipeline: Started at: 2025-07-10 14:17:57]
[2025-07-10 14:18:00,929: INFO: predict_pipeline: Completed at: 2025-07-10 14:18:00]
[2025-07-10 14:18:06,511: INFO: predict_pipeline: Cleanup: Deleted input file artifacts\data_ingestion\input_raw.csv]
[2025-07-10 14:18:06,589: INFO: main: 1 change detected]
[2025-07-10 14:18:07,763: INFO: main: 1 change detected]
[2025-07-10 14:23:43,758: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-10 14:23:43,760: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-10 14:23:43,761: INFO: common: created directory at: artifacts]
[2025-07-10 14:23:43,761: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-10 14:23:43,762: INFO: common: created directory at: artifacts/data_version]
[2025-07-10 14:23:43,762: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-10 14:23:43,765: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-10 14:23:43,765: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-10 14:23:43,765: INFO: common: created directory at: artifacts]
[2025-07-10 14:23:43,765: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-10 14:23:43,765: INFO: common: created directory at: artifacts/data_version]
[2025-07-10 14:23:43,765: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-10 14:23:43,822: INFO: main: 1 change detected]
[2025-07-10 14:23:47,578: INFO: main: 1 change detected]
[2025-07-10 14:23:51,481: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-10 14:23:51,482: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-10 14:23:51,482: INFO: common: created directory at: artifacts]
[2025-07-10 14:23:51,483: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-10 14:23:51,483: INFO: common: created directory at: artifacts/data_version]
[2025-07-10 14:23:51,484: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-10 14:23:52,085: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-10 14:23:52,114: INFO: data_ingestion: Loaded dataset with 10000 rows]
[2025-07-10 14:23:52,114: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFlaggedFraud']]
[2025-07-10 14:23:53,944: INFO: predict_pipeline: Successfully saved prediction results to C:\Users\minh1\AppData\Local\Temp\tmpgjijk72o.csv and logged as MLflow artifact]
[2025-07-10 14:23:53,949: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-10 14:23:53,950: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-10 14:23:53,951: INFO: common: created directory at: artifacts]
[2025-07-10 14:23:53,953: INFO: configuration: Cloud Storage Push config: {'root_dir': 'artifacts', 'bucket_name': 'databucket231', 'data_version_dir': 'artifacts/data_version', 'evaluation_dir': 'artifacts/evaluation'}]
[2025-07-10 14:23:53,970: INFO: credentials: Found credentials in shared credentials file: ~/.aws/credentials]
[2025-07-10 14:23:54,210: INFO: cloud_storage_push: Ensured directory structure exists for cloud storage push]
[2025-07-10 14:23:54,971: INFO: cloud_storage_push: Bucket 'databucket231' exists and is accessible]
[2025-07-10 14:23:56,048: INFO: predict_pipeline: Deleted temporary prediction file: C:\Users\minh1\AppData\Local\Temp\tmpgjijk72o.csv]
[2025-07-10 14:23:56,048: INFO: predict_pipeline: Prediction processing time: 4.57 seconds]
[2025-07-10 14:23:56,049: INFO: predict_pipeline: Started at: 2025-07-10 14:23:51]
[2025-07-10 14:23:56,049: INFO: predict_pipeline: Completed at: 2025-07-10 14:23:56]
[2025-07-10 14:24:01,367: INFO: predict_pipeline: Cleanup: Deleted input file artifacts\data_ingestion\input_raw.csv]
[2025-07-10 14:24:01,428: INFO: main: 1 change detected]
[2025-07-10 14:24:02,640: INFO: main: 1 change detected]
[2025-07-10 14:51:37,027: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-10 14:51:37,028: INFO: common: created directory at: artifacts]
[2025-07-10 14:51:37,029: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-10 14:51:37,029: INFO: common: created directory at: artifacts/data_version]
[2025-07-10 14:51:37,029: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-10 14:51:37,033: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-10 14:51:37,034: INFO: common: created directory at: artifacts]
[2025-07-10 14:51:37,035: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-10 14:51:37,035: INFO: common: created directory at: artifacts/data_version]
[2025-07-10 14:51:37,035: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-10 14:51:37,121: INFO: main: 1 change detected]
[2025-07-10 14:51:40,159: INFO: main: 1 change detected]
[2025-07-10 14:51:45,252: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-10 14:51:45,252: INFO: common: created directory at: artifacts]
[2025-07-10 14:51:45,252: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-10 14:51:45,252: INFO: common: created directory at: artifacts/data_version]
[2025-07-10 14:51:45,252: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-10 14:51:45,835: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-10 14:51:45,856: INFO: data_ingestion: Loaded dataset with 10000 rows]
[2025-07-10 14:51:45,856: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFlaggedFraud']]
[2025-07-10 14:51:47,689: INFO: predict_pipeline: Successfully saved prediction results to C:\Users\minh1\AppData\Local\Temp\tmpa5jcboad.csv and logged as MLflow artifact]
[2025-07-10 14:51:47,689: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-10 14:51:47,689: INFO: common: created directory at: artifacts]
[2025-07-10 14:51:47,696: INFO: configuration: Cloud Storage Push config: {'root_dir': 'artifacts', 'bucket_name': 'databucket231', 'data_version_dir': 'artifacts/data_version', 'evaluation_dir': 'artifacts/evaluation'}]
[2025-07-10 14:51:47,710: INFO: credentials: Found credentials in shared credentials file: ~/.aws/credentials]
[2025-07-10 14:51:47,932: INFO: cloud_storage_push: Ensured directory structure exists for cloud storage push]
[2025-07-10 14:51:48,620: INFO: cloud_storage_push: Bucket 'databucket231' exists and is accessible]
[2025-07-10 14:51:49,671: INFO: predict_pipeline: Deleted temporary prediction file: C:\Users\minh1\AppData\Local\Temp\tmpa5jcboad.csv]
[2025-07-10 14:51:49,671: INFO: predict_pipeline: Prediction processing time: 4.42 seconds]
[2025-07-10 14:51:49,672: INFO: predict_pipeline: Started at: 2025-07-10 14:51:45]
[2025-07-10 14:51:49,672: INFO: predict_pipeline: Completed at: 2025-07-10 14:51:49]
[2025-07-10 14:51:54,621: INFO: predict_pipeline: Cleanup: Deleted input file artifacts\data_ingestion\input_raw.csv]
[2025-07-10 14:51:54,701: INFO: main: 1 change detected]
[2025-07-10 14:51:57,492: INFO: main: 1 change detected]
[2025-07-10 14:54:25,016: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-10 14:54:25,018: INFO: common: created directory at: artifacts]
[2025-07-10 14:54:25,018: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-10 14:54:25,019: INFO: common: created directory at: artifacts/data_version]
[2025-07-10 14:54:25,019: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-10 14:54:25,023: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-10 14:54:25,023: INFO: common: created directory at: artifacts]
[2025-07-10 14:54:25,024: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-10 14:54:25,025: INFO: common: created directory at: artifacts/data_version]
[2025-07-10 14:54:25,025: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-10 14:54:25,084: INFO: main: 1 change detected]
[2025-07-10 14:54:32,677: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-10 14:54:32,677: INFO: common: created directory at: artifacts]
[2025-07-10 14:54:32,684: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-10 14:54:32,684: INFO: common: created directory at: artifacts/data_version]
[2025-07-10 14:54:32,685: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-10 14:54:32,744: INFO: main: 1 change detected]
[2025-07-10 14:54:33,326: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-10 14:54:33,347: INFO: data_ingestion: Loaded dataset with 10000 rows]
[2025-07-10 14:54:33,347: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFlaggedFraud']]
[2025-07-10 14:54:35,157: INFO: predict_pipeline: Successfully saved prediction results to C:\Users\minh1\AppData\Local\Temp\tmp9mac4hx2.csv and logged as MLflow artifact]
[2025-07-10 14:54:35,162: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-10 14:54:35,162: INFO: common: created directory at: artifacts]
[2025-07-10 14:54:35,165: INFO: configuration: Cloud Storage Push config: {'root_dir': 'artifacts', 'bucket_name': 'databucket231', 'data_version_dir': 'artifacts/data_version', 'evaluation_dir': 'artifacts/evaluation'}]
[2025-07-10 14:54:35,180: INFO: credentials: Found credentials in shared credentials file: ~/.aws/credentials]
[2025-07-10 14:54:35,409: INFO: cloud_storage_push: Ensured directory structure exists for cloud storage push]
[2025-07-10 14:54:36,060: INFO: cloud_storage_push: Bucket 'databucket231' exists and is accessible]
[2025-07-10 14:54:37,102: INFO: predict_pipeline: Deleted temporary prediction file: C:\Users\minh1\AppData\Local\Temp\tmp9mac4hx2.csv]
[2025-07-10 14:54:37,102: INFO: predict_pipeline: Prediction processing time: 4.42 seconds]
[2025-07-10 14:54:37,102: INFO: predict_pipeline: Started at: 2025-07-10 14:54:32]
[2025-07-10 14:54:37,102: INFO: predict_pipeline: Completed at: 2025-07-10 14:54:37]
[2025-07-10 14:54:42,573: INFO: predict_pipeline: Cleanup: Deleted input file artifacts\data_ingestion\input_raw.csv]
[2025-07-10 14:54:42,643: INFO: main: 1 change detected]
[2025-07-10 14:54:59,492: INFO: main: 1 change detected]
[2025-07-10 15:54:49,116: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-10 15:54:49,117: INFO: common: created directory at: artifacts]
[2025-07-10 15:54:49,118: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-10 15:54:49,118: INFO: common: created directory at: artifacts/data_version]
[2025-07-10 15:54:49,119: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-10 15:54:49,123: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-10 15:54:49,124: INFO: common: created directory at: artifacts]
[2025-07-10 15:54:49,125: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-10 15:54:49,125: INFO: common: created directory at: artifacts/data_version]
[2025-07-10 15:54:49,125: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-10 15:54:49,209: INFO: main: 1 change detected]
[2025-07-10 15:54:50,880: INFO: main: 1 change detected]
[2025-07-10 15:54:57,713: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-10 15:54:57,714: INFO: common: created directory at: artifacts]
[2025-07-10 15:54:57,714: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-10 15:54:57,715: INFO: common: created directory at: artifacts/data_version]
[2025-07-10 15:54:57,715: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-10 15:54:58,297: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-10 15:54:58,318: INFO: data_ingestion: Loaded dataset with 10000 rows]
[2025-07-10 15:54:58,318: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFlaggedFraud']]
[2025-07-10 15:55:00,228: INFO: predict_compo: Successfully saved prediction results to C:\Users\minh1\AppData\Local\Temp\tmp72ile_zx.csv and logged as MLflow artifact]
[2025-07-10 15:55:00,233: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-10 15:55:00,234: INFO: common: created directory at: artifacts]
[2025-07-10 15:55:00,236: INFO: configuration: Cloud Storage Push config: {'root_dir': 'artifacts', 'bucket_name': 'databucket231', 'data_version_dir': 'artifacts/data_version', 'evaluation_dir': 'artifacts/evaluation'}]
[2025-07-10 15:55:00,250: INFO: credentials: Found credentials in shared credentials file: ~/.aws/credentials]
[2025-07-10 15:55:00,480: INFO: cloud_storage_push: Ensured directory structure exists for cloud storage push]
[2025-07-10 15:55:01,185: INFO: cloud_storage_push: Bucket 'databucket231' exists and is accessible]
[2025-07-10 15:55:02,366: INFO: predict_compo: Deleted temporary prediction file: C:\Users\minh1\AppData\Local\Temp\tmp72ile_zx.csv]
[2025-07-10 15:55:02,366: INFO: predict_compo: Prediction processing time: 4.66 seconds]
[2025-07-10 15:55:02,367: INFO: predict_compo: Started at: 2025-07-10 15:54:57]
[2025-07-10 15:55:02,367: INFO: predict_compo: Completed at: 2025-07-10 15:55:02]
[2025-07-10 15:55:06,677: INFO: predict_compo: Cleanup: Deleted input file artifacts\data_ingestion\input_raw.csv]
[2025-07-10 15:55:06,751: INFO: main: 1 change detected]
[2025-07-10 15:55:07,968: INFO: main: 1 change detected]
[2025-07-11 10:04:57,199: INFO: main: 5 changes detected]
[2025-07-11 10:05:13,339: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-11 10:05:13,342: INFO: common: created directory at: artifacts]
[2025-07-11 10:05:13,342: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-11 10:05:13,343: INFO: common: created directory at: artifacts/data_version]
[2025-07-11 10:05:13,343: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-11 10:05:13,343: INFO: training_pipeline: Data file not found or empty: artifacts\data_ingestion\input_raw.csv]
[2025-07-11 10:05:53,189: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-11 10:05:53,189: INFO: common: created directory at: artifacts]
[2025-07-11 10:05:53,190: INFO: configuration: MLFlow configuration: MLFlowConfig(dagshub_username='minh120103', dagshub_repo_name='E2E_ML', tracking_uri='https://dagshub.com/minh120103/E2E_ML.mlflow', experiment_name='Fraud_Detection_Experiment')]
[2025-07-11 10:05:53,190: INFO: training_pipeline: MLflow configured with experiment: Fraud_Detection_Experiment]
[2025-07-11 10:05:53,583: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/user "HTTP/1.1 200 OK"]
[2025-07-11 10:05:53,591: INFO: helpers: Accessing as minh120103]
[2025-07-11 10:05:53,955: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/repos/minh120103/E2E_ML "HTTP/1.1 200 OK"]
[2025-07-11 10:05:54,304: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/user "HTTP/1.1 200 OK"]
[2025-07-11 10:05:54,305: INFO: helpers: Initialized MLflow to track repo "minh120103/E2E_ML"]
[2025-07-11 10:05:54,305: INFO: helpers: Repository minh120103/E2E_ML initialized!]
[2025-07-11 10:05:54,732: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-11 10:05:54,732: INFO: common: created directory at: artifacts/data_version]
[2025-07-11 10:05:54,733: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-11 10:05:54,733: INFO: training_pipeline: Data file not found or empty: artifacts\data_ingestion\input_raw.csv]
[2025-07-11 10:05:54,734: INFO: training_pipeline: ==================================================]
[2025-07-11 10:05:54,734: INFO: training_pipeline: STAGE 0: Data Import]
[2025-07-11 10:05:54,734: INFO: training_pipeline: ==================================================]
[2025-07-11 10:05:54,736: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-11 10:05:54,739: INFO: common: created directory at: artifacts]
[2025-07-11 10:05:54,740: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-11 10:05:54,740: INFO: common: created directory at: artifacts/data_version]
[2025-07-11 10:05:54,741: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-11 10:05:54,794: INFO: main: 1 change detected]
[2025-07-11 10:05:54,929: INFO: training_pipeline: Data import completed successfully]
[2025-07-11 10:05:54,929: INFO: training_pipeline: >>>>>> stage Data Ingestion started <<<<<<]
[2025-07-11 10:05:54,929: INFO: preprocess_data: >>> Stage Data Ingestion stage started <<<]
[2025-07-11 10:05:54,934: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-11 10:05:54,934: INFO: common: created directory at: artifacts]
[2025-07-11 10:05:54,935: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-11 10:05:54,936: INFO: common: created directory at: artifacts/data_version]
[2025-07-11 10:05:54,936: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-11 10:05:54,937: INFO: data_ingestion: Initiating data ingestion]
[2025-07-11 10:05:54,937: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-11 10:05:55,103: INFO: data_ingestion: Loaded dataset with 100000 rows]
[2025-07-11 10:05:55,103: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-11 10:05:55,103: INFO: data_ingestion: Starting preprocessing of 100000 rows...]
[2025-07-11 10:05:55,104: INFO: data_ingestion: Initial columns: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-11 10:05:55,149: INFO: main: 1 change detected]
[2025-07-11 10:05:55,153: INFO: data_ingestion: After feature engineering columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-11 10:05:55,154: INFO: data_ingestion: Data shape after feature engineering: (100000, 12)]
[2025-07-11 10:05:55,170: INFO: data_ingestion: First few rows of feature engineered data: 
   step      amount  oldbalanceOrg  oldbalanceDest  isFraud  ...  type_CASH_IN  type_CASH_OUT  type_DEBIT  type_PAYMENT  type_TRANSFER
0   278   330218.42       20866.00       452419.57        0  ...             1              0           0             0              0
1    15    11647.08       30370.00            0.00        0  ...             0              0           0             1              0
2    10   152264.21      106589.00       201303.01        0  ...             1              0           0             0              0
3   403  1551760.63           0.00      3198359.45        0  ...             0              0           0             0              1
4   206    78172.30     2921331.58       415821.90        0  ...             1              0           0             0              0

[5 rows x 12 columns]]
[2025-07-11 10:05:55,171: INFO: data_ingestion: After encoding columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-11 10:05:55,171: INFO: data_ingestion: Data shape after encoding: (100000, 12)]
[2025-07-11 10:05:55,180: INFO: data_ingestion: Data shape after removing NaN: (100000, 12)]
[2025-07-11 10:05:55,183: INFO: data_ingestion: X shape (features): (100000, 11)]
[2025-07-11 10:05:55,183: INFO: data_ingestion: y shape (target): (100000,)]
[2025-07-11 10:05:55,183: INFO: data_ingestion: Target variable shape: (100000,)]
[2025-07-11 10:05:55,184: INFO: data_ingestion: NaN count in target: 0]
[2025-07-11 10:05:55,187: INFO: data_ingestion: Target variable distribution: 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-11 10:05:55,189: INFO: data_ingestion: Final feature matrix shape: (100000, 11)]
[2025-07-11 10:05:55,189: INFO: data_ingestion: Final target vector shape: (100000,)]
[2025-07-11 10:05:55,191: INFO: data_ingestion: Target variable distribution (normalized): 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-11 10:05:55,192: INFO: data_ingestion: Target variable is imbalanced. Applying SMOTE...]
[2025-07-11 10:05:55,261: INFO: data_ingestion: Resampled feature matrix shape: (199718, 11)]
[2025-07-11 10:05:55,263: INFO: data_ingestion: Resampled target distribution: 
isFraud
0    99859
1    99859
Name: count, dtype: int64]
[2025-07-11 10:05:55,502: INFO: main: 1 change detected]
[2025-07-11 10:05:55,861: INFO: main: 1 change detected]
[2025-07-11 10:05:56,215: INFO: main: 3 changes detected]
[2025-07-11 10:05:56,574: INFO: main: 2 changes detected]
[2025-07-11 10:05:56,936: INFO: main: 1 change detected]
[2025-07-11 10:05:56,987: INFO: data_ingestion: Created versioned input data file: artifacts\data_version\input_raw_data_version_20250711T100554.csv]
[2025-07-11 10:05:56,987: INFO: data_ingestion: Created versioned processed data file: artifacts\data_version\processed_data_version_20250711T100554.csv]
[2025-07-11 10:05:56,988: INFO: data_ingestion: Created versioned feature engineered data file: artifacts\data_version\featured_data_version_20250711T100554.csv]
[2025-07-11 10:05:56,988: INFO: data_ingestion: Splitting data into train and test sets]
[2025-07-11 10:05:57,026: INFO: data_ingestion: Train data: (159774, 11), Test data: (39944, 11)]
[2025-07-11 10:05:57,027: INFO: data_ingestion: Data ingestion completed successfully]
[2025-07-11 10:05:57,027: INFO: data_ingestion: Data shape - Train: (159774, 11), Test: (39944, 11)]
[2025-07-11 10:05:57,031: INFO: preprocess_data: >>> Stage Data Ingestion stage completed <<<]
[2025-07-11 10:05:57,035: INFO: training_pipeline: >>>>>> stage Data Ingestion completed <<<<<<

x====================x]
[2025-07-11 10:05:57,035: INFO: training_pipeline: >>>>>> stage Model Training Pipeline started <<<<<<]
[2025-07-11 10:05:57,039: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-11 10:05:57,040: INFO: common: created directory at: artifacts]
[2025-07-11 10:05:57,040: INFO: configuration: MLFlow configuration: MLFlowConfig(dagshub_username='minh120103', dagshub_repo_name='E2E_ML', tracking_uri='https://dagshub.com/minh120103/E2E_ML.mlflow', experiment_name='Fraud_Detection_Experiment')]
[2025-07-11 10:05:57,299: INFO: main: 1 change detected]
[2025-07-11 10:05:57,422: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/repos/minh120103/E2E_ML "HTTP/1.1 200 OK"]
[2025-07-11 10:05:57,448: INFO: helpers: Initialized MLflow to track repo "minh120103/E2E_ML"]
[2025-07-11 10:05:57,448: INFO: helpers: Repository minh120103/E2E_ML initialized!]
[2025-07-11 10:05:58,332: INFO: training_pipeline: ==================================================]
[2025-07-11 10:05:58,332: INFO: training_pipeline: Running Model Preparation]
[2025-07-11 10:05:58,333: INFO: prepare_model: >>> Stage Prepare base model started <<<]
[2025-07-11 10:05:58,339: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-11 10:05:58,339: INFO: common: created directory at: artifacts]
[2025-07-11 10:05:58,340: INFO: common: created directory at: artifacts/model_version]
[2025-07-11 10:05:58,340: INFO: common: created directory at: artifacts/data_version]
[2025-07-11 10:05:58,341: INFO: configuration: Prepare base model config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'objective': 'binary:logistic', 'max_depth': 6, 'n_estimators': 300, 'random_state': 42, 'learning_rate': 0.1, 'scale_pos_weight': 10, 'n_jobs': -1}]
[2025-07-11 10:05:58,426: INFO: main: 1 change detected]
[2025-07-11 10:05:58,688: INFO: base_model: Creating base model and scaler]
[2025-07-11 10:05:58,689: INFO: base_model: Creating base XGBoost model]
[2025-07-11 10:05:58,689: INFO: base_model: Model params:300, 42, 0.1, 6, 10, -1]
[2025-07-11 10:05:58,689: INFO: base_model: Creating scaler from training data]
[2025-07-11 10:05:58,769: INFO: base_model: Base model saved: artifacts\model_version\base_model_churn_20250711T100558.pkl]
[2025-07-11 10:05:58,834: INFO: main: 3 changes detected]
[2025-07-11 10:06:00,085: INFO: prepare_model: >>> Stage Prepare base model completed <<<]
[2025-07-11 10:06:00,086: INFO: training_pipeline: Base model created at: artifacts\model_version\base_model_churn_20250711T100558.pkl]
[2025-07-11 10:06:00,086: INFO: training_pipeline: Scaler created at: artifacts\model_version\scaler_churn_version_20250711T100558.pkl]
[2025-07-11 10:06:00,087: INFO: training_pipeline: ==================================================]
[2025-07-11 10:06:00,087: INFO: training_pipeline: ==================================================]
[2025-07-11 10:06:00,088: INFO: training_pipeline: Running Model Training and Evaluation]
[2025-07-11 10:06:00,088: INFO: train_evaluation: >>> Stage TRAIN_AND_EVALUATE_MODEL started <<<]
[2025-07-11 10:06:00,092: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-11 10:06:00,093: INFO: common: created directory at: artifacts]
[2025-07-11 10:06:00,093: INFO: common: created directory at: artifacts/model_version]
[2025-07-11 10:06:00,094: INFO: common: created directory at: artifacts/data_version]
[2025-07-11 10:06:00,094: INFO: configuration: Training config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version'}]
[2025-07-11 10:06:00,099: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-11 10:06:00,100: INFO: common: created directory at: artifacts]
[2025-07-11 10:06:00,100: INFO: common: created directory at: artifacts/evaluation]
[2025-07-11 10:06:00,101: INFO: common: created directory at: artifacts/model_version]
[2025-07-11 10:06:00,101: INFO: common: created directory at: artifacts/data_version]
[2025-07-11 10:06:00,101: INFO: configuration: Evaluation config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'evaluation_dir': 'artifacts/evaluation'}]
[2025-07-11 10:06:00,102: INFO: model_training: Initiating model training and evaluation with temporary directory management]
[2025-07-11 10:06:00,102: INFO: model_training: Loaded y_train shape: (159774,)]
[2025-07-11 10:06:00,102: INFO: model_training: Loaded y_test shape: (39944,)]
[2025-07-11 10:06:00,103: INFO: model_training: NaN count in y_train: 0]
[2025-07-11 10:06:00,103: INFO: model_training: NaN count in y_test: 0]
[2025-07-11 10:06:00,104: INFO: model_training: Final X_train_scaled shape: (159774, 11)]
[2025-07-11 10:06:00,104: INFO: model_training: Final y_train shape: (159774,)]
[2025-07-11 10:06:00,104: INFO: model_training: Final X_test_scaled shape: (39944, 11)]
[2025-07-11 10:06:00,104: INFO: model_training: Final y_test shape: (39944,)]
[2025-07-11 10:06:00,109: INFO: model_training: Loading model: XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              feature_weights=None, gamma=None, grow_policy=None,
              importance_type=None, interaction_constraints=None,
              learning_rate=0.1, max_bin=None, max_cat_threshold=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=6,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, multi_strategy=None, n_estimators=300,
              n_jobs=-1, num_parallel_tree=None, ...)]
[2025-07-11 10:06:00,110: INFO: model_training: Starting model training for model_fraud_20250711T100600]
[2025-07-11 10:06:01,058: INFO: model_training: Model training for model_fraud_20250711T100600 completed]
[2025-07-11 10:06:01,078: INFO: model_training:   trained model file (for future use): artifacts\model_version\model_churn_version_20250711T100600.pkl]
[2025-07-11 10:06:01,128: INFO: main: 1 change detected]
[2025-07-11 10:06:01,478: INFO: model_training: Model accuracy on test data: 0.9981974764670539]
[2025-07-11 10:06:01,478: INFO: model_training: Model accuracy is 85% or above, not needed finetuned, log trained model to mlflow]
[2025-07-11 10:06:01,488: INFO: model_training: Logging model to MLflow as model_fraud_20250711T100600]
[2025-07-11 10:06:25,324: INFO: model_training: Successfully registered model under unique name: XGBoost]
[2025-07-11 10:06:25,325: INFO: model_training: Performing detailed evaluation on test data]
[2025-07-11 10:06:25,478: INFO: common: json file saved at: artifacts\evaluation\metrics_20250711T100600.json]
[2025-07-11 10:06:25,478: INFO: model_training: Detailed metrics saved to: artifacts\evaluation\metrics_20250711T100600.json]
[2025-07-11 10:06:25,561: INFO: main: 1 change detected]
[2025-07-11 10:06:38,054: INFO: model_training: Creating confusion matrix plot]
[2025-07-11 10:06:38,353: INFO: model_training: Confusion matrix saved to: artifacts\evaluation\confusion_matrix_20250711T100600.png]
[2025-07-11 10:06:38,408: INFO: main: 1 change detected]
[2025-07-11 10:06:38,916: INFO: model_training: Creating Precision-Recall curve plot]
[2025-07-11 10:06:39,054: INFO: model_training: Precision-Recall curve saved to: artifacts\evaluation\precision_recall_curve_20250711T100600.png]
[2025-07-11 10:06:39,079: INFO: main: 2 changes detected]
[2025-07-11 10:06:39,940: INFO: model_training: Creating ROC curve plot]
[2025-07-11 10:06:40,070: INFO: model_training: ROC curve saved to: artifacts\evaluation\roc_curve_20250711T100600.png]
[2025-07-11 10:06:40,098: INFO: main: 2 changes detected]
[2025-07-11 10:06:40,913: INFO: train_evaluation: >>> Stage TRAIN_AND_EVALUATE_MODEL completed <<<]
[2025-07-11 10:06:40,913: INFO: training_pipeline: Training and evaluation completed. Final model at: artifacts\model_version\model_churn_version_20250711T100600.pkl]
[2025-07-11 10:06:40,913: INFO: training_pipeline: Logged Metrics: {'precision': 0.9964678374210238, 'recall': 0.9999500773800609, 'f1_score': 0.9982059204624738, 'roc_auc': 0.9999928674808555, 'mcc': 0.9964010044780308, 'avg_precision': 0.9999927418432609, 'classification_report': {'0': {'precision': 0.9999496043944968, 'recall': 0.9964344900316376, 'f1-score': 0.9981889526109267, 'support': 19913.0}, '1': {'precision': 0.9964678374210238, 'recall': 0.9999500773800609, 'f1-score': 0.9982059204624738, 'support': 20031.0}, 'accuracy': 0.9981974764670539, 'macro avg': {'precision': 0.9982087209077604, 'recall': 0.9981922837058492, 'f1-score': 0.9981974365367002, 'support': 39944.0}, 'weighted avg': {'precision': 0.9982035781015458, 'recall': 0.9981974764670539, 'f1-score': 0.998197461599369, 'support': 39944.0}}}]
[2025-07-11 10:06:40,913: INFO: training_pipeline: ==================================================]
[2025-07-11 10:06:41,781: INFO: training_pipeline: >>>>>> stage Model Training Pipeline completed <<<<<<

x====================x]
[2025-07-11 10:06:41,781: INFO: training_pipeline: >>>>>> stage STAGE 4: Cloud Storage Push started <<<<<<]
[2025-07-11 10:06:41,781: INFO: training_pipeline: ==================================================]
[2025-07-11 10:06:41,781: INFO: training_pipeline: STAGE 4: Cloud Storage Push]
[2025-07-11 10:06:41,781: INFO: training_pipeline: ==================================================]
[2025-07-11 10:06:41,781: INFO: cloud_storage_push: >>> Stage Cloud Storage Push started <<<]
[2025-07-11 10:06:41,796: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-11 10:06:41,796: INFO: common: created directory at: artifacts]
[2025-07-11 10:06:41,803: INFO: configuration: Cloud Storage Push config: {'root_dir': 'artifacts', 'bucket_name': 'databucket231', 'data_version_dir': 'artifacts/data_version', 'evaluation_dir': 'artifacts/evaluation'}]
[2025-07-11 10:06:41,835: INFO: credentials: Found credentials in shared credentials file: ~/.aws/credentials]
[2025-07-11 10:06:42,304: INFO: cloud_storage_push: Ensured directory structure exists for cloud storage push]
[2025-07-11 10:06:42,371: INFO: main: 1 change detected]
[2025-07-11 10:06:43,053: INFO: cloud_storage_push: Bucket 'databucket231' exists and is accessible]
[2025-07-11 10:07:56,029: INFO: cloud_storage_push: Starting cloud storage push process...]
[2025-07-11 10:07:56,190: INFO: cloud_storage_push: Bucket 'databucket231' exists and is accessible]
[2025-07-11 10:07:56,190: INFO: cloud_storage_push: Found 21 files to upload to cloud storage.]
[2025-07-11 10:08:31,514: INFO: cloud_storage_push: Uploaded artifacts\data_version\processed_data_version_20250709T152646.csv to bucket databucket231.]
[2025-07-11 10:08:36,762: INFO: cloud_storage_push: Uploaded artifacts\data_version\featured_data_version_20250709T152646.csv to bucket databucket231.]
[2025-07-11 10:08:37,443: INFO: cloud_storage_push: Uploaded artifacts\evaluation\confusion_matrix_20250709T152652.png to bucket databucket231.]
[2025-07-11 10:08:38,262: INFO: cloud_storage_push: Uploaded artifacts\evaluation\confusion_matrix_20250709T161421.png to bucket databucket231.]
[2025-07-11 10:08:38,749: INFO: cloud_storage_push: Uploaded artifacts\evaluation\confusion_matrix_20250711T100600.png to bucket databucket231.]
[2025-07-11 10:08:39,233: INFO: cloud_storage_push: Uploaded artifacts\evaluation\metrics_20250709T152652.json to bucket databucket231.]
[2025-07-11 10:08:39,735: INFO: cloud_storage_push: Uploaded artifacts\evaluation\metrics_20250709T161421.json to bucket databucket231.]
[2025-07-11 10:08:40,222: INFO: cloud_storage_push: Uploaded artifacts\evaluation\metrics_20250711T100600.json to bucket databucket231.]
[2025-07-11 10:08:40,768: INFO: cloud_storage_push: Uploaded artifacts\evaluation\precision_recall_curve_20250709T152652.png to bucket databucket231.]
[2025-07-11 10:08:41,304: INFO: cloud_storage_push: Uploaded artifacts\evaluation\precision_recall_curve_20250709T161421.png to bucket databucket231.]
[2025-07-11 10:08:42,982: INFO: cloud_storage_push: Uploaded artifacts\evaluation\precision_recall_curve_20250711T100600.png to bucket databucket231.]
[2025-07-11 10:08:43,047: INFO: cloud_storage_push: Uploaded artifacts\data_version\processed_data_version_20250709T161415.csv to bucket databucket231.]
[2025-07-11 10:08:43,522: INFO: cloud_storage_push: Uploaded artifacts\evaluation\roc_curve_20250709T161421.png to bucket databucket231.]
[2025-07-11 10:08:43,673: INFO: cloud_storage_push: Uploaded artifacts\evaluation\roc_curve_20250709T152652.png to bucket databucket231.]
[2025-07-11 10:08:44,135: INFO: cloud_storage_push: Uploaded artifacts\evaluation\roc_curve_20250711T100600.png to bucket databucket231.]
[2025-07-11 10:08:46,594: INFO: cloud_storage_push: Uploaded artifacts\data_version\input_raw_data_version_20250709T161415.csv to bucket databucket231.]
[2025-07-11 10:08:50,576: INFO: cloud_storage_push: Uploaded artifacts\data_version\input_raw_data_version_20250711T100554.csv to bucket databucket231.]
[2025-07-11 10:08:51,179: INFO: cloud_storage_push: Uploaded artifacts\data_version\featured_data_version_20250711T100554.csv to bucket databucket231.]
[2025-07-11 10:08:52,615: INFO: cloud_storage_push: Uploaded artifacts\data_version\featured_data_version_20250709T161415.csv to bucket databucket231.]
[2025-07-11 10:08:55,257: INFO: cloud_storage_push: Uploaded artifacts\data_version\input_raw_data_version_20250709T152646.csv to bucket databucket231.]
[2025-07-11 10:08:55,713: WARNING: connectionpool: Connection pool is full, discarding connection: databucket231.s3.ap-southeast-2.amazonaws.com. Connection pool size: 10]
[2025-07-11 10:08:55,713: INFO: cloud_storage_push: Uploaded artifacts\data_version\processed_data_version_20250711T100554.csv to bucket databucket231.]
[2025-07-11 10:08:55,713: INFO: cloud_storage_push: Successfully uploaded 21 files to S3 bucket: databucket231]
[2025-07-11 10:08:55,713: INFO: cloud_storage_push: >>> Stage Cloud Storage Push completed <<<]
[2025-07-11 10:08:55,713: INFO: training_pipeline: Cloud storage push completed successfully]
[2025-07-11 10:08:55,713: INFO: training_pipeline: >>>>>> stage STAGE 4: Cloud Storage Push completed <<<<<<

x====================x]
[2025-07-11 10:08:55,713: INFO: clean_up: ==================================================]
[2025-07-11 10:08:55,713: INFO: clean_up: CLEANUP: Removing temporary versioned files]
[2025-07-11 10:08:55,713: INFO: clean_up: ==================================================]
[2025-07-11 10:08:55,713: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-11 10:08:55,713: INFO: common: created directory at: artifacts]
[2025-07-11 10:08:55,713: INFO: clean_up: Found 9 timestamp-versioned data files to clean]
[2025-07-11 10:08:55,725: INFO: clean_up: Deleted temporary file: featured_data_version_20250709T152646.csv]
[2025-07-11 10:08:55,727: INFO: clean_up: Deleted temporary file: featured_data_version_20250709T161415.csv]
[2025-07-11 10:08:55,728: INFO: clean_up: Deleted temporary file: featured_data_version_20250711T100554.csv]
[2025-07-11 10:08:55,730: INFO: clean_up: Deleted temporary file: input_raw_data_version_20250709T152646.csv]
[2025-07-11 10:08:55,731: INFO: clean_up: Deleted temporary file: input_raw_data_version_20250709T161415.csv]
[2025-07-11 10:08:55,732: INFO: clean_up: Deleted temporary file: input_raw_data_version_20250711T100554.csv]
[2025-07-11 10:08:55,732: INFO: clean_up: Deleted temporary file: processed_data_version_20250709T152646.csv]
[2025-07-11 10:08:55,736: INFO: clean_up: Deleted temporary file: processed_data_version_20250709T161415.csv]
[2025-07-11 10:08:55,737: INFO: clean_up: Deleted temporary file: processed_data_version_20250711T100554.csv]
[2025-07-11 10:08:55,738: INFO: clean_up: Found 12 timestamp-versioned evaluation files to clean]
[2025-07-11 10:08:55,739: INFO: clean_up: Deleted temporary file: metrics_20250709T152652.json]
[2025-07-11 10:08:55,739: INFO: clean_up: Deleted temporary file: metrics_20250709T161421.json]
[2025-07-11 10:08:55,739: INFO: clean_up: Deleted temporary file: metrics_20250711T100600.json]
[2025-07-11 10:08:55,740: INFO: clean_up: Deleted temporary file: confusion_matrix_20250709T152652.png]
[2025-07-11 10:08:55,740: INFO: clean_up: Deleted temporary file: confusion_matrix_20250709T161421.png]
[2025-07-11 10:08:55,741: INFO: clean_up: Deleted temporary file: confusion_matrix_20250711T100600.png]
[2025-07-11 10:08:55,742: INFO: clean_up: Deleted temporary file: precision_recall_curve_20250709T152652.png]
[2025-07-11 10:08:55,742: INFO: clean_up: Deleted temporary file: precision_recall_curve_20250709T161421.png]
[2025-07-11 10:08:55,743: INFO: clean_up: Deleted temporary file: precision_recall_curve_20250711T100600.png]
[2025-07-11 10:08:55,743: INFO: clean_up: Deleted temporary file: roc_curve_20250709T152652.png]
[2025-07-11 10:08:55,744: INFO: clean_up: Deleted temporary file: roc_curve_20250709T161421.png]
[2025-07-11 10:08:55,744: INFO: clean_up: Deleted temporary file: roc_curve_20250711T100600.png]
[2025-07-11 10:08:55,746: INFO: clean_up: Deleted temporary file: input_raw.csv]
[2025-07-11 10:08:55,746: INFO: clean_up: Kept 0 essential data files for DVC tracking]
[2025-07-11 10:08:55,747: INFO: clean_up: Kept 0 essential evaluation files for DVC tracking]
[2025-07-11 10:08:55,798: INFO: main: 24 changes detected]
[2025-07-11 10:08:57,009: INFO: main: 1 change detected]
[2025-07-11 10:09:28,838: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-11 10:09:28,839: INFO: common: created directory at: artifacts]
[2025-07-11 10:09:28,839: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-11 10:09:28,840: INFO: common: created directory at: artifacts/data_version]
[2025-07-11 10:09:28,840: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-11 10:09:28,844: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-11 10:09:28,845: INFO: common: created directory at: artifacts]
[2025-07-11 10:09:28,845: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-11 10:09:28,846: INFO: common: created directory at: artifacts/data_version]
[2025-07-11 10:09:28,846: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-11 10:09:29,052: INFO: main: 1 change detected]
[2025-07-11 10:09:31,480: INFO: main: 1 change detected]
[2025-07-11 10:09:34,352: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-11 10:09:34,352: INFO: common: created directory at: artifacts]
[2025-07-11 10:09:34,352: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-11 10:09:34,352: INFO: common: created directory at: artifacts/data_version]
[2025-07-11 10:09:34,352: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-11 10:09:35,186: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-11 10:09:35,201: INFO: data_ingestion: Loaded dataset with 10000 rows]
[2025-07-11 10:09:35,201: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFlaggedFraud']]
[2025-07-11 10:09:37,576: INFO: predict_compo: Successfully saved prediction results to C:\Users\minh1\AppData\Local\Temp\tmpxunuuo62.csv and logged as MLflow artifact]
[2025-07-11 10:09:37,581: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-11 10:09:37,582: INFO: common: created directory at: artifacts]
[2025-07-11 10:09:37,582: INFO: configuration: Cloud Storage Push config: {'root_dir': 'artifacts', 'bucket_name': 'databucket231', 'data_version_dir': 'artifacts/data_version', 'evaluation_dir': 'artifacts/evaluation'}]
[2025-07-11 10:09:37,589: INFO: cloud_storage_push: Ensured directory structure exists for cloud storage push]
[2025-07-11 10:09:38,282: INFO: cloud_storage_push: Bucket 'databucket231' exists and is accessible]
[2025-07-11 10:09:39,374: INFO: predict_compo: Deleted temporary prediction file: C:\Users\minh1\AppData\Local\Temp\tmpxunuuo62.csv]
[2025-07-11 10:09:39,374: INFO: predict_compo: Prediction processing time: 5.04 seconds]
[2025-07-11 10:09:39,374: INFO: predict_compo: Started at: 2025-07-11 10:09:34]
[2025-07-11 10:09:39,374: INFO: predict_compo: Completed at: 2025-07-11 10:09:39]
[2025-07-11 10:09:46,181: INFO: predict_compo: Cleanup: Deleted input file artifacts\data_ingestion\input_raw.csv]
[2025-07-11 10:09:46,246: INFO: main: 1 change detected]
[2025-07-11 10:09:47,465: INFO: main: 1 change detected]
[2025-07-11 10:22:43,234: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-11 10:22:43,234: INFO: common: created directory at: artifacts]
[2025-07-11 10:22:43,234: INFO: configuration: MLFlow configuration: MLFlowConfig(dagshub_username='minh120103', dagshub_repo_name='E2E_ML', tracking_uri='https://dagshub.com/minh120103/E2E_ML.mlflow', experiment_name='Fraud_Detection_Experiment')]
[2025-07-11 10:22:43,234: INFO: training_pipeline: MLflow configured with experiment: Fraud_Detection_Experiment]
[2025-07-11 10:22:43,793: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/user "HTTP/1.1 200 OK"]
[2025-07-11 10:22:43,798: INFO: helpers: Accessing as minh120103]
[2025-07-11 10:22:44,284: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/repos/minh120103/E2E_ML "HTTP/1.1 200 OK"]
[2025-07-11 10:22:44,720: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/user "HTTP/1.1 200 OK"]
[2025-07-11 10:22:44,721: INFO: helpers: Initialized MLflow to track repo "minh120103/E2E_ML"]
[2025-07-11 10:22:44,721: INFO: helpers: Repository minh120103/E2E_ML initialized!]
[2025-07-11 10:22:45,211: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-11 10:22:45,212: INFO: common: created directory at: artifacts/data_version]
[2025-07-11 10:22:45,212: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-11 10:22:45,213: INFO: training_pipeline: Data file not found or empty: artifacts\data_ingestion\input_raw.csv]
[2025-07-11 10:22:45,213: INFO: training_pipeline: ==================================================]
[2025-07-11 10:22:45,213: INFO: training_pipeline: STAGE 0: Data Import]
[2025-07-11 10:22:45,214: INFO: training_pipeline: ==================================================]
[2025-07-11 10:22:45,218: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-11 10:22:45,219: INFO: common: created directory at: artifacts]
[2025-07-11 10:22:45,219: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-11 10:22:45,220: INFO: common: created directory at: artifacts/data_version]
[2025-07-11 10:22:45,220: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-11 10:22:45,304: INFO: main: 1 change detected]
[2025-07-11 10:22:45,408: INFO: training_pipeline: Data import completed successfully]
[2025-07-11 10:22:45,409: INFO: training_pipeline: >>>>>> stage Data Ingestion started <<<<<<]
[2025-07-11 10:22:45,409: INFO: preprocess_data: >>> Stage Data Ingestion stage started <<<]
[2025-07-11 10:22:45,413: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-11 10:22:45,414: INFO: common: created directory at: artifacts]
[2025-07-11 10:22:45,415: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-11 10:22:45,415: INFO: common: created directory at: artifacts/data_version]
[2025-07-11 10:22:45,416: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-11 10:22:45,416: INFO: data_ingestion: Initiating data ingestion]
[2025-07-11 10:22:45,419: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-11 10:22:45,599: INFO: data_ingestion: Loaded dataset with 100000 rows]
[2025-07-11 10:22:45,600: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-11 10:22:45,601: INFO: data_ingestion: Starting preprocessing of 100000 rows...]
[2025-07-11 10:22:45,601: INFO: data_ingestion: Initial columns: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFraud', 'isFlaggedFraud']]
[2025-07-11 10:22:45,647: INFO: data_ingestion: After feature engineering columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-11 10:22:45,647: INFO: data_ingestion: Data shape after feature engineering: (100000, 12)]
[2025-07-11 10:22:45,660: INFO: main: 1 change detected]
[2025-07-11 10:22:45,660: INFO: data_ingestion: First few rows of feature engineered data: 
   step      amount  oldbalanceOrg  oldbalanceDest  isFraud  ...  type_CASH_IN  type_CASH_OUT  type_DEBIT  type_PAYMENT  type_TRANSFER
0   278   330218.42       20866.00       452419.57        0  ...             1              0           0             0              0
1    15    11647.08       30370.00            0.00        0  ...             0              0           0             1              0
2    10   152264.21      106589.00       201303.01        0  ...             1              0           0             0              0
3   403  1551760.63           0.00      3198359.45        0  ...             0              0           0             0              1
4   206    78172.30     2921331.58       415821.90        0  ...             1              0           0             0              0

[5 rows x 12 columns]]
[2025-07-11 10:22:45,661: INFO: data_ingestion: After encoding columns: ['step', 'amount', 'oldbalanceOrg', 'oldbalanceDest', 'isFraud', 'MoneySpentSender', 'MoneyReceiver', 'type_CASH_IN', 'type_CASH_OUT', 'type_DEBIT', 'type_PAYMENT', 'type_TRANSFER']]
[2025-07-11 10:22:45,661: INFO: data_ingestion: Data shape after encoding: (100000, 12)]
[2025-07-11 10:22:45,669: INFO: data_ingestion: Data shape after removing NaN: (100000, 12)]
[2025-07-11 10:22:45,673: INFO: data_ingestion: X shape (features): (100000, 11)]
[2025-07-11 10:22:45,673: INFO: data_ingestion: y shape (target): (100000,)]
[2025-07-11 10:22:45,674: INFO: data_ingestion: Target variable shape: (100000,)]
[2025-07-11 10:22:45,674: INFO: data_ingestion: NaN count in target: 0]
[2025-07-11 10:22:45,676: INFO: data_ingestion: Target variable distribution: 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-11 10:22:45,678: INFO: data_ingestion: Final feature matrix shape: (100000, 11)]
[2025-07-11 10:22:45,678: INFO: data_ingestion: Final target vector shape: (100000,)]
[2025-07-11 10:22:45,680: INFO: data_ingestion: Target variable distribution (normalized): 
isFraud
0    0.99859
1    0.00141
Name: proportion, dtype: float64]
[2025-07-11 10:22:45,680: INFO: data_ingestion: Target variable is imbalanced. Applying SMOTE...]
[2025-07-11 10:22:45,745: INFO: data_ingestion: Resampled feature matrix shape: (199718, 11)]
[2025-07-11 10:22:45,747: INFO: data_ingestion: Resampled target distribution: 
isFraud
0    99859
1    99859
Name: count, dtype: int64]
[2025-07-11 10:22:46,022: INFO: main: 1 change detected]
[2025-07-11 10:22:46,389: INFO: main: 1 change detected]
[2025-07-11 10:22:46,754: INFO: main: 3 changes detected]
[2025-07-11 10:22:47,118: INFO: main: 3 changes detected]
[2025-07-11 10:22:47,426: INFO: data_ingestion: Created versioned input data file: artifacts\data_version\input_raw_data_version_20250711T102245.csv]
[2025-07-11 10:22:47,427: INFO: data_ingestion: Created versioned processed data file: artifacts\data_version\processed_data_version_20250711T102245.csv]
[2025-07-11 10:22:47,427: INFO: data_ingestion: Created versioned feature engineered data file: artifacts\data_version\featured_data_version_20250711T102245.csv]
[2025-07-11 10:22:47,427: INFO: data_ingestion: Splitting data into train and test sets]
[2025-07-11 10:22:47,462: INFO: data_ingestion: Train data: (159774, 11), Test data: (39944, 11)]
[2025-07-11 10:22:47,462: INFO: data_ingestion: Data ingestion completed successfully]
[2025-07-11 10:22:47,462: INFO: data_ingestion: Data shape - Train: (159774, 11), Test: (39944, 11)]
[2025-07-11 10:22:47,466: INFO: preprocess_data: >>> Stage Data Ingestion stage completed <<<]
[2025-07-11 10:22:47,469: INFO: training_pipeline: >>>>>> stage Data Ingestion completed <<<<<<

x====================x]
[2025-07-11 10:22:47,470: INFO: training_pipeline: >>>>>> stage Model Training Pipeline started <<<<<<]
[2025-07-11 10:22:47,474: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-11 10:22:47,475: INFO: common: created directory at: artifacts]
[2025-07-11 10:22:47,475: INFO: configuration: MLFlow configuration: MLFlowConfig(dagshub_username='minh120103', dagshub_repo_name='E2E_ML', tracking_uri='https://dagshub.com/minh120103/E2E_ML.mlflow', experiment_name='Fraud_Detection_Experiment')]
[2025-07-11 10:22:47,482: INFO: main: 1 change detected]
[2025-07-11 10:22:47,855: INFO: _client: HTTP Request: GET https://dagshub.com/api/v1/repos/minh120103/E2E_ML "HTTP/1.1 200 OK"]
[2025-07-11 10:22:47,859: INFO: helpers: Initialized MLflow to track repo "minh120103/E2E_ML"]
[2025-07-11 10:22:47,860: INFO: helpers: Repository minh120103/E2E_ML initialized!]
[2025-07-11 10:22:48,866: INFO: training_pipeline: ==================================================]
[2025-07-11 10:22:48,866: INFO: training_pipeline: Running Model Preparation]
[2025-07-11 10:22:48,866: INFO: prepare_model: >>> Stage Prepare base model started <<<]
[2025-07-11 10:22:48,873: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-11 10:22:48,873: INFO: common: created directory at: artifacts]
[2025-07-11 10:22:48,877: INFO: common: created directory at: artifacts/model_version]
[2025-07-11 10:22:48,877: INFO: common: created directory at: artifacts/data_version]
[2025-07-11 10:22:48,877: INFO: configuration: Prepare base model config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'objective': 'binary:logistic', 'max_depth': 6, 'n_estimators': 300, 'random_state': 42, 'learning_rate': 0.1, 'scale_pos_weight': 10, 'n_jobs': -1}]
[2025-07-11 10:22:48,962: INFO: main: 1 change detected]
[2025-07-11 10:22:49,289: INFO: base_model: Creating base model and scaler]
[2025-07-11 10:22:49,289: INFO: base_model: Creating base XGBoost model]
[2025-07-11 10:22:49,289: INFO: base_model: Model params:300, 42, 0.1, 6, 10, -1]
[2025-07-11 10:22:49,289: INFO: base_model: Creating scaler from training data]
[2025-07-11 10:22:49,365: INFO: base_model: Base model saved: artifacts\model_version\base_model_churn_20250711T102249.pkl]
[2025-07-11 10:22:49,466: INFO: main: 3 changes detected]
[2025-07-11 10:22:50,859: INFO: prepare_model: >>> Stage Prepare base model completed <<<]
[2025-07-11 10:22:50,859: INFO: training_pipeline: Base model created at: artifacts\model_version\base_model_churn_20250711T102249.pkl]
[2025-07-11 10:22:50,860: INFO: training_pipeline: Scaler created at: artifacts\model_version\scaler_churn_version_20250711T102249.pkl]
[2025-07-11 10:22:50,860: INFO: training_pipeline: ==================================================]
[2025-07-11 10:22:50,860: INFO: training_pipeline: ==================================================]
[2025-07-11 10:22:50,860: INFO: training_pipeline: Running Model Training and Evaluation]
[2025-07-11 10:22:50,861: INFO: train_evaluation: >>> Stage TRAIN_AND_EVALUATE_MODEL started <<<]
[2025-07-11 10:22:50,865: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-11 10:22:50,866: INFO: common: created directory at: artifacts]
[2025-07-11 10:22:50,866: INFO: common: created directory at: artifacts/model_version]
[2025-07-11 10:22:50,867: INFO: common: created directory at: artifacts/data_version]
[2025-07-11 10:22:50,867: INFO: configuration: Training config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version'}]
[2025-07-11 10:22:50,871: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-11 10:22:50,871: INFO: common: created directory at: artifacts]
[2025-07-11 10:22:50,872: INFO: common: created directory at: artifacts/evaluation]
[2025-07-11 10:22:50,872: INFO: common: created directory at: artifacts/model_version]
[2025-07-11 10:22:50,873: INFO: common: created directory at: artifacts/data_version]
[2025-07-11 10:22:50,873: INFO: configuration: Evaluation config: {'model_version_dir': 'artifacts/model_version', 'data_version_dir': 'artifacts/data_version', 'evaluation_dir': 'artifacts/evaluation'}]
[2025-07-11 10:22:50,873: INFO: model_training: Initiating model training and evaluation with temporary directory management]
[2025-07-11 10:22:50,874: INFO: model_training: Loaded y_train shape: (159774,)]
[2025-07-11 10:22:50,874: INFO: model_training: Loaded y_test shape: (39944,)]
[2025-07-11 10:22:50,875: INFO: model_training: NaN count in y_train: 0]
[2025-07-11 10:22:50,875: INFO: model_training: NaN count in y_test: 0]
[2025-07-11 10:22:50,876: INFO: model_training: Final X_train_scaled shape: (159774, 11)]
[2025-07-11 10:22:50,876: INFO: model_training: Final y_train shape: (159774,)]
[2025-07-11 10:22:50,876: INFO: model_training: Final X_test_scaled shape: (39944, 11)]
[2025-07-11 10:22:50,876: INFO: model_training: Final y_test shape: (39944,)]
[2025-07-11 10:22:50,879: INFO: model_training: Loading model: XGBClassifier(base_score=None, booster=None, callbacks=None,
              colsample_bylevel=None, colsample_bynode=None,
              colsample_bytree=None, device=None, early_stopping_rounds=None,
              enable_categorical=False, eval_metric=None, feature_types=None,
              feature_weights=None, gamma=None, grow_policy=None,
              importance_type=None, interaction_constraints=None,
              learning_rate=0.1, max_bin=None, max_cat_threshold=None,
              max_cat_to_onehot=None, max_delta_step=None, max_depth=6,
              max_leaves=None, min_child_weight=None, missing=nan,
              monotone_constraints=None, multi_strategy=None, n_estimators=300,
              n_jobs=-1, num_parallel_tree=None, ...)]
[2025-07-11 10:22:50,880: INFO: model_training: Starting model training for model_fraud_20250711T102250]
[2025-07-11 10:22:51,937: INFO: model_training: Model training for model_fraud_20250711T102250 completed]
[2025-07-11 10:22:51,948: INFO: model_training:   trained model file (for future use): artifacts\model_version\model_churn_version_20250711T102250.pkl]
[2025-07-11 10:22:52,026: INFO: main: 1 change detected]
[2025-07-11 10:22:52,382: INFO: model_training: Model accuracy on test data: 0.9981974764670539]
[2025-07-11 10:22:52,383: INFO: model_training: Model accuracy is 85% or above, not needed finetuned, log trained model to mlflow]
[2025-07-11 10:22:52,383: INFO: model_training: Logging model to MLflow as model_fraud_20250711T102250]
[2025-07-11 10:23:08,366: INFO: model_training: Successfully registered model under unique name: XGBoost]
[2025-07-11 10:23:08,366: INFO: model_training: Performing detailed evaluation on test data]
[2025-07-11 10:23:08,516: INFO: common: json file saved at: artifacts\evaluation\metrics_20250711T102250.json]
[2025-07-11 10:23:08,517: INFO: model_training: Detailed metrics saved to: artifacts\evaluation\metrics_20250711T102250.json]
[2025-07-11 10:23:08,618: INFO: main: 1 change detected]
[2025-07-11 10:23:21,171: INFO: model_training: Creating confusion matrix plot]
[2025-07-11 10:23:21,278: INFO: model_training: Confusion matrix saved to: artifacts\evaluation\confusion_matrix_20250711T102250.png]
[2025-07-11 10:23:21,329: INFO: main: 2 changes detected]
[2025-07-11 10:23:21,977: INFO: model_training: Creating Precision-Recall curve plot]
[2025-07-11 10:23:22,101: INFO: model_training: Precision-Recall curve saved to: artifacts\evaluation\precision_recall_curve_20250711T102250.png]
[2025-07-11 10:23:22,134: INFO: main: 2 changes detected]
[2025-07-11 10:23:23,285: INFO: model_training: Creating ROC curve plot]
[2025-07-11 10:23:23,414: INFO: model_training: ROC curve saved to: artifacts\evaluation\roc_curve_20250711T102250.png]
[2025-07-11 10:23:23,448: INFO: main: 2 changes detected]
[2025-07-11 10:23:23,930: INFO: train_evaluation: >>> Stage TRAIN_AND_EVALUATE_MODEL completed <<<]
[2025-07-11 10:23:23,930: INFO: training_pipeline: Training and evaluation completed. Final model at: artifacts\model_version\model_churn_version_20250711T102250.pkl]
[2025-07-11 10:23:23,931: INFO: training_pipeline: Logged Metrics: {'precision': 0.9964678374210238, 'recall': 0.9999500773800609, 'f1_score': 0.9982059204624738, 'roc_auc': 0.9999928674808555, 'mcc': 0.9964010044780308, 'avg_precision': 0.9999927418432609, 'classification_report': {'0': {'precision': 0.9999496043944968, 'recall': 0.9964344900316376, 'f1-score': 0.9981889526109267, 'support': 19913.0}, '1': {'precision': 0.9964678374210238, 'recall': 0.9999500773800609, 'f1-score': 0.9982059204624738, 'support': 20031.0}, 'accuracy': 0.9981974764670539, 'macro avg': {'precision': 0.9982087209077604, 'recall': 0.9981922837058492, 'f1-score': 0.9981974365367002, 'support': 39944.0}, 'weighted avg': {'precision': 0.9982035781015458, 'recall': 0.9981974764670539, 'f1-score': 0.998197461599369, 'support': 39944.0}}}]
[2025-07-11 10:23:23,931: INFO: training_pipeline: ==================================================]
[2025-07-11 10:23:24,761: INFO: training_pipeline: >>>>>> stage Model Training Pipeline completed <<<<<<

x====================x]
[2025-07-11 10:23:24,762: INFO: training_pipeline: >>>>>> stage STAGE 4: Cloud Storage Push started <<<<<<]
[2025-07-11 10:23:24,762: INFO: training_pipeline: ==================================================]
[2025-07-11 10:23:24,762: INFO: training_pipeline: STAGE 4: Cloud Storage Push]
[2025-07-11 10:23:24,763: INFO: training_pipeline: ==================================================]
[2025-07-11 10:23:24,763: INFO: cloud_storage_push: >>> Stage Cloud Storage Push started <<<]
[2025-07-11 10:23:24,766: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-11 10:23:24,768: INFO: common: created directory at: artifacts]
[2025-07-11 10:23:24,768: INFO: configuration: Cloud Storage Push config: {'root_dir': 'artifacts', 'bucket_name': 'databucket231', 'data_version_dir': 'artifacts/data_version', 'evaluation_dir': 'artifacts/evaluation'}]
[2025-07-11 10:23:24,782: INFO: credentials: Found credentials in shared credentials file: ~/.aws/credentials]
[2025-07-11 10:23:25,011: INFO: cloud_storage_push: Ensured directory structure exists for cloud storage push]
[2025-07-11 10:23:25,011: INFO: cloud_storage_push: Starting cloud storage push process...]
[2025-07-11 10:23:25,064: INFO: main: 1 change detected]
[2025-07-11 10:23:25,671: INFO: cloud_storage_push: Bucket 'databucket231' exists and is accessible]
[2025-07-11 10:23:25,671: INFO: cloud_storage_push: Found 7 files to upload to cloud storage.]
[2025-07-11 10:23:26,379: INFO: cloud_storage_push: Uploaded artifacts\evaluation\metrics_20250711T102250.json to bucket databucket231.]
[2025-07-11 10:23:26,624: INFO: cloud_storage_push: Uploaded artifacts\evaluation\confusion_matrix_20250711T102250.png to bucket databucket231.]
[2025-07-11 10:23:26,650: INFO: cloud_storage_push: Uploaded artifacts\evaluation\roc_curve_20250711T102250.png to bucket databucket231.]
[2025-07-11 10:23:27,184: INFO: cloud_storage_push: Uploaded artifacts\evaluation\precision_recall_curve_20250711T102250.png to bucket databucket231.]
[2025-07-11 10:23:41,108: INFO: cloud_storage_push: Uploaded artifacts\data_version\featured_data_version_20250711T102245.csv to bucket databucket231.]
[2025-07-11 10:23:42,539: INFO: cloud_storage_push: Uploaded artifacts\data_version\processed_data_version_20250711T102245.csv to bucket databucket231.]
[2025-07-11 10:23:46,583: INFO: cloud_storage_push: Uploaded artifacts\data_version\input_raw_data_version_20250711T102245.csv to bucket databucket231.]
[2025-07-11 10:23:46,587: INFO: cloud_storage_push: Successfully uploaded 7 files to S3 bucket: databucket231]
[2025-07-11 10:23:46,587: INFO: cloud_storage_push: >>> Stage Cloud Storage Push completed <<<]
[2025-07-11 10:23:46,587: INFO: training_pipeline: Cloud storage push completed successfully]
[2025-07-11 10:23:46,587: INFO: training_pipeline: >>>>>> stage STAGE 4: Cloud Storage Push completed <<<<<<

x====================x]
[2025-07-11 10:23:46,587: INFO: clean_up: ==================================================]
[2025-07-11 10:23:46,587: INFO: clean_up: CLEANUP: Removing temporary versioned files]
[2025-07-11 10:23:46,587: INFO: clean_up: ==================================================]
[2025-07-11 10:23:46,587: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-11 10:23:46,587: INFO: common: created directory at: artifacts]
[2025-07-11 10:23:46,594: INFO: clean_up: Found 3 timestamp-versioned data files to clean]
[2025-07-11 10:23:46,594: INFO: clean_up: Deleted temporary file: featured_data_version_20250711T102245.csv]
[2025-07-11 10:23:46,594: INFO: clean_up: Deleted temporary file: input_raw_data_version_20250711T102245.csv]
[2025-07-11 10:23:46,594: INFO: clean_up: Deleted temporary file: processed_data_version_20250711T102245.csv]
[2025-07-11 10:23:46,594: INFO: clean_up: Found 4 timestamp-versioned evaluation files to clean]
[2025-07-11 10:23:46,594: INFO: clean_up: Deleted temporary file: metrics_20250711T102250.json]
[2025-07-11 10:23:46,594: INFO: clean_up: Deleted temporary file: confusion_matrix_20250711T102250.png]
[2025-07-11 10:23:46,594: INFO: clean_up: Deleted temporary file: precision_recall_curve_20250711T102250.png]
[2025-07-11 10:23:46,601: INFO: clean_up: Deleted temporary file: roc_curve_20250711T102250.png]
[2025-07-11 10:23:46,602: INFO: clean_up: Deleted temporary file: input_raw.csv]
[2025-07-11 10:23:46,602: INFO: clean_up: Kept 0 essential data files for DVC tracking]
[2025-07-11 10:23:46,602: INFO: clean_up: Kept 0 essential evaluation files for DVC tracking]
[2025-07-11 10:23:46,684: INFO: main: 10 changes detected]
[2025-07-11 10:23:50,438: INFO: main: 1 change detected]
[2025-07-11 10:24:46,488: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-11 10:24:46,489: INFO: common: created directory at: artifacts]
[2025-07-11 10:24:46,490: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-11 10:24:46,490: INFO: common: created directory at: artifacts/data_version]
[2025-07-11 10:24:46,490: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-11 10:24:46,494: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-11 10:24:46,495: INFO: common: created directory at: artifacts]
[2025-07-11 10:24:46,496: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-11 10:24:46,496: INFO: common: created directory at: artifacts/data_version]
[2025-07-11 10:24:46,496: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-11 10:24:46,598: INFO: main: 1 change detected]
[2025-07-11 10:24:48,714: INFO: main: 1 change detected]
[2025-07-11 10:24:52,017: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-11 10:24:52,018: INFO: common: created directory at: artifacts]
[2025-07-11 10:24:52,019: INFO: common: created directory at: artifacts/data_ingestion]
[2025-07-11 10:24:52,019: INFO: common: created directory at: artifacts/data_version]
[2025-07-11 10:24:52,020: INFO: configuration: Data Ingestion config: {'root_dir': 'artifacts/data_ingestion', 'data_version_dir': 'artifacts/data_version', 'local_data_file': 'artifacts/data_ingestion/input_raw.csv', 'test_size': 0.2, 'random_state': 42, 'bucket_name': 'databucket231'}]
[2025-07-11 10:24:52,843: INFO: data_ingestion: Loading data from artifacts\data_ingestion\input_raw.csv]
[2025-07-11 10:24:52,865: INFO: data_ingestion: Loaded dataset with 10000 rows]
[2025-07-11 10:24:52,865: INFO: data_ingestion: Columns found: ['step', 'type', 'amount', 'nameOrig', 'oldbalanceOrg', 'newbalanceOrig', 'nameDest', 'oldbalanceDest', 'newbalanceDest', 'isFlaggedFraud']]
[2025-07-11 10:24:55,217: INFO: predict_compo: Successfully saved prediction results to C:\Users\minh1\AppData\Local\Temp\tmpb5krugrl.csv and logged as MLflow artifact]
[2025-07-11 10:24:55,223: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-11 10:24:55,223: INFO: common: created directory at: artifacts]
[2025-07-11 10:24:55,224: INFO: configuration: Cloud Storage Push config: {'root_dir': 'artifacts', 'bucket_name': 'databucket231', 'data_version_dir': 'artifacts/data_version', 'evaluation_dir': 'artifacts/evaluation'}]
[2025-07-11 10:24:55,234: INFO: cloud_storage_push: Ensured directory structure exists for cloud storage push]
[2025-07-11 10:24:55,919: INFO: cloud_storage_push: Bucket 'databucket231' exists and is accessible]
[2025-07-11 10:24:57,059: INFO: predict_compo: Deleted temporary prediction file: C:\Users\minh1\AppData\Local\Temp\tmpb5krugrl.csv]
[2025-07-11 10:24:57,059: INFO: predict_compo: Prediction processing time: 5.05 seconds]
[2025-07-11 10:24:57,059: INFO: predict_compo: Started at: 2025-07-11 10:24:52]
[2025-07-11 10:24:57,059: INFO: predict_compo: Completed at: 2025-07-11 10:24:57]
[2025-07-11 10:25:03,827: INFO: predict_compo: Cleanup: Deleted input file artifacts\data_ingestion\input_raw.csv]
[2025-07-11 10:25:03,887: INFO: main: 1 change detected]
[2025-07-11 10:25:11,371: INFO: main: 1 change detected]
